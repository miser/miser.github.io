<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Miser èƒ¡è¨€</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://miser.github.io/"/>
  <updated>2019-10-06T16:57:35.523Z</updated>
  <id>https://miser.github.io/</id>
  
  <author>
    <name>Miser</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2019å›½åº†ä¸€äººåˆæ¸¸èˆŸå±±</title>
    <link href="https://miser.github.io/2019/10/06/travel-zhoushan/"/>
    <id>https://miser.github.io/2019/10/06/travel-zhoushan/</id>
    <published>2019-10-06T06:11:21.849Z</published>
    <updated>2019-10-06T16:57:35.523Z</updated>
    
    <content type="html"><![CDATA[<p>å›½åº†ä¸€å®¶ä¸‰å£åˆ†å¼€æ—…è¡Œï¼Œå„æœ‰è‡ªå·±çš„ç›®çš„åœ°ï¼Œæˆ‘é€‰äº†èˆŸå±±ï¼Œç¦»å¼€ä¸Šæµ·ä¸è¿œï¼Œä¹‹å‰ä»æ¥æ²¡æœ‰å»è¿‡ã€‚ä¸€äººçš„æ—…è¡Œè‡ªç„¶åº”è¯¥æƒ¬æ„ä¸ºä¸»ï¼Œæ‰“ç€èµ°åˆ°å“ªç®—å“ªçš„æ”¿ç­–ä¸»å¼ ï¼Œä¹Ÿç»™è‡ªå·±åŸ‹ä¸‹ä¸å°‘çš„å‘ã€‚</p><a id="more"></a><p><br></p><h3 id="ä½å®¿"><a href="#ä½å®¿" class="headerlink" title="#ä½å®¿"></a><strong>#ä½å®¿</strong></h3><p>é»„é‡‘å‘¨ä¸å…‰æ˜¯æ¸¸å®¢çš„èŠ‚æ—¥ï¼Œæ›´æ˜¯å•†å®¶çš„ç››æ—¥ï¼Œé…’åº—ä»·æ ¼ä¹Ÿæ˜¯æ°´æ¶¨èˆ¹é«˜ï¼Œæœ¬æƒ³éæ‹–å®¶å¸¦å£çš„ï¼Œä¸éœ€è¦ç¦»å¸‚åŒºå¤šè¿‘ï¼Œç»æµå®æƒ å°±è¡Œï¼Œç„¶åæˆ‘å°±åœ¨<code>Airbnb</code>ä¸Šé€‰äº†ä¸€ä¸ªå¥½è¯„ä¸é”™çš„å…¬å¯“é…’åº—ï¼Œå®½æ•ã€å¹²å‡€ã€ä¾¿å®œï¼Œä¸€ä¸ªæˆ¿é—´å¯ä»¥æ”¾ä¸‹1ä¸ªä¸»åºŠã€1ä¸ªå°åºŠã€1ä¸ªå†™å­—å°ã€1ä¸ªä¼‘é—²åœ†æ¡Œã€3æŠŠæ¤…å­ç­‰ï¼Œå¯æƒœå«ç”Ÿé—´å’Œæ·‹æµ´å®¤ä¸æ€æ ·ï¼Œ2å¤œæ‰600ä¸åˆ°ï¼Œåœ°æ–¹å¤§çº¦åœ¨ä¸‹å›¾çº¢æ¡†å†…ï¼ŒèˆŸå±±çš„æ±½è½¦åŸè¾¹ä¸Šã€‚æœ¬æƒ³åœ¨å®¢è¿ä¸­å¿ƒé™„è¿‘ï¼Œæˆ‘è‡ªå·±åå¤§å·´è½¦æ¥å›æ–¹ä¾¿ï¼Œä½†æ˜¯å®ƒå¹¶éæ˜¯æˆ‘ä¸‹è½¦çš„èˆŸå±±æ™®é™€å®¢è¿ä¸­å¿ƒï¼ˆä¸‹å›¾å³ä¸‹è§’é‚£ä¸ªï¼‰ï¼Œæ‰“è½¦è¿‡æ¥100å¤š:(ï¼Œå‡ºç§Ÿè½¦å¸æœºéƒ½ä¸å¿å¿ƒæˆ‘çš„æ—…è¡Œæ³¡æ±¤åŠæˆ‘æ¢ä¸ªé…’åº—ï¼ˆ<code>æ‰å¿ƒ</code>ï¼‰ã€‚</p><p><img src="/images/travel-zhoushan/travel-zhoushan-01.png" alt="æœ¬æƒ³ç€ç¦»æ±Ÿæµ·è¿‘ï¼Œå¯ä»¥å»é€›é€›çš„ï¼Œæœ€åè¿˜æ˜¯æ²¡å»"></p><p>ä»é…’åº—å‡ºæ¥ï¼Œå’Œåº—å‘˜æ‰“å¬å“ªé‡Œæœ‰å¤œæ’æ¡£ä¹‹ç±»ï¼Œå¾—åˆ°çš„ç­”æ¡ˆæ˜¯å„ç§é¥è¿œï¼Œæœ€åé€‰äº†ç›¸å¯¹è¿‘ä¸€ç‚¹çš„<code>å®šæµ·æµ·é²œå¤œæ’æ¡£</code>ï¼Œä¸‹å›¾ä½ç½®ã€‚ä¸€è·¯å…¬äº¤æ™ƒæ™ƒæ‚ æ‚ ï¼Œä»è’éƒŠé‡å¤–åˆ°å¸‚åŒºï¼Œæ„Ÿå—èˆŸå±±ã€‚</p><p><img src="/images/travel-zhoushan/travel-zhoushan-03.png" alt="ä¸æ˜¯åƒè´§ï¼Œé€‰æµ·é²œæ›´å¤šæ˜¯æ¥èˆŸå±±çš„ä»ªå¼æ„Ÿå§"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-02.jpg" alt="é…’åº—é™„è¿‘çš„å…¬äº¤è½¦ç«™ç‰Œæ„Ÿå—ä¸‹å®ƒçš„è’å‡‰ï¼Œå½“æ—¶ç»™æˆ‘ä¸€ç§æœ«ä¸–çš„æ„Ÿè§‰"></p><p><br></p><h3 id="åƒæµ·é²œ"><a href="#åƒæµ·é²œ" class="headerlink" title="#åƒæµ·é²œ"></a><strong>#åƒæµ·é²œ</strong></h3><p>åˆ°äº†åœ°æ–¹ï¼Œä¸€æ¡é•¿é•¿çš„æµ·é²œæ’æ¡£ä½äº2å±‚ï¼Œçœ‹ä¸åˆ°åº•ã€‚å¯ä»¥è¾¹åƒè¾¹çœ‹æ±Ÿæµ·çš„é£æ™¯ï¼Œå¯¹é¢æ˜¯è‹¥å¹²åº§å°å²›ï¼Œçªç„¶å¿ƒä¸­æ¶Œä¸Š<code>æ±Ÿæ«æ¸”ç«å¯¹æ„çœ </code>çš„è¯—å¥ï¼Œä¸å¯¹æƒ…ä¸å¯¹æ™¯è‰²ï¼Œä½†ä¹Ÿæ˜¯å”¯ä¸€çš„ç¬é—´æ„Ÿè§‰äº†ã€‚åƒæˆ‘è¿™æ ·çš„1äººâ€œå°å®¢æˆ·â€ï¼Œè‡ªç„¶ä¸å—å„ä¸ªå°åº—è€æ¿ä»¬çš„å¾…è§ï¼Œæ¯•ç«Ÿäººå®¶åšçš„æ˜¯å¤§æ¡Œå­ç”Ÿæ„ï¼Œæˆ‘åªèƒ½åœ¨ä¸è€çƒ¦çš„ç›®å…‰ä¸­ç‚¹äº†3ä¸ªå°èœååœ¨äº†ç¦»é£æ™¯æœ€è¿œçš„è§’è½é‡Œâ€”â€”ä¸€ä¸ªå°æ¡Œå­ä¸Šåƒèµ·äº†æˆ‘<code>æµ·é²œå¤§é¤</code>ã€‚</p><p><img src="/images/travel-zhoushan/travel-zhoushan-04.jpg" alt="å®šæµ·æµ·é²œå¤œæ’æ¡£"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-05.jpg" alt="çœ‹ä¸åˆ°åº•çš„åº—é“ºï¼Œçœ‹ä¸å®Œçš„äººç¾¤1"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-06.jpg" alt="åƒä¸å®Œçš„æµ·é²œ1"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-07.jpg" alt="åƒä¸å®Œçš„æµ·é²œ2"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-08.jpg" alt="æ±Ÿæ«æ¸”ç«1"></p><video width="100%" muted controls><br>  <source id="mp4" src="/images/travel-zhoushan/travel-zhoushan-15.mp4"><br>  Your browser does not support the video tag.<br></video><p><img src="/images/travel-zhoushan/travel-zhoushan-09.jpg" alt="ä»è§’è½çš„å°é¥­æ¡Œæœ›å‡ºå»"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-10.jpg" alt="æˆ‘çš„ç›˜ä¸­é¤ï¼Œè›å­å’ŒèŠ±ç”²ï¼ŒåŸºæœ¬æ²¡æ²™å­ï¼Œè›å­å…¶å®å¾ˆè‚¥å¤§ï¼Œæˆ‘æ²¡æ‹å¥½"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-11.jpg" alt="æˆ‘çš„ç›˜ä¸­é¤ï¼Œç›çˆ†è™¾ï¼Œè¿˜è¡Œå§"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-12.jpg" alt="æˆ‘çš„ç›˜ä¸­é¤ï¼Œç« é±¼ç‚’é’æ¤’ï¼Œè§¦é¡»é‡Œå›¤ç§¯äº†å¾ˆå¤šæ±æ°´ï¼Œä¸€å£ä¸‹å»æ‰çŸ¥é“ä»€ä¹ˆå«çˆ†æ±"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-13.jpg" alt="æ­¤æƒ…æ­¤æ™¯å¤šå°‘è¦å–ç‚¹"></p><p>åƒå®Œåï¼Œèµ°äº†å°å‡ å…¬é‡Œåˆ°äº†å®šæµ·åŒºçš„å•†ä¸šä¸­å¿ƒâ€”â€”<code>å‡¯è™¹å¹¿åœº</code>ï¼Œä¹°äº†ä¸€åŒ…è–¯ç‰‡å›é…’åº—ï¼Œ7ç‚¹å¤šå°±æ²¡å…¬äº¤å›æˆ‘ä½çš„ç©·ä¹¡åƒ»å»Šï¼Œåªèƒ½èŠ±äº†30å¤šå¤§æ´‹æ‰“è½¦å›å»ï¼Œæ­¤åˆ»å¿ƒé‡Œå°±å†³å®šç¬¬äºŒå¤©è¦ç§Ÿä¸€å¤©è½¦å»<code>æœ±å®¶å°–</code>é€›ä¸€åœˆã€‚</p><p><br></p><h3 id="æœ±å®¶å°–"><a href="#æœ±å®¶å°–" class="headerlink" title="#æœ±å®¶å°–"></a><strong>#æœ±å®¶å°–</strong></h3><p><em>å¤§é˜´å¤©</em></p><p>æœ‰äº†ç¬¬ä¸€å¤©çš„ç»å†ï¼Œè‡ªç„¶çŸ¥é“ä»è‡ªå·±ä½çš„åœ°æ–¹åˆ°èˆŸå±±å¦ä¸€å¤´çš„æœ±å®¶å°–çš„è·ç¦»æœ‰å¤šè¿œï¼Œä¸å µè½¦ä¼°è®¡å‡ºç§Ÿè½¦å•ç¨‹200å¤§æ´‹ã€‚ä¸­åˆï¼Œä»å®šæµ·åŒºä¸€è·¯å‘ä¸œï¼Œç¬¬ä¸€ç«™æ˜¯å—æ²™æµ·æ»©æ™¯åŒºï¼Œå»é‚£è¾¹çš„æ’æ¡£åƒåˆé¥­ï¼Œæ™¯åŒºä¸€ä¸ªäººå°±æ²¡è¿›å»ï¼Œæ¯•ç«Ÿäººå±±äººæµ·ã€‚å› ä¸ºäº¤é€šç®¡åˆ¶ï¼Œå¯¼è‡´è¦ä»å¤§é’å±±ç›˜å±±ç»•è·¯ï¼Œå¦¥å¦¥ç§‹åå±±çš„æ„Ÿè§‰ï¼Œé€”ä¸­æ‹åˆ°äº†ä¸é”™çš„æµ·æ»©å’Œè¢«äº‘é›¾ç¼­ç»•çš„å¤§é’å±±ï¼Œå€¼äº†æ²¹é’±ã€‚</p><p><img src="/images/travel-zhoushan/travel-zhoushan-16.png" alt="èˆŸå±±çš„ä¸¤ç«¯"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-17.jpg" alt="ç§Ÿçš„è€æ¬¾é©¬6"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-18.jpg" alt="æµ·æ»©&amp;å¤§é’å±±1"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-19.jpg" alt="æµ·æ»©&amp;å¤§é’å±±2"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-23.png" alt="æµ·æ»©&amp;å¤§é’å±± æ‹ç…§çš„å¤§æ¦‚ä½ç½®"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-20.jpg" alt="çœ‹ä¸åˆ°åº•çš„åº—é“ºï¼Œçœ‹ä¸å®Œçš„äººç¾¤2"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-22.jpg" alt="åƒä¸å®Œçš„æµ·é²œ3"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-21.jpg" alt="æˆ‘çš„æµ·é²œé¢ è™¾ã€éš”ç¦»ã€ğŸ¦‘ä¸ç­‰ç­‰"></p><p>åƒé¥±å¼€è½¦ï¼Œæœ¬æƒ³ç»§ç»­æ¢ç´¢å—æ²™æµ·æ»©çš„ï¼Œæ¯•ç«Ÿè¿›æ™¯ç‚¹æµ·æ»©ï¼Œä¸€è·¯æ‰¾<code>é‡ç”Ÿæµ·æ»©</code>è¿‡è¿‡ç˜¾çš„ï¼Œå¯æƒœäººå®åœ¨å¤ªå¤šï¼Œå„ä¸ªä¸»è¦è·¯å£äº¤é€šç®¡åˆ¶ï¼Œä¸€ä¸å°å¿ƒå¼€é”™ï¼Œæ„Ÿè§‰å†ç»•è¿›æ™¯åŒºä¼°è®¡å¾ˆä¹…ï¼Œå°±æ‰“ç®—å»å¦ä¸€ä¸ªåœ°æ–¹<code>æœˆå²™å¤§æ²™é‡Œæ²™æ»©</code>ï¼ˆåˆ°äº†æ‰å‘ç°å½“å¤©æ²¡æœ‰å¼€æ”¾ï¼Œç¾æ™¯è¯·è‡ªè¡Œæœç´¢äº†ï¼‰ï¼Œé€”ä¸­åˆå¼€é”™äº†è·¯ï¼Œç»è¿‡äº†ç™½å±±æ™¯åŒºï¼Œçœ‹åˆ°äº†ä¸€ä¸ªç”»æœ‰è§‚éŸ³åƒçš„çŸ³å£ã€‚</p><blockquote><p>ç™½å±±æ™¯åŒºç³»è§‚éŸ³æ–‡åŒ–è‹‘æ‰€åœ¨åœ°ï¼Œå°è±¡æ™®é™€å‰§åœºä¸ºæœ±å®¶å°–æœ€é‡è¦çš„æ™¯åŒºä¹‹ä¸€ï¼Œå…¶é—´ä¸€åº§é«˜114.9ç±³çš„å¹²ä¸ˆå´–ä¸Šå½©ç»˜çš„ä¸€å°Šè§‚éŸ³å¤§ç«‹åƒå£ç”»é«˜69ç±³ï¼Œé¢ç§¯è¾¾2000å¹³æ–¹ç±³ï¼Œè¢«èª‰ä¸ºâ€œæµ·ä¸Šè«é«˜çªŸâ€ã€‚</p></blockquote><p><img src="/images/travel-zhoushan/travel-zhoushan-24.jpg" alt="è§‚éŸ³åƒ"></p><p>åˆå…œå…œè½¬è½¬çš„ä¹¡é—´å°è·¯ï¼Œæ¥åˆ°äº†æ¸¸å®¢ç›¸å¯¹å¾ˆå°‘çš„æœˆå²™å¤§æ²™é‡Œæ²™æ»©æ—çš„ä¸€æ¡æ²¿æµ·å°è·¯ï¼Œå¾ˆå®½é˜”çš„æ±Ÿæµ·å¤–ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„æ„Ÿè§‰å§ï¼Œæœ¬æƒ³å½“åœºæ‰å¤´å›å»ï¼Œå¯æƒœè½¦æŠ€ä¸ä½³ï¼Œåªèƒ½ä¸€ç›´å¾€å‰å¼€åˆ°ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒå®½é˜”çš„é“è·¯æ‰å¤´ï¼Œç„¶åï¼Œå°±é‡åˆ°äº†å¾ˆæœ‰æ„Ÿè§‰çš„åœ°æ–¹ã€‚</p><p><img src="/images/travel-zhoushan/travel-zhoushan-25.jpg" alt="å¯¹é¢å°±æ˜¯æœˆå²™å¤§æ²™é‡Œæ²™æ»©äº†"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-26.jpg" alt="æ±Ÿæµ·å±±1"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-27.jpg" alt="æ±Ÿæµ·å±±2"></p><p>ä»ä¸‹é¢çš„åœ°å›¾ä½ ä¼šå‘ç°ï¼Œä¸€ä¸ªç±»ä¼¼Uå½¢å¼¯é“çš„æœ«å°¾ï¼Œæˆ‘æŠŠè½¦è°ƒå¤´ï¼Œå‡†å¤‡é©¶ç¦»çš„æ—¶å€™ï¼Œçœ¼å‰çš„å°è·¯å’Œæµ·æ™¯è®©æˆ‘æœ‰ç§è«åçš„è§¦æ™¯ç”Ÿæƒ…æ„Ÿï¼Œæ‰­æ›²çš„å°è·¯å¦‚åŒè‡ªå·±çš„è¿‡å¾€ï¼Œå¾ˆå¤šäº‹æƒ…æ›²æŠ˜å¹¶ä¸é¡ºåˆ©ï¼Œç„¶è€Œå¤–é¢çš„ä¸–ç•Œåˆé‚£ä¹ˆçš„å£®é˜”ç¾ä¸½ï¼Œæƒ³å»äº†è§£æƒ³å»çœ‹çœ‹æƒ³å»æ„Ÿå—ï¼Œå¿ä¸ä½åœ¨è½¦é‡Œå¬äº†å‡ éé‚“ç´«æ£‹çš„<code>åä¼šæ— æœŸ</code>ã€‚</p><p><img src="/images/travel-zhoushan/travel-zhoushan-28.jpg" alt="å°è·¯å’Œæ™¯è‰²1"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-30.jpg" alt="å°è·¯å’Œæ™¯è‰²2"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-29.jpg" alt="å°è·¯å’Œæ™¯è‰²3"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-31.jpg" alt="å°è·¯å’Œæ™¯è‰²4"></p><p><img src="/images/travel-zhoushan/travel-zhoushan-32.png" alt="å°è·¯å’Œæ™¯è‰²åœ°å›¾ä½ç½®"></p><p>åœ¨å¤œè‰²æ…¢æ…¢è½ä¸‹å‰ç¦»å¼€äº†æ­¤åœ°å›åˆ°äº†èˆŸå±±å¸‚åŒºã€‚ç¬¬äºŒå¤©è¿˜äº†è½¦ï¼Œåä¸Šå¤§å·´è¿”å›äº†ä¸Šæµ·ã€‚</p><h3 id="å›é¦–"><a href="#å›é¦–" class="headerlink" title="#å›é¦–"></a><strong>#å›é¦–</strong></h3><p>ç©äº†3å¤©ï¼Œæœ‰å‘ï¼Œä½çš„è¿œã€è·¯ä¸ç†Ÿæ‚‰ç­‰ç­‰ï¼Œæ­£æ˜¯è¿™äº›æ‰ä¿ƒä½¿æˆ‘çœ‹åˆ°äº†è®¸å¤šæ²¡æœ‰è§„åˆ’çš„é£æ™¯ï¼Œäººç”Ÿå“ªæœ‰é‚£ä¹ˆå¤šè§„åˆ’ï¼Œå­¦ä¼šæ¥å—å’Œäº«å—é‚£äº›åŸæœ¬ä¸å±äºä½ è€Œåˆæ˜¯ä½ çš„é£æ™¯å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å›½åº†ä¸€å®¶ä¸‰å£åˆ†å¼€æ—…è¡Œï¼Œå„æœ‰è‡ªå·±çš„ç›®çš„åœ°ï¼Œæˆ‘é€‰äº†èˆŸå±±ï¼Œç¦»å¼€ä¸Šæµ·ä¸è¿œï¼Œä¹‹å‰ä»æ¥æ²¡æœ‰å»è¿‡ã€‚ä¸€äººçš„æ—…è¡Œè‡ªç„¶åº”è¯¥æƒ¬æ„ä¸ºä¸»ï¼Œæ‰“ç€èµ°åˆ°å“ªç®—å“ªçš„æ”¿ç­–ä¸»å¼ ï¼Œä¹Ÿç»™è‡ªå·±åŸ‹ä¸‹ä¸å°‘çš„å‘ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="travel" scheme="https://miser.github.io/categories/travel/"/>
    
    
  </entry>
  
  <entry>
    <title>Refactoring A Monster</title>
    <link href="https://miser.github.io/2019/09/18/refactoring-a-monster/"/>
    <id>https://miser.github.io/2019/09/18/refactoring-a-monster/</id>
    <published>2019-09-18T03:19:59.291Z</published>
    <updated>2019-10-06T16:58:13.388Z</updated>
    
    <content type="html"><![CDATA[<p>Buildingâ€¦</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Buildingâ€¦&lt;/p&gt;

      
    
    </summary>
    
      <category term="javascript" scheme="https://miser.github.io/categories/javascript/"/>
    
    
  </entry>
  
  <entry>
    <title>Set A Flag</title>
    <link href="https://miser.github.io/2019/06/19/bec/"/>
    <id>https://miser.github.io/2019/06/19/bec/</id>
    <published>2019-06-19T13:30:00.000Z</published>
    <updated>2019-06-19T14:05:42.699Z</updated>
    
    <content type="html"><![CDATA[<h5 id="Practice-speaking-and-listening-pass-the-BEC-exam"><a href="#Practice-speaking-and-listening-pass-the-BEC-exam" class="headerlink" title="Practice speaking and listening, pass the BEC exam."></a>Practice speaking and listening, pass the BEC exam.</h5><p><img src="/images/bec/1.jpeg" alt="book1"><br><img src="/images/bec/2.jpeg" alt="book2"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;Practice-speaking-and-listening-pass-the-BEC-exam&quot;&gt;&lt;a href=&quot;#Practice-speaking-and-listening-pass-the-BEC-exam&quot; class=&quot;headerlink&quot; t
      
    
    </summary>
    
      <category term="å·¥ä½œ" scheme="https://miser.github.io/categories/%E5%B7%A5%E4%BD%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>Eggjs Boot</title>
    <link href="https://miser.github.io/2019/05/09/egg-boot/"/>
    <id>https://miser.github.io/2019/05/09/egg-boot/</id>
    <published>2019-05-09T15:01:08.568Z</published>
    <updated>2019-06-19T14:04:13.499Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Preface"><a href="#Preface" class="headerlink" title="#Preface"></a><strong>#Preface</strong></h3><p>This article will introduce the boot of <a href="https://eggjs.org/" target="_blank" rel="noopener">Eggjs</a> that is a Node.js web framework.</p><p>It is based on Koa and can satisfy  your requirement through a large of plugins and middleware, even a your own framework. It is very important to create a cluster, an agent process and some worker processes when it is running. The cluster makes it stronger. Next, we can understand it by reading the source code.</p><p>Eggjs has a few major libs, egg-coreã€eggã€egg-clusterã€egg-binã€egg-scripts and so on.</p><p><strong>egg-core</strong>: it extends Koa and is as a parent object of every agent and worker.</p><p><strong>egg</strong>: it defines some actions for agent and worker,  you can almost use these actions to create an app of a single process.</p><p><strong>egg-cluster</strong>: it creates a cluster and manages them.</p><p><strong>egg-scripts and Egg-bin</strong>: their job is run the whole app in a different environment.</p><p><br></p><p><em><strong>Tips: We will discuss Eggjs with basing 2.x.x version.</strong></em></p><p><br></p><a id="more"></a><h2 id="Scan-Libs-Code"><a href="#Scan-Libs-Code" class="headerlink" title="#Scan Libs Code"></a><strong>#Scan Libs Code</strong></h2><p><em>* The directory and the code segment are not whole content after this post, these major are only for a better explanation.</em></p><h3 id="egg-core"><a href="#egg-core" class="headerlink" title="egg-core"></a><strong>egg-core</strong></h3><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â€” lib</span><br><span class="line">  â€” / loader (dir)</span><br><span class="line">  â€” mixin (dir)</span><br><span class="line">  â€” utils (dir)</span><br><span class="line">  egg.js</span><br><span class="line">  lifecycle.js</span><br></pre></td></tr></table></figure><p>The above is the directory structure of egg-core.The <em><strong>egg.js</strong></em> and folder of the <em><strong>loader</strong></em> are important to point for this lib.</p><p>See egg.js</p><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> KoaApplication = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> Lifecycle = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lifecycle'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EggCore</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">KoaApplication</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span>(options = &#123;&#125;) &#123;</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">    <span class="hljs-keyword">this</span>.lifecycle = <span class="hljs-keyword">new</span> Lifecycle(&#123;</span><br><span class="line">      baseDir: options.baseDir,</span><br><span class="line">      app: <span class="hljs-keyword">this</span>,</span><br><span class="line">      logger: <span class="hljs-keyword">this</span>.console</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">const</span> Loader = <span class="hljs-keyword">this</span>[EGG_LOADER]</span><br><span class="line">    assert(Loader, <span class="hljs-string">"Symbol.for('egg#loader') is required"</span>)</span><br><span class="line">    <span class="hljs-keyword">this</span>.loader = <span class="hljs-keyword">new</span> Loader(&#123;</span><br><span class="line">      baseDir: options.baseDir,</span><br><span class="line">      app: <span class="hljs-keyword">this</span>,</span><br><span class="line">      plugins: options.plugins,</span><br><span class="line">      logger: <span class="hljs-keyword">this</span>.console,</span><br><span class="line">      serverScope: options.serverScope,</span><br><span class="line">      env: options.env</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">  beforeStart(scope) &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.lifecycle.registerBeforeStart(scope)</span><br><span class="line">  &#125;</span><br><span class="line">  ready(flagOrFunction) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.lifecycle.ready(flagOrFunction)</span><br><span class="line">  &#125;</span><br><span class="line">  get [EGG_LOADER]() &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-built_in">require</span>(<span class="hljs-string">'./loader/egg_loader'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>First, we can know why it is called that bases on Koa because EggCore extends KoaApplication.</p><p>Second, it defines a few new fields in the construction function, such as <em>lifecycle</em> and <em>loader</em>. The <em>loader</em> field helps app for creating important feature include configã€pluginã€controllerã€extendã€routerã€middlewareã€service and so on, it will load some js file in the special directory when the app is starting.</p><p>Another side, both <em>beforeStart</em> and <em>ready</em> often are called when we need to write some plugins.</p><h3 id="egg"><a href="#egg" class="headerlink" title="egg"></a><strong>egg</strong></h3><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â€” / app</span><br><span class="line">â€” / config</span><br><span class="line">â€” / lib</span><br><span class="line">  - / core</span><br><span class="line">    - / messenger</span><br><span class="line">  - / jsdoc</span><br><span class="line">  - / loader</span><br><span class="line">  - agent.js</span><br><span class="line">  - application.js</span><br><span class="line">  - egg.js</span><br><span class="line">  - start.js</span><br><span class="line">- index.js</span><br></pre></td></tr></table></figure><p>There is an egg.js file that is the same name in the egg-core, but it bases on <em>EggCore Class</em> and extends the lifecycle field, creates new messenger field and cluster field and dumps app config info.</p><p>See egg.js</p><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> EggCore = <span class="hljs-built_in">require</span>(<span class="hljs-string">'egg-core'</span>).EggCore</span><br><span class="line"><span class="hljs-keyword">const</span> cluster = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cluster-client'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> Messenger = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./core/messenger'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EggApplication</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EggCore</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span>(options = &#123;&#125;) &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.loader.loadConfig()</span><br><span class="line">    <span class="hljs-keyword">this</span>.messenger = Messenger.create(<span class="hljs-keyword">this</span>)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// trigger serverDidReady hook when all app workers</span></span><br><span class="line">    <span class="hljs-comment">// and agent worker is ready</span></span><br><span class="line">    <span class="hljs-keyword">this</span>.messenger.once(<span class="hljs-string">'egg-ready'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="hljs-keyword">this</span>.lifecycle.triggerServerDidReady()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">this</span>.ready(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span></span><br><span class="line">      process.nextTick(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="hljs-keyword">const</span> dumpStartTime = <span class="hljs-built_in">Date</span>.now()</span><br><span class="line">        <span class="hljs-keyword">this</span>.dumpConfig()</span><br><span class="line">        <span class="hljs-keyword">this</span>.dumpTiming()</span><br><span class="line">        <span class="hljs-keyword">this</span>.coreLogger.info(</span><br><span class="line">          <span class="hljs-string">'[egg:core] dump config after ready, %s'</span>,</span><br><span class="line">          ms(<span class="hljs-built_in">Date</span>.now() - dumpStartTime)</span><br><span class="line">        )</span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">this</span>.cluster = <span class="hljs-function">(<span class="hljs-params">clientClass, options</span>) =&gt;</span> &#123;</span><br><span class="line">      options = <span class="hljs-built_in">Object</span>.assign(&#123;&#125;, <span class="hljs-keyword">this</span>.config.clusterClient, options, &#123;</span><br><span class="line">        singleMode: <span class="hljs-keyword">this</span>.options.mode === <span class="hljs-string">'single'</span>,</span><br><span class="line">        <span class="hljs-comment">// cluster need a port that can't conflict on the environment</span></span><br><span class="line">        port: <span class="hljs-keyword">this</span>.options.clusterPort,</span><br><span class="line">        <span class="hljs-comment">// agent worker is leader, app workers are follower</span></span><br><span class="line">        isLeader: <span class="hljs-keyword">this</span>.type === <span class="hljs-string">'agent'</span>,</span><br><span class="line">        logger: <span class="hljs-keyword">this</span>.coreLogger</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="hljs-keyword">const</span> client = cluster(clientClass, options)</span><br><span class="line">      <span class="hljs-keyword">this</span>._patchClusterClient(client)</span><br><span class="line">      <span class="hljs-keyword">return</span> client</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>See agent.js and application.js</p><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// agent.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> EggApplication = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./egg'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> AgentWorkerLoader = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./loader'</span>).AgentWorkerLoader</span><br><span class="line"><span class="hljs-keyword">const</span> EGG_LOADER = <span class="hljs-built_in">Symbol</span>.for(<span class="hljs-string">'egg#loader'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Agent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EggApplication</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span>(options = &#123;&#125;) &#123;</span><br><span class="line">    options.type = <span class="hljs-string">'agent'</span></span><br><span class="line">    <span class="hljs-keyword">super</span>(options)</span><br><span class="line">    <span class="hljs-keyword">this</span>.loader.load()</span><br><span class="line">  &#125;</span><br><span class="line">  get [EGG_LOADER]() &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> AgentWorkerLoader</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// application.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> EggApplication = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./egg'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> AgentWorkerLoader = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./loader'</span>).AppWorkerLoader</span><br><span class="line"><span class="hljs-keyword">const</span> EGG_LOADER = <span class="hljs-built_in">Symbol</span>.for(<span class="hljs-string">'egg#loader'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EggApplication</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span>(options = &#123;&#125;) &#123;</span><br><span class="line">    options.type = <span class="hljs-string">'application'</span></span><br><span class="line">    <span class="hljs-keyword">super</span>(options)</span><br><span class="line">    <span class="hljs-keyword">this</span>.loader.load()</span><br><span class="line">  &#125;</span><br><span class="line">  get [EGG_LOADER]() &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> AppWorkerLoader</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>We can see that they override the _EGG_LOADER_ property, which uses to create a new <em>loader</em> field in the construction of EggCore that is their parent class. Finally, they call the <em>load</em> function.</p><p>We have the base application code. rNext, look a few of libs for starting web app.</p><h3 id="egg-scripts-and-egg-bin"><a href="#egg-scripts-and-egg-bin" class="headerlink" title="egg-scripts and egg-bin"></a><strong>egg-scripts and egg-bin</strong></h3><p>Both these libs start the web app in a different environment. Egg-scripts is easier and more clear, uses the production environment. Egg-bin has much code for helping debug, dev, test and so on, we usually use it in the dev, debug or test environment. We almost donâ€™t know them at most of time.</p><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="hljs-string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="hljs-string">"start"</span>: <span class="hljs-string">"env egg-scripts start"</span>,</span><br><span class="line">    <span class="hljs-string">"dev"</span>: <span class="hljs-string">"env egg-bin dev"</span>,</span><br><span class="line">    <span class="hljs-string">"stop"</span>: <span class="hljs-string">"egg-scripts stop"</span>,</span><br><span class="line">    <span class="hljs-string">"debug"</span>: <span class="hljs-string">"egg-bin debug"</span>,</span><br><span class="line">    <span class="hljs-string">"test"</span>: <span class="hljs-string">"npm run lint -- --fix &amp;&amp; npm run test-local"</span>,</span><br><span class="line">    <span class="hljs-string">"test-local"</span>: <span class="hljs-string">"env egg-bin test"</span>,</span><br><span class="line">    <span class="hljs-string">"cov"</span>: <span class="hljs-string">"egg-bin cov"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The <em>scripts</em> command of this eggjs app conforms to the above description.</p><h3 id="egg-cluster"><a href="#egg-cluster" class="headerlink" title="egg-cluster"></a><strong>egg-cluster</strong></h3><p>The cluster is an important feature for Eggjs. This lib is a bridge for connecting one single agent process and many workers processes. It like a manager.</p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- / lib</span><br><span class="line">  - / utils</span><br><span class="line">  - agent_worker.js</span><br><span class="line">  - app_worker.js</span><br><span class="line">  - master.js</span><br><span class="line">- index.js</span><br></pre></td></tr></table></figure><p>I had written an <a href="/2019/01/18/egg-cluster">article</a> about egg-cluster in Chinese. I always think this is the core of Eggjs, so I will explain the whole Eggjs framework around it.</p><h2 id="From-start-to-getting-the-first-request"><a href="#From-start-to-getting-the-first-request" class="headerlink" title="#From start to getting the first request"></a><strong>#From start to getting the first request</strong></h2><p><strong>What happens when we input <code>npm run dev</code> or <code>npm start</code> in the terminal?</strong></p><ul><li><strong>egg-scripts(prod):</strong> it can require <em>framework</em> by <code>child_process.spawn</code> and calls <em>startCluster</em> function.</li><li><strong>egg-bin(dev):</strong> it can require <em>framework</em> by <code>child_process.fork</code> and calls <em>startCluster</em> function.</li><li><code>[parent process]</code>: The command of running is in one process called the parent process. The system will create a new process called the master process when the parent process requires a framework.As usual, the <code>framework</code> is the file path of Eggjs.If you want to use a custom framework, you can add a param in the command, such as <code>--framework { your path }</code></li></ul><p><strong>Pseudo Code</strong></p><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// egg-scripts</span></span><br><span class="line"><span class="hljs-comment">// parent process</span></span><br><span class="line"><span class="hljs-keyword">const</span> spawn = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>).spawn <span class="hljs-comment">// create new process</span></span><br><span class="line">spawn(<span class="hljs-string">'node'</span>, <span class="hljs-string">'require(&#123;&#123; framework path &#125;&#125;).startCluster(...)'</span>, options))</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// egg-bin</span></span><br><span class="line"><span class="hljs-comment">// parent process</span></span><br><span class="line"><span class="hljs-keyword">const</span> cp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>)</span><br><span class="line">cp.fork(<span class="hljs-string">'require(&#123;&#123; framework path &#125;&#125;).startCluster(...)'</span>, args, options) <span class="hljs-comment">// create new process</span></span><br></pre></td></tr></table></figure><p>Egg-scripts uses <code>spawn</code> function to require framework while egg-scripts calls <code>fork</code> function.The latter is a special case of the former. Egg-bin has more code than egg-scripts, these features help us for developing or debug the app.</p><p>We have two processes. In general, this newly created process is called the master process.</p><p><strong>Why is the master process called birdge?</strong></p><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// egg index.js</span></span><br><span class="line">exports.startCluster = <span class="hljs-built_in">require</span>(<span class="hljs-string">'egg-cluster'</span>).startCluster</span><br></pre></td></tr></table></figure><p>Actually, we exec <code>egg-cluster</code>â€˜s startCluster function when we require the framework. We open <code>index.js</code> file in the egg-cluster lib. </p><p><strong>First, it is real enter point for whole web app.</strong></p><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// index.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> Master = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib/master'</span>)</span><br><span class="line">exports.startCluster = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options, callback</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">new</span> Master(options).ready(callback)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// ./lib/master.js</span></span><br><span class="line"><span class="hljs-keyword">const</span> ready = <span class="hljs-built_in">require</span>(<span class="hljs-string">'get-ready'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> detectPort = <span class="hljs-built_in">require</span>(<span class="hljs-string">'detect-port'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> Manager = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./utils/manager'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> Messenger = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./utils/messenger'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Master</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EventEmitter</span> </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">constructor</span>(options) &#123;</span><br><span class="line">    <span class="hljs-keyword">super</span>()</span><br><span class="line">    <span class="hljs-keyword">this</span>.options = parseOptions(options)</span><br><span class="line">    <span class="hljs-keyword">this</span>.workerManager = <span class="hljs-keyword">new</span> Manager()</span><br><span class="line">    <span class="hljs-keyword">this</span>.messenger = <span class="hljs-keyword">new</span> Messenger(<span class="hljs-keyword">this</span>)</span><br><span class="line"></span><br><span class="line">    ready.mixin(<span class="hljs-keyword">this</span>)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">this</span>.ready(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">this</span>.isStarted = <span class="hljs-literal">true</span></span><br><span class="line">      <span class="hljs-keyword">const</span> action = <span class="hljs-string">'egg-ready'</span></span><br><span class="line">      <span class="hljs-keyword">this</span>.messenger.send(&#123;</span><br><span class="line">        action,</span><br><span class="line">        to: <span class="hljs-string">'parent'</span>,</span><br><span class="line">        data: &#123; <span class="hljs-attr">port</span>: <span class="hljs-keyword">this</span>[REALPORT], <span class="hljs-attr">address</span>: <span class="hljs-keyword">this</span>[APP_ADDRESS] &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="hljs-keyword">this</span>.messenger.send(&#123; action, <span class="hljs-attr">to</span>: <span class="hljs-string">'app'</span>, <span class="hljs-attr">data</span>: <span class="hljs-keyword">this</span>.options &#125;)</span><br><span class="line">      <span class="hljs-keyword">this</span>.messenger.send(&#123; action, <span class="hljs-attr">to</span>: <span class="hljs-string">'agent'</span>, <span class="hljs-attr">data</span>: <span class="hljs-keyword">this</span>.options &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="hljs-comment">// start check agent and worker status</span></span><br><span class="line">      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isProduction) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.workerManager.startCheck()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// fork app workers after agent started</span></span><br><span class="line">    <span class="hljs-keyword">this</span>.once(<span class="hljs-string">'agent-start'</span>, <span class="hljs-keyword">this</span>.forkAppWorkers.bind(<span class="hljs-keyword">this</span>))</span><br><span class="line"></span><br><span class="line">    detectPort(<span class="hljs-function">(<span class="hljs-params">err, port</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-comment">/* istanbul ignore if */</span></span><br><span class="line">      <span class="hljs-keyword">if</span> (err) &#123;</span><br><span class="line">        err.name = <span class="hljs-string">'ClusterPortConflictError'</span></span><br><span class="line">        err.message = <span class="hljs-string">'[master] try get free port error, '</span> + err.message</span><br><span class="line">        <span class="hljs-keyword">this</span>.logger.error(err)</span><br><span class="line">        process.exit(<span class="hljs-number">1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="hljs-keyword">this</span>.options.clusterPort = port</span><br><span class="line">      <span class="hljs-keyword">this</span>.forkAgentWorker()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  forkAppWorkers() &#123;</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">    cluster.on(<span class="hljs-string">'fork'</span>, worker =&gt; &#123;</span><br><span class="line">      <span class="hljs-comment">// ...</span></span><br><span class="line">      worker.on(<span class="hljs-string">'message'</span>, msg =&gt; &#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> msg === <span class="hljs-string">'string'</span>) msg = &#123; <span class="hljs-attr">action</span>: msg, <span class="hljs-attr">data</span>: msg &#125;;</span><br><span class="line">        msg.from = <span class="hljs-string">'app'</span>;</span><br><span class="line">        <span class="hljs-keyword">this</span>.messenger.send(msg);</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="hljs-comment">// ...</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  forkAgentWorker() &#123;</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">    agentWorker.on(<span class="hljs-string">'message'</span>, msg =&gt; &#123;</span><br><span class="line">      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> msg === <span class="hljs-string">'string'</span>) msg = &#123; <span class="hljs-attr">action</span>: msg, <span class="hljs-attr">data</span>: msg &#125;;</span><br><span class="line">      msg.from = <span class="hljs-string">'agent'</span>;</span><br><span class="line">      <span class="hljs-keyword">this</span>.messenger.send(msg);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// the callback of ready function will be trigger after all major boots had been loaded</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// forkAgentWorker</span></span><br><span class="line"><span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">new</span> Agent(options)</span><br><span class="line">agent.ready(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span></span><br><span class="line">  process.send(&#123; <span class="hljs-attr">action</span>: <span class="hljs-string">'agent-start'</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">'master'</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// fork a single worker</span></span><br><span class="line"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> Application(options);</span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startServer</span>(<span class="hljs-params">err</span>) </span>&#123;  </span><br><span class="line">  <span class="hljs-keyword">let</span> server;</span><br><span class="line">  <span class="hljs-keyword">if</span> (options.https) &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> httpsOptions = <span class="hljs-built_in">Object</span>.assign(&#123;&#125;, options.https, &#123;</span><br><span class="line">      key: fs.readFileSync(options.https.key),</span><br><span class="line">      cert: fs.readFileSync(options.https.cert),</span><br><span class="line">    &#125;);</span><br><span class="line">    server = <span class="hljs-built_in">require</span>(<span class="hljs-string">'https'</span>).createServer(httpsOptions, app.callback());</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    server = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>).createServer(app.callback());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// emit `server` event in app</span></span><br><span class="line">  app.emit(<span class="hljs-string">'server'</span>, server);</span><br><span class="line">  </span><br><span class="line">  server.listen(...args);</span><br><span class="line">&#125;</span><br><span class="line">app.ready(startServer);</span><br></pre></td></tr></table></figure><p>On the other hand, this web will be constructed during creating a <code>Master</code> object.</p><ul><li>workerManager: it will hold on all worker porcesses.</li><li>messenger: we make <code>master</code> a transit station that helps process for communicating (IPC). If you read more code, you can get it. I have said above that it is a bridge. I have write an <a href="[http://localhost:4000/2019/01/18/egg-cluster/#Agent-Works%E6%80%8E%E4%B9%88%E9%80%9A%E4%BF%A1%E5%91%A2-IPC](http://localhost:4000/2019/01/18/egg-cluster/#Agent-Worksæ€ä¹ˆé€šä¿¡å‘¢-IPC">article(Chinese)</a>) about it.</li></ul><blockquote><ul><li>The Master maintains a Messenger instance (egg-cluster/lib/utils/messenger.js)</li><li>EggApplication maintain the other Messenge instance ï¼ˆegg/lib/core/messenger.jsï¼‰</li><li>Both the agent and worker process base on EggApplication, them can send info to the master process creating them when calling Messenger. The master process is according to entering params to transmit to the agent or worker, you read forkAppWorkers and forkAgentWorker function in the master</li></ul></blockquote><ul><li><p>ready.mixin &amp; this.ready: â€˜get-readyâ€™ often is used by the official when an object need trigger a few callbacks after it whole initializes. Here it will broadcast an event to the parent, workers and then agent process, telling them that I am ok.</p></li><li><p>detectPort: apply for an available port, default is 7001.If Successly, it will <code>fork</code> an agent process and register a callback message for new created an agent object.</p></li><li><p><code>[agent process]</code>: create new Agent and run loadPlugin, loadConfig, loadAgentExtend, loadContextExtend, and loadCustomAgent.</p><ul><li><p>loadPlugin: find all plugin, record their dir paths =&gt; this.dirs</p></li><li><p>loadConfig: merge all config, the config content of the app level is more priority than the framework and the latter is more priority than the plugin.</p></li><li>loadAgentExtend: load and merge all of the extending of agent object  (<em>app &gt; plugin &gt; core</em>)</li><li>loadContextExtend: load and merge all of the extending of context object  (<em>app &gt; plugin &gt; core</em>)</li><li>loadCustomAgent: it is important that the lifecycle of app boot will be serially triggered. This lifecycle field is defined in EggCore constructor, we can look at the whole process in the yellow background under the image.ã€<a href="https://eggjs.org/en/basics/app-start.html" target="_blank" rel="noopener">Application Startup Configuration(official)</a>ã€‘. It help you for better writing a few plugins.</li><li>Last, all major boots had been loaded, the agent process will trigger function registered in the callback array, such as sending <code>&#39;agent-start&#39;</code> to the master process.</li></ul></li></ul><p><img src="/images/egg-boot/egg-boot.jpg" alt="egg boot process"></p><ul><li><p><code>[master process]</code>: start to fork a few worker processes in accordance with specifying or using the default being CPU kernel count after the master process get <code>&#39;agent-start&#39;</code> message from the agent process. It will open a new relatable load, we take a single worker process example.</p></li><li><p><code>[a single worker process]</code>: create new Agent and run loadPlugin, loadConfig, loadApplicationExtend, loadRequestExtend, loadResponseExtend, loadContextExtend, loadHelperExtend, loadCustomApp, loadService, loadMiddleware, loadController, loadRouter, and loadCustomLoader.</p><ul><li><p>loadPlugin: same as the agent</p></li><li><p>loadConfig: same as the agent</p></li><li><p>loadApplicationExtend: same as the agent  (<em>app &gt; plugin &gt; core</em>)</p></li><li><p>loadRequestExtend: load and merge all of the extending of request object (<em>app &gt; plugin &gt; core</em>)</p></li><li><p>loadResponseExtend: load and merge all of the extending of response object (<em>app &gt; plugin &gt; core</em>)</p></li><li><p>loadContextExtend: same as the agent</p></li><li><p>loadHelperExtend: load and merge all of the extending of helper object (<em>app &gt; plugin &gt; core</em>)</p></li><li><p>loadCustomApp: same as the agent ï¼ˆ<em>app &gt; plugin</em>ï¼‰</p></li><li><p>loadService: load and merge all of the extending of helper object ï¼ˆ<em>app &gt; plugin</em>ï¼‰</p></li><li><p>loadMiddleware: load middlewares and iterate them =&gt; mw, if it conforms the middleware standard, it will be used with app.use(mw) ï¼ˆ<em>app &gt; plugin &gt; core</em>ï¼‰</p></li><li><p>loadController: iterate all controllersâ€™ functions =&gt; key, wrap a function, make it be a middleware function and is bound to controller.xxx.xxx (only <em>app</em>). This middleware will be triggered when getting a new request, the Controller is defined in the <code>app/controller</code> directory and the key is itâ€™s function.</p><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">methodToMiddleware</span>(<span class="hljs-params">Controller, key</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">classControllerMiddleware</span>(<span class="hljs-params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> Controller(<span class="hljs-keyword">this</span>);</span><br><span class="line">    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.app.config.controller || !<span class="hljs-keyword">this</span>.app.config.controller.supportParams) &#123;</span><br><span class="line">      args = [ <span class="hljs-keyword">this</span> ];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-keyword">return</span> utils.callFn(controller[key], args, controller);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>loadRouter: it makes requestâ€™s path associated with the controllersâ€™ function that has been become to middleware (only <em>app</em>)</p></li><li><p>loadCustomLoader: load ourselves function to create some built-in objects for app object or other.<a href="https://eggjs.org/en/advanced/loader.html#customloader" target="_blank" rel="noopener">Customloader</a></p></li></ul><ul><li><code>[master process]</code>: it listens to all worker processes and triggers the masterâ€™s ready once they have finished booting.</li><li>send <code>egg-ready</code> to the parent process, the agent process, the app worker processes</li><li>Last, traverse BOOTS and run serverDidReady function of each item.</li></ul><p>It is the whole boot for Eggjs framework but doesnâ€™t include, such as restarting a worker process when it exits or disconnects,  shuting downâ€¦</p><p><strong>Second, every process is alone if we have not the master. It like a bridge organizing all island, from creation to IPC.</strong></p><p><strong>What happens when web app get an Http request?</strong></p><p><em>We only discuss Eggjs code in the applaction layer. :)</em></p><p>The <code>agent</code> canâ€™t deal with any request because it doesnâ€™t listen port. All request always hand over to <code>workers</code>. We look at creating worker code, it will run a app.callback function and listen port when it has booted.</p><p>This callback is the members of Appliaction in Koa. If server get new request, it will create a new context and handle it. In Eggjs, this handleRequest function has been overwrited. Last, the framework will iterate over all middleware under the current route including the converted controllerâ€™s function.</p><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// koa/lib/application</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Emitter</span> </span>&#123;</span><br><span class="line">  callback() &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> fn = compose(<span class="hljs-keyword">this</span>.middleware);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.listenerCount(<span class="hljs-string">'error'</span>)) <span class="hljs-keyword">this</span>.on(<span class="hljs-string">'error'</span>, <span class="hljs-keyword">this</span>.onerror);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">const</span> handleRequest = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">const</span> ctx = <span class="hljs-keyword">this</span>.createContext(req, res);</span><br><span class="line">      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.handleRequest(ctx, fn);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> handleRequest;</span><br><span class="line">  &#125;</span><br><span class="line">  handleRequest(ctx, fnMiddleware) &#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> res = ctx.res;</span><br><span class="line">    res.statusCode = <span class="hljs-number">404</span>;</span><br><span class="line">    <span class="hljs-keyword">const</span> onerror = <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> ctx.onerror(err);</span><br><span class="line">    <span class="hljs-keyword">const</span> handleResponse = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> respond(ctx);</span><br><span class="line">    onFinished(res, onerror);</span><br><span class="line">    <span class="hljs-keyword">return</span> fnMiddleware(ctx).then(handleResponse).catch(onerror);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// egg/lib/application</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EggApplication</span> </span>&#123;</span><br><span class="line">handleRequest(ctx, fnMiddleware) &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.emit(<span class="hljs-string">'request'</span>, ctx)</span><br><span class="line">    <span class="hljs-keyword">super</span>.handleRequest(ctx, fnMiddleware)</span><br><span class="line">    onFinished(ctx.res, () =&gt; <span class="hljs-keyword">this</span>.emit(<span class="hljs-string">'response'</span>, ctx))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>In summary, we have know how to boot web app and deal with request in Eggjs.</strong> When we know it, we can easily write some plugins and middlewares to finish the business requirements.</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Preface&quot;&gt;&lt;a href=&quot;#Preface&quot; class=&quot;headerlink&quot; title=&quot;#Preface&quot;&gt;&lt;/a&gt;&lt;strong&gt;#Preface&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;This article will introduce the boot of &lt;a href=&quot;https://eggjs.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Eggjs&lt;/a&gt; that is a Node.js web framework.&lt;/p&gt;
&lt;p&gt;It is based on Koa and can satisfy  your requirement through a large of plugins and middleware, even a your own framework. It is very important to create a cluster, an agent process and some worker processes when it is running. The cluster makes it stronger. Next, we can understand it by reading the source code.&lt;/p&gt;
&lt;p&gt;Eggjs has a few major libs, egg-coreã€eggã€egg-clusterã€egg-binã€egg-scripts and so on.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;egg-core&lt;/strong&gt;: it extends Koa and is as a parent object of every agent and worker.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;egg&lt;/strong&gt;: it defines some actions for agent and worker,  you can almost use these actions to create an app of a single process.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;egg-cluster&lt;/strong&gt;: it creates a cluster and manages them.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;egg-scripts and Egg-bin&lt;/strong&gt;: their job is run the whole app in a different environment.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Tips: We will discuss Eggjs with basing 2.x.x version.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="https://miser.github.io/categories/javascript/"/>
    
    
  </entry>
  
  <entry>
    <title>Egg Cluster ç®€å•ä»‹ç»</title>
    <link href="https://miser.github.io/2019/01/18/egg-cluster/"/>
    <id>https://miser.github.io/2019/01/18/egg-cluster/</id>
    <published>2019-01-18T13:48:01.464Z</published>
    <updated>2019-01-18T19:30:11.959Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚æœä¸æ¸…æ¥šä»€ä¹ˆæ˜¯Egg.jsï¼Œå¸Œæœ›èƒ½ç§»æ­¥åˆ°å®ƒçš„<a href="https://eggjs.org" target="_blank" rel="noopener">å®˜ç½‘</a>ç®€å•çœ‹ä¸‹ã€‚å¦å¤–è¯´å®ƒæ˜¯<strong>çº¦å®šå¤§äºé…ç½®</strong>çš„è¯ï¼Œæˆ‘åªèƒ½è¯´ä½ çœŸçš„ä¸äº†è§£å®ƒï¼Œæˆ–è€…è¯´ä¸äº†è§£æ¡†æ¶ï¼Œå“ªä¸ªæ¡†æ¶æ²¡æœ‰çº¦å®šï¼Ÿæ¯•ç«Ÿæ²¡æœ‰è§„çŸ©ä¸æˆæ–¹åœ†ï¼Œä½•å†µæ˜¯é€»è¾‘æ€§çš„ç¨‹åºå‘¢ï¼Ÿå®˜æ–¹åˆ—å‡ºçš„ç‰¹æ€§å¦‚ä¸‹ï¼š</p><blockquote><p>1.æä¾›åŸºäº Egg <a href="https://eggjs.org/zh-cn/advanced/framework.html" target="_blank" rel="noopener">å®šåˆ¶ä¸Šå±‚æ¡†æ¶</a> çš„èƒ½åŠ›<br>2.é«˜åº¦å¯æ‰©å±•çš„<a href="https://eggjs.org/zh-cn/basics/plugin.html" target="_blank" rel="noopener">æ’ä»¶æœºåˆ¶</a><br>3.å†…ç½®<a href="https://eggjs.org/zh-cn/advanced/cluster-client.html" target="_blank" rel="noopener">å¤šè¿›ç¨‹ç®¡ç†</a><br>4.åŸºäº <a href="http://koajs.com/" target="_blank" rel="noopener">Koa</a> å¼€å‘ï¼Œæ€§èƒ½ä¼˜å¼‚<br>5.æ¡†æ¶ç¨³å®šï¼Œæµ‹è¯•è¦†ç›–ç‡é«˜<br>6.<a href="https://eggjs.org/zh-cn/tutorials/progressive.html" target="_blank" rel="noopener">æ¸è¿›å¼å¼€å‘</a></p></blockquote><p>ç¬¬1æ¡ï¼Œå®ƒæœ‰é‚£ä¹ˆKoaä¹Ÿæœ‰å•Šã€‚ç¬¬2æ¡ï¼Œå®ƒæœ‰ï¼Œéš¾é“Koaã€Expressç­‰å°±æ²¡æœ‰å˜›ï¼Ÿç¬¬4æ¡ï¼Œæ›´å¥½çš„è¡¥å……äº†Koaä¸æ˜¯æ›´å¥½å—ï¼Ÿç¬¬5æ¡ï¼Œéš¾é“åˆ«çš„æ¡†æ¶å°±ä¸ç¨³å®šäº†ï¼Ÿç¬¬6æ¡ï¼Œå‰ç«¯é¼“å¹æ¸è¿›å¼ã€åç«¯ä¹Ÿé¼“å¹ï¼Œé‚£ç©¶ç«Ÿä»€ä¹ˆæ˜¯æ¸è¿›å¼å‘¢ï¼Ÿ</p><p>åœ¨æˆ‘çœ‹æ¥æœ€å¸å¼•æˆ‘çš„æ˜¯ç¬¬3æ¡ï¼Œ<strong>å†…ç½®å¤šè¿›ç¨‹ç®¡ç†</strong>ï¼Œè¿™ä¸ªåœ¨å…¶å®ƒä¸»æµnodejsæ¡†æ¶ä¸­æ˜¯ç¨€ç¼ºçš„ç‰¹æ€§ï¼Œæ­¤æ–‡å°±ç®€å•èŠèŠå®ƒã€‚</p><a id="more"></a><h3 id="ä»æºç æ…¢æ…¢äº†è§£"><a href="#ä»æºç æ…¢æ…¢äº†è§£" class="headerlink" title="#ä»æºç æ…¢æ…¢äº†è§£"></a><strong>#ä»æºç æ…¢æ…¢äº†è§£</strong></h3><ul><li><strong>egg-core</strong>: å®šä¹‰äº†ä¸€ä¸ª<strong>EggCore</strong>ç±»ï¼Œå®ƒç»§æ‰¿KoaApplicationï¼Œä¹Ÿå°±æ˜¯ç‰¹æ€§ä¸­æåˆ°çš„ç¬¬4æ¡ <em>åŸºäºKoaå¼€å‘ï¼Œæ€§èƒ½ä¼˜å¼‚</em></li><li><strong>egg</strong>: å®šä¹‰äº†ä¸€ä¸ªç»§æ‰¿äºEggCoreçš„<strong>EggApplication</strong>ç±»ï¼Œå¹¶ä¸”Applicationå’ŒAgentåˆ†åˆ«ç»§æ‰¿äºEggApplication</li><li><strong>egg-cluster</strong>: è¿™ä¸ªç±»åº“ä¸»è¦å°±æ˜¯åš<strong>å¤šè¿›ç¨‹ç®¡ç†</strong>çš„å·¥ä½œ</li></ul><p><em>egg-clusterè®©Egg.jså˜å¾—ä¸ä¼—ä¸åŒ</em>ï¼Œçœ‹çœ‹å®ƒåšäº†ä»€ä¹ˆã€‚</p><h3 id="egg-cluster"><a href="#egg-cluster" class="headerlink" title="egg-cluster"></a>egg-cluster</h3><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// egg-cluster index.js å”¯ä¸€å¯¹å¤–æš´éœ²çš„æ¥å£ startCluster</span></span><br><span class="line">exports.startCluster = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options, callback</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">new</span> Master(options).ready(callback)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>egg-clusterå°±æ˜¯é Masteråœ¨ç®¡ç†eggé‡Œé¢çš„angentå’Œworkersï¼ˆapplicationï¼‰,å¦å¤–å®ƒä¹Ÿæ˜¯å®ƒä»¬ä¹‹é—´é€šä¿¡çš„ä¸­è½¬ç«™ï¼Œçœ‹ä¸‹å®˜ç½‘ç»™å‡ºçš„å›¾è§£ï¼š<br><img src="/images/egg-cluster/1.jpg" alt="Master-Agent-Works æ¨¡å‹"></p><h3 id="Agent-Worksæ€ä¹ˆå¯åŠ¨çš„ï¼Ÿ"><a href="#Agent-Worksæ€ä¹ˆå¯åŠ¨çš„ï¼Ÿ" class="headerlink" title="Agent-Worksæ€ä¹ˆå¯åŠ¨çš„ï¼Ÿ"></a>Agent-Worksæ€ä¹ˆå¯åŠ¨çš„ï¼Ÿ</h3><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Master</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EventEmitter</span> </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">constructor</span>(options) &#123;</span><br><span class="line">        <span class="hljs-keyword">this</span>.workerManager = <span class="hljs-keyword">new</span> Manager();</span><br><span class="line">    <span class="hljs-keyword">this</span>.messenger = <span class="hljs-keyword">new</span> Messenger(<span class="hljs-keyword">this</span>);</span><br><span class="line">        <span class="hljs-comment">// ...</span></span><br><span class="line"><span class="hljs-keyword">this</span>.once(<span class="hljs-string">'agent-start'</span>, <span class="hljs-keyword">this</span>.forkAppWorkers.bind(<span class="hljs-keyword">this</span>));</span><br><span class="line">        <span class="hljs-comment">// ...</span></span><br><span class="line">        detectPort(<span class="hljs-function">(<span class="hljs-params">err, port</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="hljs-comment">// è¯•ç€æ‰¾ä¸ªå¯ä»¥ç”¨çš„port</span></span><br><span class="line">            <span class="hljs-keyword">this</span>.options.clusterPort = port;</span><br><span class="line">            <span class="hljs-comment">// å¯åŠ¨ agent</span></span><br><span class="line">            <span class="hljs-keyword">this</span>.forkAgentWorker();</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="hljs-comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    forkAgentWorker() &#123;</span><br><span class="line">        <span class="hljs-comment">// ... childprocess.fork egg-cluster/lib/agent_worker.js</span></span><br><span class="line">        <span class="hljs-keyword">const</span> agentWorker = childprocess.fork(<span class="hljs-keyword">this</span>.getAgentWorkerFile(), args, opt);</span><br><span class="line">        <span class="hljs-comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    forkAppWorkers() &#123;</span><br><span class="line">        <span class="hljs-comment">// å°†éœ€è¦æ•°é‡çš„ worker ä¸€ä¸ªä¸ªåˆ›å»ºå‡ºæ¥</span></span><br><span class="line">        <span class="hljs-comment">// cluster.fork egg-cluster/lib/agent_worker.js å®ƒä»¬å°†ç›‘å¬åŒä¸€ä¸ªæœåŠ¡ç«¯å£</span></span><br><span class="line">        <span class="hljs-comment">// åˆ›å»º httpæˆ–httpsæœåŠ¡</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>agent_worker.jsä¸»è¦é€»è¾‘å°±æ˜¯åˆ›å»ºeggç±»åº“é‡Œçš„Agentç±»ï¼Œå®Œæˆåå‘â€agent-startâ€ç»™çˆ¶è¿›ç¨‹ï¼Œè§¦å‘Masterçš„è®¢é˜…åˆ›å»ºWorkers</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// egg-cluster/lib/agent_worker.js</span></span><br><span class="line"><span class="hljs-comment">// ...</span></span><br><span class="line">process.send(&#123; <span class="hljs-attr">action</span>: <span class="hljs-string">'agent-start'</span>, <span class="hljs-attr">to</span>: <span class="hljs-string">'master'</span> &#125;); </span><br><span class="line"><span class="hljs-comment">// ...</span></span><br></pre></td></tr></table></figure><h3 id="Agent-Worksæ€ä¹ˆé€šä¿¡å‘¢-IPC"><a href="#Agent-Worksæ€ä¹ˆé€šä¿¡å‘¢-IPC" class="headerlink" title="Agent-Worksæ€ä¹ˆé€šä¿¡å‘¢? (IPC)"></a>Agent-Worksæ€ä¹ˆé€šä¿¡å‘¢? (<a href="https://eggjs.org/zh-cn/core/cluster-and-ipc.html" target="_blank" rel="noopener">IPC</a>)</h3><ul><li>åœ¨Masterä¸­ç»´æŠ¤ç€ä¸€ä¸ªMessengerï¼ˆegg-cluster/lib/utils/messenger.jsï¼‰å®ä¾‹</li><li>EggApplicationä¸­ç»´æŠ¤äº†å¦ä¸€ä¸ªMessengerï¼ˆegg/lib/core/messenger.jsï¼‰å®ä¾‹</li></ul><p>ç”±äºAgentå’ŒWorker(Application)éƒ½ç»§æ‰¿EggApplicationï¼Œå®ƒä»¬è°ƒç”¨Messengerçš„æ—¶å€™ä¼šsendåˆ°åˆ›å»ºå®ƒä»¬çš„Masteré‡Œï¼Œç„¶åMasterå†æ ¹æ®ä¼ è¿‡æ¥çš„å‚æ•°sendç»™ä¸åŒçš„Agentæˆ–Workerï¼ŒMasteré‡Œçš„è½¬å‘é€»è¾‘å¦‚ä¸‹ã€‚</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// egg-cluster master.js</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Master</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EventEmitter</span> </span>&#123;</span><br><span class="line">    forkAppWorkers() &#123;</span><br><span class="line">        <span class="hljs-comment">// ...</span></span><br><span class="line">        cluster.on(<span class="hljs-string">'fork'</span>, worker =&gt; &#123;</span><br><span class="line">            <span class="hljs-comment">// ...</span></span><br><span class="line">            worker.on(<span class="hljs-string">'message'</span>, msg =&gt; &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> msg === <span class="hljs-string">'string'</span>) msg = &#123; <span class="hljs-attr">action</span>: msg, <span class="hljs-attr">data</span>: msg &#125;;</span><br><span class="line">            msg.from = <span class="hljs-string">'app'</span>;</span><br><span class="line">            <span class="hljs-keyword">this</span>.messenger.send(msg);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="hljs-comment">// ...</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    forkAgentWorker() &#123;</span><br><span class="line">        <span class="hljs-comment">// ...</span></span><br><span class="line">        agentWorker.on(<span class="hljs-string">'message'</span>, msg =&gt; &#123;</span><br><span class="line">          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> msg === <span class="hljs-string">'string'</span>) msg = &#123; <span class="hljs-attr">action</span>: msg, <span class="hljs-attr">data</span>: msg &#125;;</span><br><span class="line">          msg.from = <span class="hljs-string">'agent'</span>;</span><br><span class="line">          <span class="hljs-keyword">this</span>.messenger.send(msg);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="hljs-comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// egg messenger.js</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Messenger</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EventEmitter</span> </span>&#123;</span><br><span class="line">    send(action, data, to) &#123;</span><br><span class="line">        sendmessage(process, &#123;</span><br><span class="line">          action,</span><br><span class="line">          data,</span><br><span class="line">          to,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€æ¡ä¿¡æ¯å¿…å®šæœ‰<strong>from</strong>â€¦<strong>to</strong>â€¦ä¿¡æ¯</p><p><img src="/images/egg-cluster/2.jpg" alt="Master-Agent-Works é€šä¿¡æ¨¡å‹"></p><h3 id="å®˜ç½‘é‡Œæåˆ°çš„â€œå¤šè¿›ç¨‹ç ”å‘æ¨¡å¼å¢å¼ºâ€"><a href="#å®˜ç½‘é‡Œæåˆ°çš„â€œå¤šè¿›ç¨‹ç ”å‘æ¨¡å¼å¢å¼ºâ€" class="headerlink" title="å®˜ç½‘é‡Œæåˆ°çš„â€œå¤šè¿›ç¨‹ç ”å‘æ¨¡å¼å¢å¼ºâ€"></a>å®˜ç½‘é‡Œæåˆ°çš„â€œ<a href="https://eggjs.org/zh-cn/advanced/cluster-client.html" target="_blank" rel="noopener">å¤šè¿›ç¨‹ç ”å‘æ¨¡å¼å¢å¼º</a>â€</h3><p><img src="/images/egg-cluster/3.jpg" alt="ä¸€ä¸ªç¨‹åºè¿è¡Œnä¸ªworkerè¿mä¸ªè¿œç¨‹æœåŠ¡"></p><ul><li>n * m ä¸ªè¿æ¥å¯¼è‡´å¤§é‡è¿æ¥èµ„æºâ€œæµªè´¹â€</li><li>å‡å°‘Masterè½¬å‘å¸¦æ¥çš„é¢å¤–æ€§èƒ½æ¶ˆè€—</li><li>å¦å¤–ï¼Œeggçš„ä½œè€…ä»¬æ‹…å¿ƒä¸å½“çš„IPCé€šä¿¡æŠŠMasterææŒ‚ï¼Œä»è€Œæ•´ä¸ªæœåŠ¡å¼‚å¸¸</li></ul><p>æ‰€ä»¥è¿˜æœ‰ä¸€ç§socketé€šä¿¡æ–¹å¼ï¼ˆä½¿ç”¨äº†å¦ä¸€ä¸ªåº“<a href="https://github.com/node-modules/cluster-client" target="_blank" rel="noopener">cluster-client</a>ï¼‰ï¼š</p><ul><li>å°†Agentä½œä¸ºLeaderï¼Œä»æœåŠ¡ç«¯è·å–æ•°æ®ï¼Œå¹¶åšç¼“å­˜</li><li>å°†Workerä½œä¸ºFollowerï¼Œè®¢é˜…Agentè·å–çš„æ•°æ®</li></ul><p>å…¸å‹çš„åœºæ™¯æœ‰ï¼ŒLeaderï¼ˆAgentï¼‰è·å–disconfé‡Œçš„é…ç½®ã€è·å–euerkaé‡Œçš„æœåŠ¡ç­‰ï¼ŒFollowerï¼ˆWorkerï¼‰ä½¿ç”¨è¿™äº›é…ç½®å’ŒæœåŠ¡ã€‚</p><p><img src="/images/egg-cluster/4.jpg" alt="socketé€šä¿¡"></p><h3 id="cluster-client-æºç ä¸€ç¥"><a href="#cluster-client-æºç ä¸€ç¥" class="headerlink" title="cluster-client æºç ä¸€ç¥"></a>cluster-client æºç ä¸€ç¥</h3><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClusterClient</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Base</span> </span>&#123;</span><br><span class="line">    <span class="hljs-comment">// ...</span></span><br><span class="line">    <span class="hljs-keyword">async</span> [init]() &#123;</span><br><span class="line">        <span class="hljs-keyword">const</span> name = <span class="hljs-keyword">this</span>.options.name;</span><br><span class="line">        <span class="hljs-keyword">const</span> port = <span class="hljs-keyword">this</span>.options.port;</span><br><span class="line">        <span class="hljs-keyword">let</span> server;</span><br><span class="line">        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.isLeader === <span class="hljs-literal">true</span>) &#123;</span><br><span class="line">          server = <span class="hljs-keyword">await</span> ClusterServer.create(name, port);</span><br><span class="line">          <span class="hljs-keyword">if</span> (!server) &#123;</span><br><span class="line">            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`create "<span class="hljs-subst">$&#123;name&#125;</span>" leader failed, the port:<span class="hljs-subst">$&#123;port&#125;</span> is occupied by other`</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.isLeader === <span class="hljs-literal">false</span>) &#123;</span><br><span class="line">          <span class="hljs-comment">// wait for leader active</span></span><br><span class="line">          <span class="hljs-keyword">await</span> ClusterServer.waitFor(port, <span class="hljs-keyword">this</span>.options.maxWaitTime);</span><br><span class="line">        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">          debug(<span class="hljs-string">'[ClusterClient:%s] init cluster client, try to seize the leader on port:%d'</span>, name, port);</span><br><span class="line">          server = <span class="hljs-keyword">await</span> ClusterServer.create(name, port);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> (server) &#123;</span><br><span class="line">          <span class="hljs-keyword">this</span>[innerClient] = <span class="hljs-keyword">new</span> Leader(<span class="hljs-built_in">Object</span>.assign(&#123; server &#125;, <span class="hljs-keyword">this</span>.options));</span><br><span class="line">          debug(<span class="hljs-string">'[ClusterClient:%s] has seized port %d, and serves as leader client.'</span>, name, port);</span><br><span class="line">        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">          <span class="hljs-keyword">this</span>[innerClient] = <span class="hljs-keyword">new</span> Follower(<span class="hljs-keyword">this</span>.options);</span><br><span class="line">          debug(<span class="hljs-string">'[ClusterClient:%s] gives up seizing port %d, and serves as follower client.'</span>, name, port);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="hljs-comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>portæ•°å€¼å°±æ˜¯ä¸Šæ–‡å¼€å§‹å¤„é€šè¿‡detectPortè·å–çš„clusterPortæ•°å€¼</li><li>ç„¶ånet.create åˆ›å»ºTCPæœåŠ¡ï¼Œä¹‹åæ‰€æœ‰çš„Leaderå’ŒFolloweréƒ½ä¼šèµ°å®ƒæä¾›çš„æœåŠ¡è¿›è¡Œsocketé€šä¿¡</li><li>Leaderè·å–æ•°æ®è§¦å‘publishï¼Œä¼ ç»™è®¢é˜…çš„Followerä¸­</li></ul><p>cluster-clientæºç æ˜¯å¾ˆå¤æ‚çš„ï¼Œä¸­é—´è¿˜æ¶‰åŠåˆ°ä¸“é€’æ•°æ®çš„æ ¼å¼ï¼Œè¿›è¡Œæ•°æ®åŒ…çš„è§£æç­‰ç­‰ï¼Œè¿™è¾¹å°±ä¸æ‰©å±•ä»‹ç»äº†ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªå·±æ’¸æºç ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="#æ€»ç»“"></a><strong>#æ€»ç»“</strong></h3><p>Egg.jsçš„è¿›ç¨‹ç®¡ç†å’Œé€šä¿¡è‡ªç„¶ä¸ä¼šåƒæ–‡ç« é‡Œè¯´çš„é‚£ä¹ˆç®€å•ï¼Œä½†å¤§ä½“å¦‚æ­¤ã€‚å¼„æ¸…æ¥šå®ƒä»¬çš„å·¥ä½œåŸç†å¯¹å¼€å‘ç¨‹åºã€æ’ä»¶ã€ä¸­é—´ä»¶æœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼Œä¸ªäººè®¤ä¸ºè¿™ä¸ªæ‰æ˜¯è¿™ä¸ªæ¡†æ¶çš„ç²¾é«“ä¹‹å¤„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¦‚æœä¸æ¸…æ¥šä»€ä¹ˆæ˜¯Egg.jsï¼Œå¸Œæœ›èƒ½ç§»æ­¥åˆ°å®ƒçš„&lt;a href=&quot;https://eggjs.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å®˜ç½‘&lt;/a&gt;ç®€å•çœ‹ä¸‹ã€‚å¦å¤–è¯´å®ƒæ˜¯&lt;strong&gt;çº¦å®šå¤§äºé…ç½®&lt;/strong&gt;çš„è¯ï¼Œæˆ‘åªèƒ½è¯´ä½ çœŸçš„ä¸äº†è§£å®ƒï¼Œæˆ–è€…è¯´ä¸äº†è§£æ¡†æ¶ï¼Œå“ªä¸ªæ¡†æ¶æ²¡æœ‰çº¦å®šï¼Ÿæ¯•ç«Ÿæ²¡æœ‰è§„çŸ©ä¸æˆæ–¹åœ†ï¼Œä½•å†µæ˜¯é€»è¾‘æ€§çš„ç¨‹åºå‘¢ï¼Ÿå®˜æ–¹åˆ—å‡ºçš„ç‰¹æ€§å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.æä¾›åŸºäº Egg &lt;a href=&quot;https://eggjs.org/zh-cn/advanced/framework.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å®šåˆ¶ä¸Šå±‚æ¡†æ¶&lt;/a&gt; çš„èƒ½åŠ›&lt;br&gt;2.é«˜åº¦å¯æ‰©å±•çš„&lt;a href=&quot;https://eggjs.org/zh-cn/basics/plugin.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ’ä»¶æœºåˆ¶&lt;/a&gt;&lt;br&gt;3.å†…ç½®&lt;a href=&quot;https://eggjs.org/zh-cn/advanced/cluster-client.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å¤šè¿›ç¨‹ç®¡ç†&lt;/a&gt;&lt;br&gt;4.åŸºäº &lt;a href=&quot;http://koajs.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Koa&lt;/a&gt; å¼€å‘ï¼Œæ€§èƒ½ä¼˜å¼‚&lt;br&gt;5.æ¡†æ¶ç¨³å®šï¼Œæµ‹è¯•è¦†ç›–ç‡é«˜&lt;br&gt;6.&lt;a href=&quot;https://eggjs.org/zh-cn/tutorials/progressive.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ¸è¿›å¼å¼€å‘&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¬¬1æ¡ï¼Œå®ƒæœ‰é‚£ä¹ˆKoaä¹Ÿæœ‰å•Šã€‚ç¬¬2æ¡ï¼Œå®ƒæœ‰ï¼Œéš¾é“Koaã€Expressç­‰å°±æ²¡æœ‰å˜›ï¼Ÿç¬¬4æ¡ï¼Œæ›´å¥½çš„è¡¥å……äº†Koaä¸æ˜¯æ›´å¥½å—ï¼Ÿç¬¬5æ¡ï¼Œéš¾é“åˆ«çš„æ¡†æ¶å°±ä¸ç¨³å®šäº†ï¼Ÿç¬¬6æ¡ï¼Œå‰ç«¯é¼“å¹æ¸è¿›å¼ã€åç«¯ä¹Ÿé¼“å¹ï¼Œé‚£ç©¶ç«Ÿä»€ä¹ˆæ˜¯æ¸è¿›å¼å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘çœ‹æ¥æœ€å¸å¼•æˆ‘çš„æ˜¯ç¬¬3æ¡ï¼Œ&lt;strong&gt;å†…ç½®å¤šè¿›ç¨‹ç®¡ç†&lt;/strong&gt;ï¼Œè¿™ä¸ªåœ¨å…¶å®ƒä¸»æµnodejsæ¡†æ¶ä¸­æ˜¯ç¨€ç¼ºçš„ç‰¹æ€§ï¼Œæ­¤æ–‡å°±ç®€å•èŠèŠå®ƒã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="https://miser.github.io/categories/javascript/"/>
    
    
  </entry>
  
  <entry>
    <title>Vue Component ç»§æ‰¿ä¸å¤ç”¨</title>
    <link href="https://miser.github.io/2018/11/17/vue-component-extends/"/>
    <id>https://miser.github.io/2018/11/17/vue-component-extends/</id>
    <published>2018-11-17T06:45:00.000Z</published>
    <updated>2018-11-20T09:24:26.765Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨åšWebå‰ç«¯å¼€å‘çš„æ—¶å€™ä¼šæœ‰å¤§é‡çš„é¡µé¢å¤ç”¨çš„åœ°æ–¹ï¼Œä»UIå¸ƒå±€åˆ°JSçš„é€»è¾‘ã€‚æ—©å¹´åšåç«¯å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥é€šè¿‡é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ³•å¼ï¼Œä½¿ç”¨æŠ½è±¡ç±»ã€æ¥å£ç­‰ç­‰ï¼Œé‚£ä¹ˆç°åœ¨å‰ç«¯æ˜¯å¦ä¹Ÿå¯ä»¥å¦‚æ­¤å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆè‡ªç„¶æ˜¯è‚¯å®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾å·¥ä½œé¢è¯•çš„æ—¶å€™å¸¸è¢«é—®åŠå…³äºJSç»§æ‰¿çš„é—®é¢˜ï¼Œéšä¹‹ES6å‡ºç°äº†æœŸç›¼å·²ä¹…çš„Classï¼Œä¸€åˆ‡éƒ½åœ¨å¾€æ›´ä¸ºæˆç†Ÿçš„æ–¹å‘å‘å±•ã€‚æ¥ä¸‹æˆ‘ä»¬ä»¥<a href="https://vuejs.org/" target="_blank" rel="noopener">Vue</a>ä¸ºä¾‹ï¼Œçœ‹çœ‹æ€ä¹ˆå»åšç»§æ‰¿è¿™ä»¶äº‹æƒ…ã€‚</p><a id="more"></a><h3 id="éœ€æ±‚æè¿°"><a href="#éœ€æ±‚æè¿°" class="headerlink" title="éœ€æ±‚æè¿°"></a>éœ€æ±‚æè¿°</h3><p>ç®€å•å®ç°2ä¸ªåˆ—è¡¨é¡µé¢ï¼Œä¸€ä¸ªæ˜¯ç®¡ç†å‘˜åˆ—è¡¨ã€ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨</p><p><img src="/images/vue-component-extends/1.jpg" alt="å›¾ä¸€ ç®¡ç†å‘˜åˆ—è¡¨é¡µé¢ï¼Œç­›é€‰æœ‰ç”¨æˆ·åã€çŠ¶æ€ï¼Œåˆ—è¡¨æœ‰ç”¨æˆ·åã€æ‰‹æœºå·ç ã€çŠ¶æ€ã€&quot;ä¿®æ”¹&quot;æ“ä½œæŒ‰é’®"></p><p><img src="/images/vue-component-extends/2.jpg" alt="å›¾äºŒ ç”¨æˆ·é¡µåˆ—è¡¨é¢æœ‰ï¼Œç­›é€‰æœ‰ç”¨æˆ·åã€æ‰‹æœºå·ã€çŠ¶æ€ï¼Œåˆ—è¡¨æœ‰ç”¨æˆ·åã€æ‰‹æœºå·ç ã€åˆ›å»ºæ—¶é—´ã€çŠ¶æ€ã€&quot;åˆ é™¤&quot;æ“ä½œæŒ‰é’®"></p><p>ä»ä¸Šå¯ä»¥çœ‹å‡º2ä¸ªé¡µé¢æ•´ä½“é¡µé¢ç»“æ„ç›¸åŒï¼Œåœ¨å…·ä½“ç»†èŠ‚ä¸Šä¼šæœ‰äº›å°‘äºä¸åŒï¼Œç¬¬ä¸€ååº”å°±æ˜¯ä½¿ç”¨å‰æ–‡æåˆ°çš„ç»§æ‰¿ä¹‹ç±»çš„ä¸œè¥¿å»å®ç°å®ƒã€‚<br><img src="/images/vue-component-extends/3.jpg" alt="å›¾ä¸‰ ç®€å•çš„ç»§æ‰¿å›¾"></p><h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><ul><li><p>Vue ç‰ˆæœ¬ 2.5</p></li><li><p><a href="http://element.eleme.io/" target="_blank" rel="noopener">Element-UI</a> ï¼ˆä»…ä»…ä½¿å¾—Demoçœ‹ä¸Šå»ä¸é‚£ä¹ˆä¸‘ï¼‰</p></li><li><p><a href="https://github.com/miser/vue-compoent-extends-experiment" target="_blank" rel="noopener">æµ‹è¯•ä»£ç </a></p></li></ul><h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><p>é€šè¿‡vue cliå·¥å…·åˆ›å»ºé¡¹ç›®<br><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue create vue-component-extedns</span><br></pre></td></tr></table></figure></p><p>æ­¤åˆ»æˆ‘ä»¬å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªVueçš„é»˜è®¤å¼€å‘ç›®å½•ç»“æ„å’Œä»£ç ï¼Œæˆ‘å¼€å§‹å¯¹å…¶è¿›è¡Œä¿®æ”¹</p><p><strong>å¼•å…¥Element-UI</strong></p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// main.js </span></span><br><span class="line"><span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span></span><br><span class="line"><span class="hljs-keyword">import</span> ElementUI <span class="hljs-keyword">from</span> <span class="hljs-string">'element-ui'</span></span><br><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">'element-ui/lib/theme-chalk/index.css'</span></span><br><span class="line"><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="hljs-literal">false</span></span><br><span class="line">Vue.use(ElementUI)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">new</span> Vue(&#123;</span><br><span class="line">  render: <span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).$mount(<span class="hljs-string">'#app'</span>)</span><br></pre></td></tr></table></figure><p>åœ¨componentsç›®å½•ä¸‹åˆ†åˆ«åˆ›å»ºListPageAbstract.vueã€AdminPageAbstract.vueã€ButtonClick.vueå’ŒTitle.vue</p><p><em>ä¸‹é¢ä»£ç å¾ˆå¤šå¯ä»¥å…ˆè·³è¿‡ï¼Œçœ‹åç»­çš„ä»‹ç»</em></p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line">// ButtonClick.vue</span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span> <span class="hljs-attr">plain</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> @<span class="hljs-attr">click.stop</span>=<span class="hljs-string">"click"</span>&gt;</span></span><br><span class="line">    &#123;&#123; label &#125;&#125;</span><br><span class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">    props: [<span class="hljs-string">'click'</span>, <span class="hljs-string">'label'</span>, <span class="hljs-string">'opt'</span>],</span></span><br><span class="line"><span class="hljs-undefined">    mounted () &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ButtonClick mounted'</span>)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  &#125;</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// Title.vue</span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"title"</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">  props: [<span class="hljs-string">'title'</span>]</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// ListPageAbstract.vue</span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">Title</span> <span class="hljs-attr">:title</span>=<span class="hljs-string">"title"</span> /&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">el-form</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"config &amp;&amp; config.filter"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">'form'</span> <span class="hljs-attr">:inline</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">:model</span>=<span class="hljs-string">"filterForm"</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"config.filter.conditions.indexOf('name') &gt;= 0"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"åå­—"</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"name"</span>&gt;</span></span><br><span class="line">          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"filterForm.name"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-input</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"config.filter.conditions.indexOf('phone') &gt;= 0"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"æ‰‹æœº"</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"date"</span>&gt;</span></span><br><span class="line">          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"filterForm.date"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-input</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"config.filter.conditions.indexOf('date') &gt;= 0"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"æ—¶é—´"</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"date"</span>&gt;</span></span><br><span class="line">          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"filterForm.date"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-input</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"config.filter.conditions.indexOf('status') &gt;= 0"</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"çŠ¶æ€"</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">"status"</span>&gt;</span></span><br><span class="line">          <span class="hljs-tag">&lt;<span class="hljs-name">el-select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"filterForm.status"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·é€‰æ‹©"</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"option in statusOptions"</span> <span class="hljs-attr">:label</span>=<span class="hljs-string">"option.text"</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"option.value"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"option.value"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span></span><br><span class="line">          <span class="hljs-tag">&lt;/<span class="hljs-name">el-select</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="hljs-comment">&lt;!-- &lt;div&gt;</span></span><br><span class="line"><span class="hljs-comment">        &lt;slot name="filter-slot"&gt;&lt;/slot&gt;</span></span><br><span class="line"><span class="hljs-comment">        &lt;/div&gt; --&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span>&gt;</span></span><br><span class="line">          <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> @<span class="hljs-attr">click.stop</span>=<span class="hljs-string">"config.filter.action"</span>&gt;</span>æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;/<span class="hljs-name">el-form</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">el-table</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"config"</span> <span class="hljs-attr">:data</span>=<span class="hljs-string">"list"</span> &gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in config.table.column"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span></span></span><br><span class="line"><span class="hljs-tag">      <span class="hljs-attr">:prop</span>=<span class="hljs-string">"item.key"</span> <span class="hljs-attr">:label</span>=<span class="hljs-string">"item.label"</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"config.table.action"</span> <span class="hljs-attr">:label</span>=<span class="hljs-string">"config.table.action.headerLabel"</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot-scope</span>=<span class="hljs-string">"scope"</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">:click</span>=<span class="hljs-string">"config.table.action.click.bind(null, scope.row)"</span> <span class="hljs-attr">:label</span>=<span class="hljs-string">"config.table.action.label"</span> <span class="hljs-attr">:opt</span>=<span class="hljs-string">"config.table.action"</span> /&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">el-table</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">import</span> Button <span class="hljs-keyword">from</span> <span class="hljs-string">'./ButtonClick.vue'</span></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">import</span> Title <span class="hljs-keyword">from</span> <span class="hljs-string">'./Title.vue'</span></span></span><br><span class="line"><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="line"><span class="hljs-undefined">  components: &#123; Button, Title &#125;,</span></span><br><span class="line"><span class="hljs-javascript">  data: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="line"><span class="hljs-undefined">      filterForm: &#123; &#125;,</span></span><br><span class="line"><span class="hljs-undefined">      statusOptions: [],</span></span><br><span class="line"><span class="hljs-undefined">      list: [],</span></span><br><span class="line"><span class="hljs-javascript">      title: <span class="hljs-literal">null</span>,</span></span><br><span class="line"><span class="hljs-javascript">      config: <span class="hljs-literal">null</span></span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  &#125;,</span></span><br><span class="line"><span class="hljs-javascript">  mounted: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">this</span>.config = <span class="hljs-keyword">this</span>.createConfig()</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">this</span>.fetchOptions()</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">this</span>.fetchData()</span></span><br><span class="line"><span class="hljs-undefined">  &#125;,</span></span><br><span class="line"><span class="hljs-undefined">  methods: &#123;</span></span><br><span class="line"><span class="hljs-undefined">    createConfig () &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">let</span> config = &#123;&#125;</span></span><br><span class="line"><span class="hljs-undefined">      config.filter = &#123;</span></span><br><span class="line"><span class="hljs-javascript">        conditions: [ <span class="hljs-string">'name'</span>, <span class="hljs-string">'status'</span> ],</span></span><br><span class="line"><span class="hljs-javascript">        action: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">          <span class="hljs-keyword">this</span>.fetchData(<span class="hljs-keyword">this</span>.filterForm)</span></span><br><span class="line"><span class="hljs-undefined">        &#125;</span></span><br><span class="line"><span class="hljs-undefined">      &#125;</span></span><br><span class="line"><span class="hljs-undefined">      config.table = &#123;</span></span><br><span class="line"><span class="hljs-undefined">        column: [</span></span><br><span class="line"><span class="hljs-javascript">          &#123; <span class="hljs-attr">key</span>: <span class="hljs-string">'name'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'ç”¨æˆ·å'</span> &#125;,</span></span><br><span class="line"><span class="hljs-javascript">          &#123; <span class="hljs-attr">key</span>: <span class="hljs-string">'phone'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'æ‰‹æœºå·ç '</span> &#125;,</span></span><br><span class="line"><span class="hljs-javascript">          &#123; <span class="hljs-attr">key</span>: <span class="hljs-string">'status'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'çŠ¶æ€'</span> &#125;</span></span><br><span class="line"><span class="hljs-undefined">        ],</span></span><br><span class="line"><span class="hljs-undefined">        action: &#123;</span></span><br><span class="line"><span class="hljs-javascript">          headerLabel: <span class="hljs-string">'æ“ä½œ'</span>,</span></span><br><span class="line"><span class="hljs-javascript">          label: <span class="hljs-string">'ä¿®æ”¹'</span>,</span></span><br><span class="line"><span class="hljs-javascript">          click: <span class="hljs-keyword">this</span>.editRow</span></span><br><span class="line"><span class="hljs-undefined">        &#125;</span></span><br><span class="line"><span class="hljs-undefined">      &#125;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">return</span> config</span></span><br><span class="line"><span class="hljs-undefined">    &#125;,</span></span><br><span class="line"><span class="hljs-undefined">    fetchOptions () &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">this</span>.statusOptions = [</span></span><br><span class="line"><span class="hljs-javascript">        &#123; <span class="hljs-attr">value</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'status1'</span> &#125;,</span></span><br><span class="line"><span class="hljs-javascript">        &#123; <span class="hljs-attr">value</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'status2'</span> &#125;</span></span><br><span class="line"><span class="hljs-undefined">      ]</span></span><br><span class="line"><span class="hljs-undefined">    &#125;,</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">async</span> fetchData () &#123; &#125;,</span></span><br><span class="line"><span class="hljs-undefined">    editRow (item) &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`update data =&gt; <span class="hljs-subst">$&#123;item.name&#125;</span>`</span>)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  &#125;</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-undefined">.title &#123;</span></span><br><span class="line"><span class="hljs-undefined">  color: red;</span></span><br><span class="line"><span class="hljs-undefined">  margin-bottom: 20px;</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// AdminListPage.vue</span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">import</span> ListPageAbstract <span class="hljs-keyword">from</span> <span class="hljs-string">'./ListPageAbstract'</span></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿajaxè¯·æ±‚</span></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-comment">// ä»…åšäº†åå­—çš„æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå…¶ä»–å‚æ•°å¿½ç•¥</span></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">search</span> (<span class="hljs-params">opt</span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">let</span> list = [</span></span><br><span class="line"><span class="hljs-javascript">      &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'Admin Peter'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'313141414'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'status1'</span>, <span class="hljs-attr">date</span>: <span class="hljs-string">'2018-10-10'</span> &#125;,</span></span><br><span class="line"><span class="hljs-javascript">      &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'Admin Marry'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'123931873'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'status2'</span>, <span class="hljs-attr">date</span>: <span class="hljs-string">'2018-11-11'</span> &#125;,</span></span><br><span class="line"><span class="hljs-javascript">      &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'Admin Sue'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'342391873'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'status1'</span>, <span class="hljs-attr">date</span>: <span class="hljs-string">'2018-01-01'</span> &#125;,</span></span><br><span class="line"><span class="hljs-javascript">      &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'Admin Join'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'143391873'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'status1'</span>, <span class="hljs-attr">date</span>: <span class="hljs-string">'2018-12-12'</span> &#125;</span></span><br><span class="line"><span class="hljs-undefined">    ]</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">if</span> (opt.name) &#123;</span></span><br><span class="line"><span class="hljs-javascript">      list = list.filter(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.name.match(opt.name))</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-javascript">    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="hljs-undefined">      resolve(list)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;, 1000)</span></span><br><span class="line"><span class="hljs-undefined">  &#125;)</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="line"><span class="hljs-undefined">  extends: ListPageAbstract,</span></span><br><span class="line"><span class="hljs-undefined">  data () &#123;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">      title: <span class="hljs-string">'ç®¡ç†å‘˜åˆ—è¡¨'</span></span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  &#125;,</span></span><br><span class="line"><span class="hljs-undefined">  methods: &#123;</span></span><br><span class="line"><span class="hljs-undefined">    fetchOptions () &#123;</span></span><br><span class="line"><span class="hljs-javascript">      ListPageAbstract.methods.fetchOptions.call(<span class="hljs-keyword">this</span>)</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'to do other thing'</span>)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;,</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">async</span> fetchData () &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">let</span> list = <span class="hljs-keyword">await</span> search(<span class="hljs-keyword">this</span>.filterForm)</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">this</span>.list = list</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  &#125;</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ·æ–°é¡µé¢å°±èƒ½å‘ˆç°ä¸Šè¿°å›¾ä¸€å±•ç¤ºçš„æ ·å­å’ŒåŠŸèƒ½äº†ã€‚é‚£ä¹ˆæ´‹æ´‹æ´’æ´’è¿™ä¹ˆå¤šä»£ç åšäº†äº›ä»€ä¹ˆå‘¢ï¼Ÿ</p><ul><li>Title.vue ç”¨äºæ˜¾ç¤ºé¡µé¢çš„æ ‡é¢˜ï¼ˆä¹‹åæˆ‘ä»¬ç”¨å®ƒæµ‹è¯•ä¸‹ç»§æ‰¿äºListPageAbstract.vueçš„ç»„ä»¶å¦‚ä½•é‡å†™cssçš„é—®é¢˜ï¼‰</li><li>ButtonClick.vue å±•ç¤ºæ“ä½œæŒ‰é’®å’Œæ‰§è¡Œæ“ä½œäº‹ä»¶</li><li>ListPageAbstract.vue æŠ½è±¡çš„åˆ—è¡¨ç»„ä»¶ï¼Œè¿™é‡Œæ˜¯ä½œä¸ºä¾‹å­ï¼Œå…·ä½“æ–¹æ³•å®šä¹‰çš„ç²—ç»†ç¨‹åº¦æ ¹æ®å…·ä½“æƒ…å†µè°ƒèŠ‚</li><li>AdminListPage.vue ç®¡ç†å‘˜åˆ—è¡¨çš„å…·ä½“ç»„ä»¶</li></ul><p>AdminListPageé€šè¿‡<a href="https://cn.vuejs.org/v2/api/#extends" target="_blank" rel="noopener">extends</a>ç»§æ‰¿äº†ListPageAbstractçš„æ¨¡æ¿ã€æ ·å¼å’Œå…¶JSä»£ç ï¼Œé€šè¿‡éƒ¨åˆ†çš„é‡å†™æˆ–å®Œå–„ï¼Œå¾ˆå®¹æ˜“çš„å®ç°äº†ä¸€ä¸ªé¡µé¢ï¼Œçœ‹ä¸Šå»å¾ˆç¾å¥½ã€‚é‚£ä¹ˆæ–°çš„é—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬ä¹Ÿå‘ç°ListPageAbstractå®šä¹‰ç­›é€‰çš„å†…å®¹æ˜¯æœ‰é™çš„ï¼Œç›®å‰ä»…ä»…æœ‰nameã€phoneã€dateå’Œstatusï¼Œå¦‚æœæƒ³æ‰©å±•è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç”¨è¿‡Vueçš„æœ‹å‹æˆ–è®¸æ­¤åˆ»ä¼šæƒ³åˆ°<a href="https://cn.vuejs.org/v2/api/#slot" target="_blank" rel="noopener">Slot</a>ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ³¨é‡Šæ‰ListPageAbstract.vueé‡Œå…³äº<strong>filter-slot</strong>çš„æ³¨é‡Šï¼Œå¹¶ä¸ºAdminListPage.vueæ·»åŠ ç›¸å…³slotä»£ç ã€‚</p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// AdminListPage.vue add template </span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">"filter-slot"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">"filter-slot"</span>&gt;</span></span><br><span class="line">    other input filter</span><br><span class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br></pre></td></tr></table></figure><p>åˆ·æ–°é¡µé¢ï¼Œé¡µé¢ä»…ä»…ç•™ä¸‹äº†â€œother input filterâ€ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œå¹¶æ²¡æœ‰å®ç°æˆ‘ä»¬çš„éœ€æ±‚ï¼›ä¹Ÿæœ‰äººæå‡ºå…¶å®ƒä¿®æ”¹æ„è§</p><p><img src="/images/vue-component-extends/4.jpg" alt="å›¾å›› é™¤äº†â€œother input filterâ€å…¶å®ƒéƒ½æ²¡äº†"></p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// AdminListPage.vue </span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">"filter-slot"</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">Page</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">"filter-slot"</span>&gt;</span></span><br><span class="line">      other input filter</span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">Page</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="line">export default &#123;</span><br><span class="line">  extends: ListPageAbstract,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Page: ListPageAbstract,</span><br><span class="line">  &#125;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶é¡µé¢UIå±‚æ˜¯é¢„æœŸæ˜¾ç¤ºäº†ï¼Œä½†æ˜¯å¦‚æœå¯¹ListPageAbstractçš„mountedæ–¹æ³•æ‰“æ–­ç‚¹ä¼šå‘ç°ï¼Œå®ƒè¢«æ‰§è¡Œäº†2æ¬¡ï¼Œå› ä¸ºè¢«å®ä¾‹åŒ–äº†2æ¬¡ï¼Œå¹¶ä¸”é¡µé¢ä¸Šçš„å…ƒç´ äº‹ä»¶ä½¿ç”¨çš„æ˜¯ListPageAbstracté‡Œçš„ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬åœ¨Adminé‡Œé¢é‡å†™çš„ï¼Œæ˜¾ç„¶æ–¹æ³•å¹¶ä¸å¯è¡Œã€‚å…³äºVueæ¨¡æ¿çº§åˆ«çš„ç»§æ‰¿æ‰©å±•é—®é¢˜åœ¨githubä¸Šæœ‰å¾ˆå¤šçš„åæ§½ï¼Œä½†å¹¶æ²¡æœ‰åˆ—ä¸ºæœªæ¥çš„æ–°feature <a href="https://github.com/vuejs/vue/issues/6811" target="_blank" rel="noopener">#6811</a></p><p>æ—¢ç„¶æˆ‘ä»¬è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œè‡ªç„¶ä¹Ÿæ˜¯å¯ä»¥è§£å†³çš„ï¼Œåœ¨è¿™æˆ‘ä»¬ä¸ä»¥filteræŸ¥è¯¢æ¡ä»¶çš„å¤šå°‘ä¸ºä¾‹å­ï¼Œæˆ‘ä»¬ä»¥æ›´ä¸ºç®€å•çš„æŒ‰é’®ä¸ºä¾‹ï¼Œåœ¨åˆ—è¡¨é‡Œæ¯ä¸€è¡Œçš„æœ€åæœ‰ä¸€ä¸ªâ€œä¿®æ”¹â€æŒ‰é’®ï¼Œè€Œç„¶æˆ‘ä»¬åœ¨UserListPageé‡Œé¢ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå˜æˆä¸€ä¸ªâ€œåˆ é™¤â€æŒ‰é’®ï¼Œå¹¶å¼¹å‡ºç¡®å®åˆ é™¤çš„æç¤ºã€‚æ–°å¢ButtonPop.vueå’ŒUserListPage.vue</p><p><em>åˆæ˜¯å¾ˆå¤šä»£ç ï¼Œæ²¡å…´è¶£å¯è·³è¿‡</em></p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">// ButtonPop.vue</span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span> <span class="hljs-attr">plain</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span></span></span><br><span class="line"><span class="hljs-tag">      @<span class="hljs-attr">click.stop</span>=<span class="hljs-string">"dialogVisible = true"</span>&gt;</span>&#123;&#123; label &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">el-dialog</span></span></span><br><span class="line"><span class="hljs-tag">      <span class="hljs-attr">title</span>=<span class="hljs-string">"æç¤º"</span></span></span><br><span class="line"><span class="hljs-tag">      <span class="hljs-attr">:visible.sync</span>=<span class="hljs-string">"dialogVisible"</span></span></span><br><span class="line"><span class="hljs-tag">      <span class="hljs-attr">width</span>=<span class="hljs-string">"30%"</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>ç¡®è®¤åˆ é™¤æ•°æ®å—ï¼Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">"footer"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-footer"</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"dialogVisible = false"</span>&gt;</span>å– æ¶ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"deleteInfo"</span>&gt;</span>ç¡® å®š<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">el-dialog</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">  props: [<span class="hljs-string">'click'</span>, <span class="hljs-string">'label'</span>, <span class="hljs-string">'opt'</span>],</span></span><br><span class="line"><span class="hljs-undefined">  data () &#123;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">      dialogVisible: <span class="hljs-literal">false</span></span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  &#125;,</span></span><br><span class="line"><span class="hljs-undefined">  mounted () &#123;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ButtonPop mounted'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  &#125;,</span></span><br><span class="line"><span class="hljs-undefined">  methods: &#123;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">async</span> deleteInfo () &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.click()</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">this</span>.dialogVisible = <span class="hljs-literal">false</span></span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  &#125;</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// UserListPage.vue</span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">import</span> ListPageAbstract <span class="hljs-keyword">from</span> <span class="hljs-string">'./ListPageAbstract.vue'</span></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">import</span> Button <span class="hljs-keyword">from</span> <span class="hljs-string">'./ButtonPop.vue'</span></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿajaxè¯·æ±‚</span></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-comment">// ä»…åšäº†åå­—çš„æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå…¶ä»–å‚æ•°å¿½ç•¥</span></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">search</span> (<span class="hljs-params">opt</span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">let</span> list = [</span></span><br><span class="line"><span class="hljs-javascript">      &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'User Peter'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'313141414'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'status1'</span>, <span class="hljs-attr">date</span>: <span class="hljs-string">'2018-10-10'</span> &#125;,</span></span><br><span class="line"><span class="hljs-javascript">      &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'User Marry'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'123931873'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'status2'</span>, <span class="hljs-attr">date</span>: <span class="hljs-string">'2018-11-11'</span> &#125;,</span></span><br><span class="line"><span class="hljs-javascript">      &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'User Sue'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'342391873'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'status1'</span>, <span class="hljs-attr">date</span>: <span class="hljs-string">'2018-01-01'</span> &#125;,</span></span><br><span class="line"><span class="hljs-javascript">      &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">'User Join'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'143391873'</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'status1'</span>, <span class="hljs-attr">date</span>: <span class="hljs-string">'2018-12-12'</span> &#125;</span></span><br><span class="line"><span class="hljs-undefined">    ]</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">if</span> (opt.name) &#123;</span></span><br><span class="line"><span class="hljs-javascript">      list = list.filter(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.name.match(opt.name))</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-javascript">    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="hljs-undefined">      resolve(list)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;, 1000)</span></span><br><span class="line"><span class="hljs-undefined">  &#125;)</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="line"><span class="hljs-undefined">  extends: ListPageAbstract,</span></span><br><span class="line"><span class="hljs-undefined">  components: &#123; Button &#125;,</span></span><br><span class="line"><span class="hljs-javascript">  data: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123; <span class="hljs-keyword">return</span> &#123;&#125; &#125;,</span></span><br><span class="line"><span class="hljs-javascript">  mounted: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">this</span>.title = <span class="hljs-string">'ç”¨æˆ·åˆ—è¡¨'</span></span></span><br><span class="line"><span class="hljs-undefined">  &#125;,</span></span><br><span class="line"><span class="hljs-undefined">  methods: &#123;</span></span><br><span class="line"><span class="hljs-undefined">    createConfig () &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-comment">// ç”¨æˆ·åã€åˆ›å»ºæ—¶é—´ã€æ‰‹æœºå·ã€çŠ¶æ€</span></span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">let</span> config = ListPageAbstract.methods.createConfig.call(<span class="hljs-keyword">this</span>)</span></span><br><span class="line"><span class="hljs-javascript">      config.filter.conditions.splice(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-string">'phone'</span>)</span></span><br><span class="line"><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">let</span> table = config.table</span></span><br><span class="line"><span class="hljs-javascript">      table.column.push(&#123; <span class="hljs-attr">key</span>: <span class="hljs-string">'date'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'æ—¶é—´'</span> &#125;)</span></span><br><span class="line"><span class="hljs-undefined">      table.action = &#123;</span></span><br><span class="line"><span class="hljs-javascript">        headerLabel: <span class="hljs-string">'æ“ä½œ'</span>,</span></span><br><span class="line"><span class="hljs-javascript">        label: <span class="hljs-string">'åˆ é™¤'</span>,</span></span><br><span class="line"><span class="hljs-javascript">        click: <span class="hljs-keyword">this</span>.deleteRow</span></span><br><span class="line"><span class="hljs-undefined">      &#125;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">return</span> config</span></span><br><span class="line"><span class="hljs-undefined">    &#125;,</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">async</span> fetchData () &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">let</span> list = <span class="hljs-keyword">await</span> search(<span class="hljs-keyword">this</span>.filterForm)</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">this</span>.list = list</span></span><br><span class="line"><span class="hljs-undefined">    &#125;,</span></span><br><span class="line"><span class="hljs-undefined">    deleteRow (item) &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`delete date: <span class="hljs-subst">$&#123;item.name&#125;</span>`</span>)</span></span><br><span class="line"><span class="hljs-javascript">        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="hljs-javascript">          <span class="hljs-keyword">this</span>.list.splice(<span class="hljs-keyword">this</span>.list.indexOf(item), <span class="hljs-number">1</span>)</span></span><br><span class="line"><span class="hljs-undefined">          resolve()</span></span><br><span class="line"><span class="hljs-undefined">        &#125;, 1000)</span></span><br><span class="line"><span class="hljs-undefined">      &#125;)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  &#125;</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-undefined">.title &#123;</span></span><br><span class="line"><span class="hljs-undefined">  margin-bottom: 50px;</span></span><br><span class="line"><span class="hljs-undefined">  color: blue;</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ä¿®æ”¹ä¸‹App.vueé‡Œé¢çš„Pageå¼•ç”¨ï¼Œä»AdminListPageæ”¹ä¸ºUserListPage</p><p>åˆ·æ–°é¡µé¢ï¼Œå°±å’Œå›¾äºŒçš„æ ·å­ä¸€æ ·äº†ã€‚æ•´ä¸ªä»£ç å¹¶ä¸å¤æ‚ï¼Œæ ¸å¿ƒå°±æ˜¯</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">components: &#123; Button &#125;</span><br></pre></td></tr></table></figure><p>å®ƒå°†çˆ¶ç±»çš„Buttonï¼ˆButtonClickï¼‰æ›¿æ¢æˆäº†Useré¡µé¢éœ€è¦çš„ButtonPopï¼Œå®ç°äº†æ‰©å±•ã€‚å…¶å®FilteræŸ¥è¯¢æ¡ä»¶ä¹Ÿå¯ä»¥ï¼Œåªè¦æˆ‘ä»¬åšå¥½ç»„ä»¶çš„æŠ½å–ç­‰å°±è¡Œã€‚</p><p><strong>é˜…è¯»Vueçš„æºç æ—¶å€™ï¼Œåœ¨Vueç»„ä»¶å®ä¾‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰å¾ˆå¤šå¯¹optionsçš„æ·±å±‚æ¬¡mergeï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šè¯‰æ–¹æ³•å®ç°å¯¹çˆ¶ç»„ä»¶çš„æ‰©å±•ã€‚</strong></p><p>å¦å¤–ï¼Œç»†å¿ƒçš„æœ‹å‹è§‚å¯Ÿä»£ç æˆ–é¡µé¢ä¹Ÿå‘ç°â€œç”¨æˆ·åˆ—è¡¨â€4ä¸ªå­—çš„é¢œè‰²ä»çº¢è‰²å˜æˆäº†è“è‰²ï¼Œä¸ä¸‹é¢åˆ—è¡¨çš„é—´è·ä¹Ÿå¢å¤§äº†ä¸å°‘ï¼Œåœ¨Useré¡µé¢çš„styleæ ‡ç­¾é‡Œå°±èƒ½å¾ˆå®¹æ˜“ä¿®æ”¹çˆ¶ç»„ä»¶çš„cssæ ·å¼ã€‚</p><p>åœ¨Vueä¸­ï¼Œmixinã€slotéƒ½æ˜¯éå¸¸å¥½ç”¨çš„å·¥å…·ï¼Œæˆ–è®¸æˆ‘ä»¬æœ‰æ—¶å€™ä¹Ÿèƒ½æ”¹å˜æ€è·¯ï¼Œé€šè¿‡ç»„ä»¶çš„æ›¿æ¢æ„å»ºå‡ºä¸€ä¸ªæ›´ä¸ºå®¹æ˜“æ‰©å±•çš„æ¡†æ¶ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨åšWebå‰ç«¯å¼€å‘çš„æ—¶å€™ä¼šæœ‰å¤§é‡çš„é¡µé¢å¤ç”¨çš„åœ°æ–¹ï¼Œä»UIå¸ƒå±€åˆ°JSçš„é€»è¾‘ã€‚æ—©å¹´åšåç«¯å¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥é€šè¿‡é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ³•å¼ï¼Œä½¿ç”¨æŠ½è±¡ç±»ã€æ¥å£ç­‰ç­‰ï¼Œé‚£ä¹ˆç°åœ¨å‰ç«¯æ˜¯å¦ä¹Ÿå¯ä»¥å¦‚æ­¤å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆè‡ªç„¶æ˜¯è‚¯å®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾å·¥ä½œé¢è¯•çš„æ—¶å€™å¸¸è¢«é—®åŠå…³äºJSç»§æ‰¿çš„é—®é¢˜ï¼Œéšä¹‹ES6å‡ºç°äº†æœŸç›¼å·²ä¹…çš„Classï¼Œä¸€åˆ‡éƒ½åœ¨å¾€æ›´ä¸ºæˆç†Ÿçš„æ–¹å‘å‘å±•ã€‚æ¥ä¸‹æˆ‘ä»¬ä»¥&lt;a href=&quot;https://vuejs.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Vue&lt;/a&gt;ä¸ºä¾‹ï¼Œçœ‹çœ‹æ€ä¹ˆå»åšç»§æ‰¿è¿™ä»¶äº‹æƒ…ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="https://miser.github.io/categories/javascript/"/>
    
    
  </entry>
  
  <entry>
    <title>å‰ç«¯é”™è¯¯æ•è·æäº¤é”™è¯¯æ—¥å¿—</title>
    <link href="https://miser.github.io/2018/10/23/js-capture-error/"/>
    <id>https://miser.github.io/2018/10/23/js-capture-error/</id>
    <published>2018-10-23T10:29:29.089Z</published>
    <updated>2019-01-18T13:49:31.622Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä¸ºä»€ä¹ˆéœ€è¦æ•è·ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦æ•è·ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦æ•è·ï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦æ•è·ï¼Ÿ</h4><p>å‰ç«¯ä»£ç è¿è¡Œåœ¨å®¢æˆ·ç«¯çš„æµè§ˆå™¨é‡Œï¼Œå½“å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‡ºç°ä»»ä½•é—®é¢˜ï¼Œåœ¨æ²¡æœ‰é”™è¯¯æ—¥å¿—çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä¸çŸ¥é“é—®é¢˜å‘ç”Ÿåœ¨å“ªï¼Œæˆ‘ä»¬åªèƒ½ä¾é çŒœæµ‹æˆ–è€…è‡ªå·±ä¸æ–­å°è¯•æ‰çŸ¥é“ï¼Œæˆ–è€…æ°¸è¿œä¸çŸ¥é“é—®é¢˜ã€‚</p><h4 id="å®¢æˆ·ç«¯æ€ä¹ˆæ•è·ï¼Ÿ"><a href="#å®¢æˆ·ç«¯æ€ä¹ˆæ•è·ï¼Ÿ" class="headerlink" title="å®¢æˆ·ç«¯æ€ä¹ˆæ•è·ï¼Ÿ"></a>å®¢æˆ·ç«¯æ€ä¹ˆæ•è·ï¼Ÿ</h4><p>1.é€šè¿‡window.onerrorï¼Œå¯æƒœåªèƒ½è·å¾—åŸºç¡€çš„jsé”™è¯¯ï¼ŒPromiseã€async/await é‡Œçš„é”™è¯¯æ— æ³•æ•è·ï¼Œå®ƒæ”¶åˆ°åŒæºå†³ç­–çš„å½±å“</p><p>2.Promise é€šè¿‡<strong>catch</strong>æ–¹æ³•</p><p>3.async/await é€šè¿‡ <strong>try - catch</strong></p><p>4.Vueå¯ä»¥é€šè¿‡å…¨å±€Vue.config.errorHandlerå»è·å¾—éPromiseã€async/awaité‡Œçš„é”™è¯¯ï¼Œå¯ä»¥ç†è§£ä¸ºVueé‡Œçš„window.onerror</p><a id="more"></a><h4 id="ä¸åŒçš„æ•è·é”™è¯¯ç”¨æ³•ï¼ˆæµ‹è¯•ç¯å¢ƒ-chrome-amp-https-jsbin-comï¼‰"><a href="#ä¸åŒçš„æ•è·é”™è¯¯ç”¨æ³•ï¼ˆæµ‹è¯•ç¯å¢ƒ-chrome-amp-https-jsbin-comï¼‰" class="headerlink" title="ä¸åŒçš„æ•è·é”™è¯¯ç”¨æ³•ï¼ˆæµ‹è¯•ç¯å¢ƒ chrome &amp; https://jsbin.comï¼‰"></a>ä¸åŒçš„æ•è·é”™è¯¯ç”¨æ³•ï¼ˆæµ‹è¯•ç¯å¢ƒ chrome &amp; <a href="https://jsbin.comï¼‰" target="_blank" rel="noopener">https://jsbin.comï¼‰</a></h4><h5 id="window-onerror"><a href="#window-onerror" class="headerlink" title="window.onerror"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/onerror" target="_blank" rel="noopener">window.onerror</a></h5><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">window</span>.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message, source, lineno, colno, error</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-comment">/*</span></span><br><span class="line"><span class="hljs-comment">    messageï¼šé”™è¯¯ä¿¡æ¯ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€‚å¯ç”¨äºHTML onerror=""å¤„ç†ç¨‹åºä¸­çš„eventã€‚</span></span><br><span class="line"><span class="hljs-comment">    sourceï¼šå‘ç”Ÿé”™è¯¯çš„è„šæœ¬URLï¼ˆå­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line"><span class="hljs-comment">    linenoï¼šå‘ç”Ÿé”™è¯¯çš„è¡Œå·ï¼ˆæ•°å­—ï¼‰</span></span><br><span class="line"><span class="hljs-comment">    colnoï¼šå‘ç”Ÿé”™è¯¯çš„åˆ—å·ï¼ˆæ•°å­—ï¼‰</span></span><br><span class="line"><span class="hljs-comment">    errorï¼šErrorå¯¹è±¡ï¼ˆå¯¹è±¡ï¼‰</span></span><br><span class="line"><span class="hljs-comment">    */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">window</span>.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">let</span> data</span><br><span class="line"><span class="hljs-keyword">let</span> info = data.info</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">[object Arguments] &#123;</span></span><br><span class="line"><span class="hljs-comment">  0: "Uncaught TypeError: Cannot read property 'info' of undefined",</span></span><br><span class="line"><span class="hljs-comment">  1: "yiveral.js",</span></span><br><span class="line"><span class="hljs-comment">  2: 6,</span></span><br><span class="line"><span class="hljs-comment">  3: 17,</span></span><br><span class="line"><span class="hljs-comment">  4: [object Error] &#123; ... &#125;</span></span><br><span class="line"><span class="hljs-comment">&#125;</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure><p>è™½ç„¶<strong>onerror</strong>æ— æ³•æ•è·Promiseé‡Œçš„é”™è¯¯ï¼Œä½†æ˜¯å¦‚æœPromiseé‡Œé¢æ˜¯è¢«setTimeoutåŒ…è£¹çš„jsè¿˜æ˜¯èƒ½æ•è·çš„</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">window</span>.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timer</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">     <span class="hljs-keyword">let</span> data</span><br><span class="line">     <span class="hljs-keyword">let</span> info = data.info</span><br><span class="line">  &#125;, <span class="hljs-number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;</span><br><span class="line">     timer()</span><br><span class="line">  &#125;).catch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(error)</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'inner error'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">p().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'running then'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>)</span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(error)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'outer error'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">[object Arguments] &#123;</span></span><br><span class="line"><span class="hljs-comment">  0: "Uncaught TypeError: Cannot read property 'info' of undefined",</span></span><br><span class="line"><span class="hljs-comment">  1: "yiveral.js",</span></span><br><span class="line"><span class="hljs-comment">  2: 8,</span></span><br><span class="line"><span class="hljs-comment">  3: 22,</span></span><br><span class="line"><span class="hljs-comment">  4: [object Error] &#123; ... &#125;</span></span><br><span class="line"><span class="hljs-comment">&#125;</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure><h5 id="Promise-catch"><a href="#Promise-catch" class="headerlink" title="Promise catch"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/catch" target="_blank" rel="noopener">Promise catch</a></h5><h5 id="Qï¼šå¦‚æœæ²¡æœ‰catchæ–¹æ³•ï¼Œæ˜¯å¦èƒ½æ•è·Promiseé‡Œçš„é”™è¯¯ï¼Ÿ"><a href="#Qï¼šå¦‚æœæ²¡æœ‰catchæ–¹æ³•ï¼Œæ˜¯å¦èƒ½æ•è·Promiseé‡Œçš„é”™è¯¯ï¼Ÿ" class="headerlink" title="Qï¼šå¦‚æœæ²¡æœ‰catchæ–¹æ³•ï¼Œæ˜¯å¦èƒ½æ•è·Promiseé‡Œçš„é”™è¯¯ï¼Ÿ"></a>Qï¼šå¦‚æœæ²¡æœ‰catchæ–¹æ³•ï¼Œæ˜¯å¦èƒ½æ•è·Promiseé‡Œçš„é”™è¯¯ï¼Ÿ</h5><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">window</span>.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'onerror'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorFn</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> data</span><br><span class="line">  <span class="hljs-keyword">let</span> info = data.info</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    errorFn()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">try</span> &#123;</span><br><span class="line">  p().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'running then'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125; <span class="hljs-keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(e)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'try - catch'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* console æ²¡æœ‰ä»»ä½•è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„ä»£ç å‘ç°ï¼ŒPromiseé‡Œçš„é”™è¯¯æ— è®ºåœ¨<strong>try - catch</strong>è¿˜æ˜¯<strong>onerror</strong>é‡Œéƒ½æ— æ³•è¢«æ•è·</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorFn</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> data</span><br><span class="line">  <span class="hljs-keyword">let</span> info = data.info</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    errorFn()</span><br><span class="line">  &#125;).catch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(error)</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'inner error'</span>)</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">'return inner error'</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-keyword">try</span> &#123;</span><br><span class="line">  p().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(res)</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'running then'</span>)</span><br><span class="line">  &#125;).catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>)</span>&#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(error)</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'outer error'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125; <span class="hljs-keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(e)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'try - catch'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">[object Error] &#123; ... &#125;</span></span><br><span class="line"><span class="hljs-comment">"inner error"</span></span><br><span class="line"><span class="hljs-comment">"return inner error"</span></span><br><span class="line"><span class="hljs-comment">"running then"</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢ä»£ç å‘ç°ï¼Œå·²ç»è¢«æ•è·çš„é”™è¯¯ä»£ç ï¼Œåœ¨å¤–å±‚ä¸ä¼šå†è¢«æ•è·è€Œæ˜¯ç»§ç»­æ‰§è¡Œthené‡Œçš„æ–¹æ³•ï¼Œå¯è§åœ¨ä¸€æ¡Promiseé“¾ä¸Šçš„é”™è¯¯ï¼Œä¼šè¢«ä¹‹åæœ€è¿‘çš„<strong>catch</strong>æ•è·ã€‚</p><h5 id="async-await-é€šè¿‡-try-catch"><a href="#async-await-é€šè¿‡-try-catch" class="headerlink" title="async/await é€šè¿‡ try - catch"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank" rel="noopener">async/await</a> é€šè¿‡ <strong>try - catch</strong></h5><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">window</span>.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorFn</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> data</span><br><span class="line">  <span class="hljs-keyword">let</span> info = data.info</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    errorFn()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> p()</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(res)</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* console æ²¡æœ‰ä»»ä½•è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„ä»£ç å‘ç°ï¼ŒPromiseæ„é€ å‡½æ•°é‡Œçš„é”™è¯¯å¹¶æ²¡æœ‰è¢«<strong>onerror</strong>æ•è·</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">window</span>.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorFn</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> data</span><br><span class="line">  <span class="hljs-keyword">let</span> info = data.info</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="hljs-string">'resolve'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> p()</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'get res'</span>)</span><br><span class="line">  errorFn()</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">get res</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure><p>è™½ç„¶Promiseæ­£å¸¸æ‰§è¡Œï¼Œä½†æ˜¯å½“åç»­çš„ä»£ç å‡ºé”™<strong>onerror</strong>ä¾æ—§æ²¡æœ‰è¢«æ•è·</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorFn</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> data</span><br><span class="line">  <span class="hljs-keyword">let</span> info = data.info</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    errorFn()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> p()</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(res)</span><br><span class="line">  &#125; <span class="hljs-keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(e)</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'try - catch'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">[object Error] &#123; ... &#125;</span></span><br><span class="line"><span class="hljs-comment">"try - catch"</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure><p><strong>try - catch</strong>æ•è·äº†</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorFn</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> data</span><br><span class="line">  <span class="hljs-keyword">let</span> info = data.info</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">p</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    errorFn()</span><br><span class="line">  &#125;).catch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>&#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(error)</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'inner error'</span>)</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-string">'return inner error'</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">  <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> p()</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(res)</span><br><span class="line">  &#125; <span class="hljs-keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(e)</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'try - catch'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">[object Error] &#123; ... &#125;</span></span><br><span class="line"><span class="hljs-comment">"inner error"</span></span><br><span class="line"><span class="hljs-comment">"return inner error"</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœPromiseæ„é€ å‡½æ•°é‡Œçš„é”™è¯¯è¢«å®ƒè‡ªå·±catchçš„è¯ï¼Œé‚£ä¹ˆ async/await åç»­çš„ <strong>try - catch</strong>å°†ä¸å†å¯¹å®ƒæ•è·</p><h5 id="Vue-config-errorHandler"><a href="#Vue-config-errorHandler" class="headerlink" title="Vue.config.errorHandler"></a><a href="https://cn.vuejs.org/v2/api/index.html#errorHandler" target="_blank" rel="noopener">Vue.config.errorHandler</a></h5><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Vue.config.errorHandler = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, vm, info</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-comment">// handle error</span></span><br><span class="line">  <span class="hljs-comment">// `info` æ˜¯ Vue ç‰¹å®šçš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚é”™è¯¯æ‰€åœ¨çš„ç”Ÿå‘½å‘¨æœŸé’©å­</span></span><br><span class="line">  <span class="hljs-comment">// åªåœ¨ 2.2.0+ å¯ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æŒ‡å®šç»„ä»¶çš„æ¸²æŸ“å’Œè§‚å¯ŸæœŸé—´æœªæ•è·é”™è¯¯çš„å¤„ç†å‡½æ•°ã€‚è¿™ä¸ªå¤„ç†å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå¯è·å–é”™è¯¯ä¿¡æ¯å’Œ Vue å®ä¾‹ã€‚</p></blockquote><p>æˆ‘ä»¬è¯¥å¦‚ä½•å»ç†è§£å®˜æ–¹å¯¹errorHandlerçš„è§£é‡Šå‘¢ï¼Ÿé€šè¿‡ vue-cliæ„å»ºå·¥å…·ï¼Œåˆ›å»ºä¸€ä¸ªéå¸¸åŸºç¡€çš„vueé¡¹ç›®ï¼Œåšä¸€äº›å®éªŒã€‚</p><p>æµ‹è¯•ä»£ç åº“ï¼š<a href="https://github.com/miser/vue-capture-error" target="_blank" rel="noopener">https://github.com/miser/vue-capture-error</a></p><p>åœ¨main.js</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vue.config.errorHandler = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, vm, info</span>) </span>&#123;</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>)</span><br><span class="line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'vue errorHandler'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨App.vue</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.normal()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    normal () &#123;</span><br><span class="line">      <span class="hljs-keyword">let</span> data</span><br><span class="line">      <span class="hljs-keyword">let</span> info = data.info</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-comment">// ...  </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">/* åˆ·æ–°é¡µé¢ console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">0: TypeError: Cannot read property 'info' of undefined at VueComponent.normal â€¦</span></span><br><span class="line"><span class="hljs-comment">1: VueComponent &#123;_uid: 1, _isVue: true, $options: &#123;â€¦&#125;, _renderProxy: Proxy, _self: VueComponent, â€¦&#125;</span></span><br><span class="line"><span class="hljs-comment">2: "created hook</span></span><br><span class="line"><span class="hljs-comment">*/</span></span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼ŒerrorHandlerç¡®å®å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œåœ¨ä¸€ä¸ªç»Ÿä¸€çš„åœ°æ–¹æ•è·ä»£ç çš„é”™è¯¯ï¼Œä½†æ˜¯çœŸçš„å¦‚æ­¤å—ï¼Ÿä¸Šæ–‡ä¹Ÿæåˆ°errorHandlerå’Œwindow.onerrorç±»ä¼¼ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ä½¿ç”¨Promseæˆ–è€…async/awaitæ—¶ä¼šä¸ä¼šå¾—æ„¿ä»¥å¿ã€‚</p><p>jsä¸­çš„å¼‚æ­¥å¾ˆå¤§ä¸€éƒ¨åˆ†æ¥è‡ªç½‘ç»œè¯·æ±‚ï¼Œé‚£ä¹ˆåœ¨è¿™æˆ‘ä»¬ç”¨ <a href="https://github.com/axios/axios" target="_blank" rel="noopener">axios</a> ï¼ˆå®ƒåšäº†ä¸€å±‚ajaxä¸Promiseä¹‹é—´çš„å°è£…ï¼‰ã€‚</p><p>main.jsé‡Œæ·»åŠ </p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> request = axios.create()</span><br><span class="line">request.interceptors.response.use(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> response</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Vue.request = <span class="hljs-function">(<span class="hljs-params">args</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    request(args).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;</span><br><span class="line">      resolve(res)</span><br><span class="line">    &#125;).catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span><br><span class="line">      reject(err)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨App.vue</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.fetch1()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    fetch1 () &#123;</span><br><span class="line">        Vue.request(<span class="hljs-string">'https://api1.github.com/'</span>)</span><br><span class="line">      .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="hljs-built_in">console</span>.log(response)</span><br><span class="line">          &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-comment">// ...  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>api.github.com ä¼šè¿”å› githubçš„apiåˆ—è¡¨ï¼Œå½“æˆ‘ä»¬æ‹¼é”™åŸŸåï¼Œæ¯”å¦‚ä¸Šé¢ä»£ç ä¸­çš„api1.github.comæ—¶ï¼Œé‚£è‚¯å®šæ˜¯æ— æ³•è·å¾—æˆ‘ä»¬æƒ³è¦çš„ï¼Œå¯æ˜¯errorHandlerå¹¶æ²¡æœ‰è·å¾—è¯¥é”™è¯¯ï¼Œä¸è¿‡å¹¸å¥½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¨å±€ç»Ÿä¸€çš„Vue.requesté‡Œçš„catchæ–¹æ³•å»ç»Ÿä¸€æ•è·ç½‘ç»œå±‚é¢çš„é”™è¯¯ã€‚é‚£å¦‚æœæ˜¯éç½‘ç»œå±‚é¢çš„å‘¢ï¼Ÿæ¯”å¦‚æ•°æ®è¯·æ±‚å›æ¥äº†ï¼Œä½†æ˜¯ç»‘å®šæ•°æ®çš„æ—¶å€™ï¼Œåç«¯å› ä¸ºä¸šåŠ¡çš„ä¿®æ”¹ç­‰åŸå› å¹¶æ²¡æœ‰è¿”å›æˆ‘ä»¬éœ€è¦çš„å­—æ®µï¼Œé€ æˆPromise.thenæ–¹æ³•çš„ä¸šåŠ¡å¤„ç†é”™è¯¯ã€‚</p><p>åœ¨App.vue</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.fetch2()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    fetch2 () &#123;</span><br><span class="line">      Vue.request(<span class="hljs-string">'https://api.github.com/'</span>)</span><br><span class="line">      .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="hljs-keyword">let</span> data = response.data</span><br><span class="line">        <span class="hljs-keyword">let</span> info = data.api.info</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-comment">// ...  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¯‰ä»£ç è¿è¡Œåï¼ŒerrorHandleråŒæ ·æœªèƒ½æ•è·é”™è¯¯ï¼Œä»vueçš„issueé‡Œé¢å»æŸ¥è¯¢å…³äºæ•è·Promiseæˆ–è€…async/awaitæ—¶ï¼Œä¼šå¾—åˆ°ä½œè€…çš„ç­”å¤:</p><blockquote><p><a href="https://github.com/vuejs/vue/issues/6551" target="_blank" rel="noopener">https://github.com/vuejs/vue/issues/6551</a></p><p>Vue cannot capture errors that are thrown asynchronously, similar to how tryâ€¦ catch wonâ€™t catch async errors. Itâ€™s your responsibility to handle async errors properly, e.g. using Promise.catch  â€” @yyx990803</p></blockquote><p>é‚£ä¹ˆè¯¥æ€ä¹ˆåŠï¼Œä¸å¯èƒ½æ¯ä¸ªåœ°æ–¹éƒ½åŠ Promise.catchæ–¹æ³•å§ï¼</p><blockquote><p><a href="https://github.com/vuejs/vue/issues/7653" target="_blank" rel="noopener">https://github.com/vuejs/vue/issues/7653</a></p><p>@Doeke åœ¨è¿™ä¸ªåœ°æ–¹ç»™å‡ºä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡å…¨å±€mixinï¼Œç»™é‚£äº›Promiseæ–¹æ³•å¤–é¢åŒ…ä¸€å±‚Promiseï¼Œåœ¨è¿™ä¸ªå¤–å±‚Promiseé“¾ä¸Šcatché‡Œé¢çš„é”™è¯¯ï¼Œä¸è¿‡è¿™æ ·éœ€è¦åšä»£ç çš„çº¦å®šï¼Œå°±æ˜¯åŸæ¥çš„æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ã€‚</p></blockquote><p>main.jsé‡Œæ·»åŠ @Doekeçš„æ€è·¯</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Vue.mixin(&#123;</span><br><span class="line">  beforeCreate: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    <span class="hljs-keyword">const</span> methods = <span class="hljs-keyword">this</span>.$options.methods || &#123;&#125;</span><br><span class="line">    <span class="hljs-built_in">Object</span>.entries(methods).forEach(<span class="hljs-function">(<span class="hljs-params">[key, method]</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="hljs-keyword">if</span> (method._asyncWrapped) <span class="hljs-keyword">return</span></span><br><span class="line">      <span class="hljs-keyword">const</span> wrappedMethod = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">const</span> result = method.apply(<span class="hljs-keyword">this</span>, args)</span><br><span class="line">        <span class="hljs-keyword">const</span> resultIsPromise = result &amp;&amp; <span class="hljs-keyword">typeof</span> result.then === <span class="hljs-string">'function'</span></span><br><span class="line">        <span class="hljs-keyword">if</span> (!resultIsPromise) <span class="hljs-keyword">return</span> result</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-keyword">async</span> (resolve, reject) =&gt; &#123;</span><br><span class="line">          <span class="hljs-keyword">try</span> &#123;</span><br><span class="line">            resolve(<span class="hljs-keyword">await</span> result)</span><br><span class="line">          &#125; <span class="hljs-keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="hljs-keyword">if</span> (!error._handled) &#123;</span><br><span class="line">              <span class="hljs-keyword">const</span> errorHandler = Vue.config.errorHandler</span><br><span class="line">              errorHandler(error)</span><br><span class="line">              error._handled = <span class="hljs-literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">            reject(error)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      wrappedMethod._asyncWrapped = <span class="hljs-literal">true</span></span><br><span class="line">      methods[key] = wrappedMethod</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨App.vue</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.fetch2()</span><br><span class="line">    <span class="hljs-keyword">this</span>.fetch3()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    fetch2 () &#123;</span><br><span class="line">      Vue.request(<span class="hljs-string">'https://api.github.com/'</span>)</span><br><span class="line">        .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="hljs-keyword">let</span> data = response.data</span><br><span class="line">          <span class="hljs-keyword">let</span> info = data.api.fetch2</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    fetch3 () &#123;</span><br><span class="line">      <span class="hljs-keyword">return</span> Vue.request(<span class="hljs-string">'https://api.github.com/'</span>)</span><br><span class="line">        .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="hljs-keyword">let</span> data = response.data</span><br><span class="line">          <span class="hljs-keyword">let</span> info = data.api.fetch3</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-comment">// ...  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿è¡Œå¹¶è§‚å¯Ÿconsoleæ‰“å°å¯ä»¥çœ‹å‡ºï¼Œfetch3çš„é”™è¯¯è¢«errorHandleræ•è·ï¼Œè€Œfetch2çš„é”™è¯¯å¹¶æ²¡æœ‰ã€‚</p><p>é‚£ä¹ˆPromiseé‡Œçš„é”™è¯¯ç»Ÿä¸€æ•è·çš„é—®é¢˜å·®ä¸å¤šåº”è¯¥è§£å†³äº†ï¼Œé‚£ä¹ˆasync/awaitçš„å‘¢ï¼Ÿ</p><p>åœ¨App.vue</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="hljs-comment">// ...</span></span><br><span class="line">  created () &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.fetch4()</span><br><span class="line">    <span class="hljs-keyword">this</span>.fetch5()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="hljs-keyword">async</span> fetch4 () &#123;</span><br><span class="line">      <span class="hljs-keyword">let</span> response = <span class="hljs-keyword">await</span> Vue.request(<span class="hljs-string">'https://api.github.com/'</span>)</span><br><span class="line">      <span class="hljs-keyword">let</span> data = response.data</span><br><span class="line">      <span class="hljs-keyword">let</span> info = data.api.fetch4</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="hljs-keyword">async</span> fetch5 () &#123;</span><br><span class="line">      <span class="hljs-keyword">let</span> response = <span class="hljs-keyword">await</span> Vue.request(<span class="hljs-string">'https://api.github.com/'</span>)</span><br><span class="line">      <span class="hljs-keyword">let</span> data = response.data</span><br><span class="line">      <span class="hljs-keyword">let</span> info = data.api.fetch5</span><br><span class="line">      <span class="hljs-keyword">return</span> response</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="hljs-comment">// ...  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>fetch4å¹¶æ²¡æœ‰è¿”å›Promiseï¼Œfetch5è¿”å›çš„ä¹Ÿä¸æ˜¯Promiseå¯¹è±¡ï¼Œä½†æ˜¯å½“è¿è¡Œçš„æ—¶å€™æˆ‘ä»¬ä¼šå‘ç°fetch4å’Œfetch5çš„é”™è¯¯ä¿¡æ¯éƒ½è¢«æ•è·äº†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºasync/awaitæœ¬èº«å°±æ˜¯Promiseçš„è¯­æ³•ç³–ï¼Œåœ¨ <a href="https://babeljs.io" target="_blank" rel="noopener">babeljs</a> å®˜ç½‘çš„ â€œTry it outâ€ å°è¯•ç”¨ async/awaitï¼Œä½ ä¼šå‘ç°æœ€åç¼–è¯‘åçš„ä»£ç å°±æ˜¯åœ¨å¤–åŒ…äº†ä¸€å±‚Promiseã€‚</p><h4 id="åœ¨å“ªé‡Œæ•è·æ›´ä¸ºä¼˜é›…ï¼Ÿï¼ˆå°½é‡ä»¥æ›´å°‘çš„ä»£ç è¦†ç›–å¤§éƒ¨åˆ†æˆ–è€…å…¨éƒ¨ä»£ç ï¼‰"><a href="#åœ¨å“ªé‡Œæ•è·æ›´ä¸ºä¼˜é›…ï¼Ÿï¼ˆå°½é‡ä»¥æ›´å°‘çš„ä»£ç è¦†ç›–å¤§éƒ¨åˆ†æˆ–è€…å…¨éƒ¨ä»£ç ï¼‰" class="headerlink" title="åœ¨å“ªé‡Œæ•è·æ›´ä¸ºä¼˜é›…ï¼Ÿï¼ˆå°½é‡ä»¥æ›´å°‘çš„ä»£ç è¦†ç›–å¤§éƒ¨åˆ†æˆ–è€…å…¨éƒ¨ä»£ç ï¼‰"></a>åœ¨å“ªé‡Œæ•è·æ›´ä¸ºä¼˜é›…ï¼Ÿï¼ˆå°½é‡ä»¥æ›´å°‘çš„ä»£ç è¦†ç›–å¤§éƒ¨åˆ†æˆ–è€…å…¨éƒ¨ä»£ç ï¼‰</h4><p><strong>ç½‘ç»œå±‚</strong>ï¼šå¯ä»¥åœ¨axios.createåˆ›å»ºçš„å®ä¾‹ä¸­</p><p><strong>é€»è¾‘å±‚</strong>ï¼šéPromiseæœ¬èº«å°±ä¼šè¢«errorHandleræ•è·ï¼›Promiseç›¸å…³çš„å¯ä»¥é€šè¿‡å…¨å±€mixinç»™è¿”å›Promiseå¯¹è±¡çš„æ–¹æ³•åšä¸€ä¸ªå¤–å±‚åŒ…è£…ï¼Œç»Ÿä¸€catchå¹¶è°ƒç”¨errorHandlerå¤„ç†ï¼ˆ<strong><em>è¿™ä¸ªæ–¹æ³•çš„æ˜¯å¦æœ‰å‰¯ä½œç”¨è¿˜éœ€è¦ç ”ç©¶!</em></strong>ï¼‰</p><h4 id="æ•è·çš„é”™è¯¯å­˜æ”¾åœ¨å“ªï¼Ÿ"><a href="#æ•è·çš„é”™è¯¯å­˜æ”¾åœ¨å“ªï¼Ÿ" class="headerlink" title="æ•è·çš„é”™è¯¯å­˜æ”¾åœ¨å“ªï¼Ÿ"></a>æ•è·çš„é”™è¯¯å­˜æ”¾åœ¨å“ªï¼Ÿ</h4><p><strong># è‡ªå·±ç®€æ˜“æœåŠ¡ ï¼Ÿ</strong></p><p>æ„Ÿè§‰æˆæœ¬å¾ˆå¤§ï¼ˆäººåŠ›å’Œå·¥æ—¶ï¼‰</p><p><strong># å®˜æ–¹æ¨èçš„ <a href="https://sentry.io/" target="_blank" rel="noopener">Sentry</a>  </strong></p><p>æ³¨å†Œåå®‰è£…å®˜æ–¹çš„JS SDK</p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install raven-js --save</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹main.js</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ...</span></span><br><span class="line"><span class="hljs-keyword">import</span> Raven <span class="hljs-keyword">from</span> <span class="hljs-string">'raven-js'</span></span><br><span class="line"><span class="hljs-keyword">import</span> RavenVue <span class="hljs-keyword">from</span> <span class="hljs-string">'raven-js/plugins/vue'</span></span><br><span class="line"></span><br><span class="line">Raven</span><br><span class="line">  .config(<span class="hljs-string">'https://1dfc5e63808b41058675b4b3aed4cfb6@sentry.io/1298044'</span>) <span class="hljs-comment">// sentry token</span></span><br><span class="line">  .addPlugin(RavenVue, Vue)</span><br><span class="line">  .install()</span><br><span class="line"></span><br><span class="line">Vue.config.errorHandler = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, vm, info</span>) </span>&#123;</span><br><span class="line">  Raven.captureException(err)</span><br><span class="line">&#125;</span><br><span class="line">Vue.request = <span class="hljs-function">(<span class="hljs-params">args</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    request(args).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;</span><br><span class="line">      resolve(res)</span><br><span class="line">    &#125;).catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;</span><br><span class="line">      Raven.captureException(err)</span><br><span class="line">      reject(err)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-comment">// ...</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹App.vue ï¼ˆæˆ‘ä»¬ä»æœ€æ™®é€šçš„jsæµ‹è¯•èµ·ï¼‰<br><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// ...</span></span><br><span class="line">created () &#123;</span><br><span class="line">    <span class="hljs-keyword">this</span>.normal()</span><br><span class="line">    <span class="hljs-comment">// this.fetch1()</span></span><br><span class="line">    <span class="hljs-comment">// this.fetch2()</span></span><br><span class="line">    <span class="hljs-comment">// this.fetch3()</span></span><br><span class="line">    <span class="hljs-comment">// this.fetch4()</span></span><br><span class="line">    <span class="hljs-comment">// this.fetch5()</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="hljs-comment">// ...</span></span><br></pre></td></tr></table></figure></p><p>æ‰“å¼€sentryé¡µé¢æŸ¥çœ‹<br><img src="/images/js-capture-error/1.png" alt="é”™è¯¯æŠ¥å‘Šåˆ—è¡¨"><br><img src="/images/js-capture-error/2.jpg" alt="é”™è¯¯æŠ¥å‘Šè¯¦æƒ…ï¼ˆæ¨¡ç³Šäº†IPéƒ¨åˆ†ï¼‰"><br>æˆ‘ä»¬é€šè¿‡ä¸Šé¢2å¼ å›¾ç‰‡å¯ä»¥çœ‹å‡ºï¼Œsentryè‡ªå¸¦ä¸€ä¸ªç®€å•çš„issueç®¡ç†åŠŸèƒ½ï¼Œæ­¤å¤–è¯¦æƒ…é¡µé¢çš„é”™è¯¯æ ˆå·²ç»æ–¹ä¾¿æˆ‘ä»¬çŸ¥é“é—®é¢˜å‡ºåœ¨å“ªé‡Œäº†ã€‚</p><p>æµ‹è¯•fetch1çš„ajaxè¯·æ±‚é”™è¯¯<br><img src="/images/js-capture-error/3.jpg" alt="æˆåŠŸæˆªè·api1.github.comè¿™ä¸ªé”™è¯¯åŸŸå"></p><p>é™¤äº†fetch2æ— æ³•è¢«æ•è·å¤–ï¼ˆä¹‹å‰æè¿‡ï¼Œå®ƒæ²¡æœ‰è¿”å›Promiseå¯¹è±¡ï¼‰ï¼Œå…¶å®ƒçš„éƒ½èƒ½è¢«æ•è·ã€‚ä¸è¿‡Promiseå’Œasync/awaitçš„é”™è¯¯æ ˆæ¯”è¾ƒå°‘ã€‚å°¤å…¶æ˜¯Promise.thené‡Œçš„é”™è¯¯ï¼Œå¦‚ä¸‹2å¼ å›¾çš„å¯¹æ¯”ï¼š</p><p><img src="/images/js-capture-error/4.jpg" alt="Promise.thené‡Œçš„é”™è¯¯"><br><img src="/images/js-capture-error/5.jpg" alt="async/awaité‡Œçš„é”™è¯¯"></p><p>é™¤äº†é»˜è®¤çš„æ•°æ®çš„æ”¶é›†å¤–ï¼Œè¿˜èƒ½æ”¶é›†ä¸€äº›å…¶ä»–æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·ä¿¡æ¯</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Raven.setUser(&#123;</span><br><span class="line">    name: <span class="hljs-string">'miser name'</span>,</span><br><span class="line">    id: <span class="hljs-string">'miser id'</span></span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p><img src="/images/js-capture-error/6.jpg" alt="ç”¨æˆ·ä¿¡æ¯é¡ºæ”¶é›†"></p><p><strong>æˆ‘ä»¬æµ‹è¯•äº†ä»£ç æœªè¢«å‹ç¼©çš„æƒ…å†µï¼Œå¦‚æœä»£ç å‹ç¼©äº†å‘¢ï¼Ÿ</strong></p><p><img src="/images/js-capture-error/7.jpg" alt="é€šè¿‡npm run build å‹ç¼©ä»£ç æ‰“å¼€é¦–é¡µï¼Œä¸€è„¸æ‡µé€¼"></p><p>æ˜¾ç„¶æˆ‘ä»¬ä¸èƒ½ç›´è§‚çš„è·å¾—é”™è¯¯å®šä½ï¼Œä¸è¿‡sentryæä¾›<a href="https://github.com/google/closure-compiler/wiki/Source-Maps" target="_blank" rel="noopener">SourceMaps</a>å­˜å‚¨æœåŠ¡ï¼Œå®ƒèƒ½æ–¹ä¾¿çš„debugè¢«å‹ç¼©çš„ä»£ç ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<a href="https://www.npmjs.com/package/webpack-sentry-plugin" target="_blank" rel="noopener">webpack-sentry-plugin</a>å·¥å…·å°†æ•´ä¸ªä¸Šä¼ è¿‡ç¨‹å†™è¿›webpacké‡Œï¼Œå› ä¸ºæˆ‘ä»¬çš„å®éªŒç¯å¢ƒæ˜¯vue3ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªvue.config.jsæ–‡ä»¶</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> SentryPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-sentry-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">  configureWebpack: &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">      <span class="hljs-keyword">new</span> SentryPlugin(&#123;</span><br><span class="line">        organization: <span class="hljs-string">'fe-org'</span>, <span class="hljs-comment">// ç»„ç»‡åç§° ç±»ä¼¼å…¬å¸åå§ï¼ˆä¸€ä¸ªç”¨æˆ·ä¸‹å¯ä»¥æœ‰å¤šä¸ªç»„ç»‡ï¼‰</span></span><br><span class="line">        project: <span class="hljs-string">'popcorn-vue'</span>, <span class="hljs-comment">// é¡¹ç›®åç§° ï¼ˆä¸€ä¸ªç»„ç»‡ä¸‹å¯ä»¥æœ‰å¤šä¸ªé¡¹ç›®ï¼‰</span></span><br><span class="line">        apiKey: <span class="hljs-string">'17c7d61a800f495c803196e2c02cadeb1b41454247db4f06a5c54193510da150'</span>,</span><br><span class="line">        release: <span class="hljs-string">'1.2.4-beta'</span> <span class="hljs-comment">// å‘å¸ƒåçš„ä»£ç å’Œè¿™ä¸ªå¯¹åº”ï¼Œå¯ä»¥æ‰¾åˆ°è¿™ä¸ªsourcemaps</span></span><br><span class="line">      &#125;)</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹main.js<br><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Raven</span><br><span class="line">  .config(<span class="hljs-string">'https://1dfc5e63808b41058675b4b3aed4cfb6@sentry.io/1298044'</span>, &#123;</span><br><span class="line">    release: <span class="hljs-string">'1.2.4-beta'</span> <span class="hljs-comment">// æ–°å¢</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .addPlugin(RavenVue, Vue)</span><br><span class="line">  .install()</span><br></pre></td></tr></table></figure></p><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹sentryé‡Œpopcorn-vueé¡¹ç›®ä¸­çš„<strong>ç‰ˆæœ¬</strong></p><p><img src="/images/js-capture-error/8.jpg" alt="1.2.4-betaæ˜¯ç›®å‰çš„ï¼Œ1.2.3-betaæ˜¯ä»¥å‰ç‰ˆæœ¬"><br><img src="/images/js-capture-error/9.jpg" alt="ç‚¹å‡» 1.2.4-beta è¿›å»ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°åˆšåˆšä¸Šä¼ çš„jså’Œjs.mapæ–‡ä»¶"></p><p>æˆ‘ä»¬æ‰“å¼€buildå®Œçš„index.htmlï¼Œè™½ç„¶é”™è¯¯æˆåŠŸæ•è·ä½†ä¾æ—§å’Œä¸Šå›¾çš„ä¸€æ ·ï¼Œæ— æ³•è¢«SourceMapsè§£æï¼Œå¤§æ¦‚çš„åŸå› æ˜¯jså’Œjs.mapçš„ç›®å½•ç»“æ„é—®é¢˜ã€‚</p><p>è¿™ä¸ªissue <a href="https://github.com/getsentry/sentry-electron/issues/54" target="_blank" rel="noopener">https://github.com/getsentry/sentry-electron/issues/54</a> æ˜¯ä¸€ä¸ªå¾ˆç»å…¸çš„ä¾‹å­ï¼Œå®ƒçŠ¯äº†2ä¸ªé”™è¯¯</p><p>â€“ ä»…ä»…ä¼ äº†js.mapè€Œæ²¡æœ‰ä¼ è¢«å‹ç¼©çš„jsæ–‡ä»¶ï¼Œå®ƒä»¬åº”è¯¥ä¸€ä¸€å¯¹åº”çš„ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Š<br>â€“ jså’Œjs.mapç›®å½•è·¯å¾„ä¸åŒ¹é…</p><p>è¿™2ä¸ªåŸå› éƒ½ä¼šå¯¼è‡´æ— æ³•æ­£å¸¸è§£æè¢«å‹ç¼©çš„æ–‡ä»¶ã€‚</p><p>é‚£ä¹ˆä¸ç›´æ¥é€šè¿‡æµè§ˆå™¨æ‰“å¼€index.htmlï¼ˆfile:///<strong>**</strong>/vue-capture-error/dist/index.htmlï¼‰ï¼Œé€šè¿‡nginxå»æ¨¡æ‹Ÿæ­£å¼ç¯å¢ƒã€‚<br><figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew install nginx</span><br><span class="line">nginx</span><br></pre></td></tr></table></figure></p><p>å°†buildå‡ºçš„ä»£ç distæ‹·è´åˆ°nginxé»˜è®¤ç›®å½•ä¸‹ /usr/local/var/www/ï¼Œæ‰“å¼€æµè§ˆå™¨<a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a></p><p>å›åˆ°sentryä¸­æŸ¥çœ‹æ–°çš„é”™è¯¯è®°å½•</p><p><img src="/images/js-capture-error/10.jpg" alt="å·²ç»å¾ˆè¯¦ç»†çš„è®°å½•äº†å‡ºé”™çš„æ–¹æ³•"></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;ä¸ºä»€ä¹ˆéœ€è¦æ•è·ï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä¸ºä»€ä¹ˆéœ€è¦æ•è·ï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;ä¸ºä»€ä¹ˆéœ€è¦æ•è·ï¼Ÿ&quot;&gt;&lt;/a&gt;ä¸ºä»€ä¹ˆéœ€è¦æ•è·ï¼Ÿ&lt;/h4&gt;&lt;p&gt;å‰ç«¯ä»£ç è¿è¡Œåœ¨å®¢æˆ·ç«¯çš„æµè§ˆå™¨é‡Œï¼Œå½“å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‡ºç°ä»»ä½•é—®é¢˜ï¼Œåœ¨æ²¡æœ‰é”™è¯¯æ—¥å¿—çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä¸çŸ¥é“é—®é¢˜å‘ç”Ÿåœ¨å“ªï¼Œæˆ‘ä»¬åªèƒ½ä¾é çŒœæµ‹æˆ–è€…è‡ªå·±ä¸æ–­å°è¯•æ‰çŸ¥é“ï¼Œæˆ–è€…æ°¸è¿œä¸çŸ¥é“é—®é¢˜ã€‚&lt;/p&gt;
&lt;h4 id=&quot;å®¢æˆ·ç«¯æ€ä¹ˆæ•è·ï¼Ÿ&quot;&gt;&lt;a href=&quot;#å®¢æˆ·ç«¯æ€ä¹ˆæ•è·ï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;å®¢æˆ·ç«¯æ€ä¹ˆæ•è·ï¼Ÿ&quot;&gt;&lt;/a&gt;å®¢æˆ·ç«¯æ€ä¹ˆæ•è·ï¼Ÿ&lt;/h4&gt;&lt;p&gt;1.é€šè¿‡window.onerrorï¼Œå¯æƒœåªèƒ½è·å¾—åŸºç¡€çš„jsé”™è¯¯ï¼ŒPromiseã€async/await é‡Œçš„é”™è¯¯æ— æ³•æ•è·ï¼Œå®ƒæ”¶åˆ°åŒæºå†³ç­–çš„å½±å“&lt;/p&gt;
&lt;p&gt;2.Promise é€šè¿‡&lt;strong&gt;catch&lt;/strong&gt;æ–¹æ³•&lt;/p&gt;
&lt;p&gt;3.async/await é€šè¿‡ &lt;strong&gt;try - catch&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;4.Vueå¯ä»¥é€šè¿‡å…¨å±€Vue.config.errorHandlerå»è·å¾—éPromiseã€async/awaité‡Œçš„é”™è¯¯ï¼Œå¯ä»¥ç†è§£ä¸ºVueé‡Œçš„window.onerror&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="https://miser.github.io/categories/javascript/"/>
    
    
  </entry>
  
  <entry>
    <title>CSSã€JSæ–‡ä»¶å¯¹ç½‘é¡µçš„å½±å“</title>
    <link href="https://miser.github.io/2018/09/30/js-css-image-loading/"/>
    <id>https://miser.github.io/2018/09/30/js-css-image-loading/</id>
    <published>2018-09-30T10:18:33.475Z</published>
    <updated>2019-01-18T13:48:22.030Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬å¸¸è¯´æµè§ˆå™¨æ˜¯å•çº¿ç¨‹çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨åŠ è½½èµ„æºçš„æ—¶å€™é¡µé¢æ˜¯åœ¨ç­‰å¾…åŠ è½½å®Œæˆå‘¢ï¼Ÿè¿˜æ˜¯ç»§ç»­æ‰§è¡Œåç»­çš„æ“ä½œï¼ŸåŠ è½½ä¸åŒèµ„æºå¯¹æµè§ˆå™¨çš„æ“ä½œä¼šæœ‰ç›¸åŒå“åº”å—ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªä¸€ä¸ªç®€å•çš„å®éªŒæµ‹è¯•æ¥äº†è§£ã€‚</p><a id="more"></a><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p><em>æ‰€æœ‰èµ„æºå‡åœ¨localhostï¼Œæµè§ˆå™¨chrome 69ï¼Œä¸åŒæµè§ˆå™¨æˆ–ç‰ˆæœ¬ä¼šæœ‰å°‘è®¸ä¸åŒ</em></p><p>â€“ css</p><ul><li>css1.css 2ç§’åè¿”å› body { background-color: #444 }</li><li>css2.css ç«‹å³è¿”å› body { font-size: 50px;font-weight: bold; }</li></ul><p>â€“ js</p><ul><li>js1.js 1ç§’åè¿”å› console.log(â€œjs1.js loadedâ€) </li><li>js2.js ç«‹å³è¿”å› console.log(â€œjs2.js loadedâ€)</li><li>js3.js 3ç§’åè¿”å› console.log(â€œjs2.js loadedâ€)</li></ul><p>â€“ image</p><ul><li>img1.png 3ç§’å è¿”å›ä¸€å¼ é»„è‰²jså›¾ç‰‡</li><li>img2.png ç«‹å³è¿”å›ä¸€å¼  nodejså›¾ç‰‡</li></ul><p>æœåŠ¡å™¨ç«¯ä»£ç ï¼š</p><figure class="highlight js hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> Koa = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> Router = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-router'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> views = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-views'</span>)</span><br><span class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> Koa()</span><br><span class="line"><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> Router()</span><br><span class="line"></span><br><span class="line">app.use(views(__dirname + <span class="hljs-string">'/views'</span>))</span><br><span class="line"></span><br><span class="line">router.get(<span class="hljs-string">'/'</span>, <span class="hljs-keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="hljs-keyword">await</span> ctx.render(<span class="hljs-string">'index.html'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.get(<span class="hljs-string">'/css1.css'</span>, <span class="hljs-keyword">async</span> ctx =&gt; <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    ctx.set(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/css'</span>)</span><br><span class="line">    ctx.body = <span class="hljs-string">'body &#123; background-color: #444 &#125;'</span></span><br><span class="line">    resolve()</span><br><span class="line">  &#125;, <span class="hljs-number">1000</span> * <span class="hljs-number">2</span>)</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">router.get(<span class="hljs-string">'/css2.css'</span>, <span class="hljs-keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.set(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/css'</span>)</span><br><span class="line">  ctx.body = <span class="hljs-string">'body &#123; font-size: 50px;font-weight: bold; &#125;'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.get(<span class="hljs-string">'/js1.js'</span>, <span class="hljs-keyword">async</span> ctx =&gt; <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    ctx.body = <span class="hljs-string">'console.log("js1.js loaded")'</span></span><br><span class="line">    resolve()</span><br><span class="line">  &#125;, <span class="hljs-number">1000</span>)</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">router.get(<span class="hljs-string">'/js2.js'</span>, <span class="hljs-keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.body = <span class="hljs-string">'console.log("js2.js loaded")'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.get(<span class="hljs-string">'/js3.js'</span>, <span class="hljs-keyword">async</span> ctx =&gt; <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    ctx.body = <span class="hljs-string">'console.log("js3.js loaded")'</span></span><br><span class="line">    resolve()</span><br><span class="line">  &#125;, <span class="hljs-number">1000</span> * <span class="hljs-number">3</span>)</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">router.get(<span class="hljs-string">'/img1.png'</span>, <span class="hljs-keyword">async</span> ctx =&gt; <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="line">    ctx.set(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'image/png; charset=UTF-8'</span>)</span><br><span class="line">    ctx.body = fs.createReadStream(<span class="hljs-string">'1.png'</span>)</span><br><span class="line">    resolve()</span><br><span class="line">  &#125;, <span class="hljs-number">1000</span> * <span class="hljs-number">3</span>)</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">router.get(<span class="hljs-string">'/img2.png'</span>, <span class="hljs-keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">  ctx.set(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'image/png; charset=UTF-8'</span>)</span><br><span class="line">  ctx.body = fs.createReadStream(<span class="hljs-string">'2.png'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app</span><br><span class="line">  .use(router.routes())</span><br><span class="line">  .use(router.allowedMethods())</span><br><span class="line"></span><br><span class="line">app.listen(<span class="hljs-number">3000</span>)</span><br></pre></td></tr></table></figure><h2 id="å®éªŒä¸€ï¼š-CSSåŠ è½½æ˜¯å¦å½±å“DOMè§£æ"><a href="#å®éªŒä¸€ï¼š-CSSåŠ è½½æ˜¯å¦å½±å“DOMè§£æ" class="headerlink" title="å®éªŒä¸€ï¼š CSSåŠ è½½æ˜¯å¦å½±å“DOMè§£æ"></a>å®éªŒä¸€ï¼š CSSåŠ è½½æ˜¯å¦å½±å“DOMè§£æ</h2><p>index.html</p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">const</span> el = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'app'</span>)</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.log(el)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;, 0)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/css1.css"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/css2.css"</span> /&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100px"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img1.png"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100px"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img2.png"</span> /&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">  <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test'</span>)</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">&lt;!-- console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">appå…ƒç´ å¯¹è±¡</span></span><br><span class="line"><span class="hljs-comment">test: 1947.620849609375ms</span></span><br><span class="line"><span class="hljs-comment">--&gt;</span></span><br></pre></td></tr></table></figure><p>ä»æ§åˆ¶å°çš„è¾“å‡ºå¯ä»¥çœ‹åˆ° app å…ƒç´ ä¼šè¢«æ­£ç¡®è¾“å‡ºï¼Œ2ç§’å·¦å³å†è¾“å‡º test çš„æ—¶é—´ï¼Œå¯è§<strong>CSSåŠ è½½å¹¶ä¸ä¼šé˜»ç¢DOMè§£æ</strong>ã€‚</p><h2 id="å®éªŒäºŒï¼š-CSSåŠ è½½æ˜¯å¦å½±å“JSæ‰§è¡Œå’ŒDOMæ¸²æŸ“"><a href="#å®éªŒäºŒï¼š-CSSåŠ è½½æ˜¯å¦å½±å“JSæ‰§è¡Œå’ŒDOMæ¸²æŸ“" class="headerlink" title="å®éªŒäºŒï¼š CSSåŠ è½½æ˜¯å¦å½±å“JSæ‰§è¡Œå’ŒDOMæ¸²æŸ“"></a>å®éªŒäºŒï¼š CSSåŠ è½½æ˜¯å¦å½±å“JSæ‰§è¡Œå’ŒDOMæ¸²æŸ“</h2><p>index.html</p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/css1.css"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/css2.css"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js1.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js2.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100px"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img1.png"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100px"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img2.png"</span> /&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">  <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test'</span>)</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">&lt;!-- console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">js1.js loaded</span></span><br><span class="line"><span class="hljs-comment">js2.js loaded</span></span><br><span class="line"><span class="hljs-comment">(index):17 test: 1921.02099609375ms</span></span><br><span class="line"><span class="hljs-comment">--&gt;</span></span><br></pre></td></tr></table></figure><p>å½“æ‰“å¼€index.htmlé¡µé¢åï¼Œä¼šå‘ç°æ‰€æœ‰èµ„æºå‡åŒæ—¶å‘èµ·äº†è¯·æ±‚ï¼Œé¡µé¢ä¼šå…ˆå¤„äºç™½å±åŠ è½½çŠ¶æ€ï¼ˆDOMæ— æ³•æ¸²æŸ“ï¼‰ï¼Œå½“2ç§’ï¼ˆå·¦å³ï¼‰åé¡µé¢é™¤img1.pngæœªæ¸²æŸ“å¤–ï¼Œå…¶å®ƒæ ·å¼å’Œå›¾ç‰‡å‡æ¸²æŸ“ã€‚</p><p>ä»æ§åˆ¶å°çš„è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶jsæ¯”csså¿«1ç§’å·¦å³åŠ è½½å®Œæ¯•ï¼Œä½†æ˜¯æ­¤åˆ»æ˜¯å¤„äºé˜»å¡çŠ¶æ€å¹¶æ²¡æœ‰æ‰§è¡Œï¼Œå½“cssåŠ è½½å®Œæˆåï¼Œæ‰ä»ä¸Šè‡³ä¸‹çš„æ‰§è¡Œï¼ˆè™½ç„¶js2.jsæ¯”js1.jsæ—©åŠ è½½å¥½ï¼Œä½†æ˜¯æ‰§è¡Œçš„æ—¶å€™è¿˜æ˜¯ä»ä¸Šè‡³ä¸‹çš„ï¼‰ï¼Œå½“css1.cssåŠ è½½å®Œæˆåï¼Œé¡µé¢ç«‹å³æ¸²æŸ“ï¼Œå›¾ç‰‡img1.pngæ™š1ç§’å·¦å³æ˜¾ç¤ºã€‚å¯è§<strong>CSSåŠ è½½ä¼šé˜»ç¢JSæ‰§è¡Œå’ŒDOMçš„æ¸²æŸ“</strong>ã€‚</p><h2 id="å®éªŒä¸‰ï¼š-JSåŠ è½½æ˜¯å¦å½±å“DOMè§£æå’Œæ¸²æŸ“"><a href="#å®éªŒä¸‰ï¼š-JSåŠ è½½æ˜¯å¦å½±å“DOMè§£æå’Œæ¸²æŸ“" class="headerlink" title="å®éªŒä¸‰ï¼š JSåŠ è½½æ˜¯å¦å½±å“DOMè§£æå’Œæ¸²æŸ“"></a>å®éªŒä¸‰ï¼š JSåŠ è½½æ˜¯å¦å½±å“DOMè§£æå’Œæ¸²æŸ“</h2><p>index.html</p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">const</span> el = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'app'</span>)</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.log(el)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;, 0)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js3.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100px"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img1.png"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100px"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img2.png"</span> /&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">  <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test'</span>)</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">&lt;!-- console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">null</span></span><br><span class="line"><span class="hljs-comment">js3.js loaded</span></span><br><span class="line"><span class="hljs-comment">test: 2943.9951171875ms</span></span><br><span class="line"><span class="hljs-comment">--&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä»…å¼•å…¥ä¸€ä¸ªjs3.jsæ–‡ä»¶ï¼Œè®¾ç½®å®ƒçš„è¿”å›æ—¶é—´ä¸º3ç§’ï¼Œä»æ§åˆ¶å°çš„è¾“å‡ºå¯ä»¥çœ‹åˆ° app å…ƒç´ æ²¡æœ‰è¢«æ­£ç¡®è¾“å‡ºï¼ˆè¾“å‡ºnullï¼‰ï¼Œ3ç§’å·¦å³å†è¾“å‡º test çš„æ—¶é—´ï¼Œå¯è§<strong>JSåŠ è½½ä¼šé˜»ç¢DOMè§£æï¼Œæ—¢ç„¶è§£æéƒ½è¢«å½±å“è‡ªç„¶å¿…å®šå½±å“æ¸²æŸ“äº†</strong>ã€‚</p><h2 id="å®éªŒå››ï¼š-DOMçš„DOMContentLoadedå’ŒonLoadäº‹ä»¶"><a href="#å®éªŒå››ï¼š-DOMçš„DOMContentLoadedå’ŒonLoadäº‹ä»¶" class="headerlink" title="å®éªŒå››ï¼š DOMçš„DOMContentLoadedå’ŒonLoadäº‹ä»¶"></a>å®éªŒå››ï¼š DOMçš„DOMContentLoadedå’ŒonLoadäº‹ä»¶</h2><p>index.html</p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test'</span>)</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'testonload'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-javascript">    &#125;, <span class="hljs-literal">false</span>)</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">window</span>.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'testonload'</span>)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/css1.css"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/css2.css"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js1.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js2.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100px"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img1.png"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100px"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img2.png"</span> /&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">  <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test'</span>)</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">&lt;!-- console è¾“å‡º</span></span><br><span class="line"><span class="hljs-comment">js1.js loaded</span></span><br><span class="line"><span class="hljs-comment">js2.js loaded</span></span><br><span class="line"><span class="hljs-comment">test: 1955.489990234375ms</span></span><br><span class="line"><span class="hljs-comment">testDOMContentLoaded: 1956.044189453125ms</span></span><br><span class="line"><span class="hljs-comment">testonload: 2964.078857421875ms</span></span><br><span class="line"><span class="hljs-comment">--&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡æ§åˆ¶å°ä¼šå‘ç° testDOMContentLoaded ä¼šåœ¨2ç§’å·¦å³æ‰“å°å‡ºæ¥ï¼Œtestonloadä¼šåœ¨3ç§’å·¦å³æ‰“å°å‡ºæ¥ï¼Œç”±æ­¤å¯çŸ¥<strong>DOMContentLoadedæ˜¯jså’Œcssæ–‡ä»¶çš„åŠ è½½åè§¦å‘ï¼Œonloadæ˜¯æ•´ä¸ªé¡µé¢æ‰€æœ‰èµ„æºåŠ è½½å®Œåè§¦å‘ï¼ˆæ¯”å¦‚å›¾ç‰‡ç­‰ï¼‰</strong>ã€‚</p><h2 id="å®éªŒäº”ï¼š-script-async-å±æ€§"><a href="#å®éªŒäº”ï¼š-script-async-å±æ€§" class="headerlink" title="å®éªŒäº”ï¼š script async å±æ€§"></a>å®éªŒäº”ï¼š script async å±æ€§</h2><p>index.html</p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-javascript">    &#125;, <span class="hljs-literal">false</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">const</span> el = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'app'</span>)</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.log(el)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;, 0)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">async</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js1.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">async</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js2.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">async</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js3.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3ä¸ªjsæ–‡ä»¶éƒ½åŠ ä¸Šâ€asyncâ€,ä¼šå‘ç°è¾“å‡ºé¡ºåºæ˜¯</p><ul><li>testDOMContentLoaded ä¼šç«‹å³æ‰“å°å‡ºæ¥</li><li>appå…ƒç´ å¯¹è±¡</li><li>js2.js loaded</li><li>js1.js loaded</li><li>js3.js loaded</li></ul><p>ä¹‹åæˆ‘ä»¬å°†js1.jsä¸Šçš„â€asyncâ€ç§»é™¤ï¼Œä¼šå‘ç°è¾“å‡ºé¡ºåºæ˜¯</p><ul><li>el ä¸º null</li><li>js1.js loaded</li><li>testDOMContentLoaded 1ç§’å·¦å³æ—¶é—´</li><li>js2.js loaded</li><li>js3.js loaded</li></ul><p>ä¹‹åæˆ‘ä»¬å°†js3.jsä¸Šçš„â€asyncâ€ç§»é™¤ï¼Œä¼šå‘ç°è¾“å‡ºé¡ºåºæ˜¯</p><ul><li>el ä¸º null</li><li>js1.js loaded</li><li>js2.js loaded</li><li>js3.js loaded</li><li>testDOMContentLoaded 3ç§’å·¦å³æ—¶é—´</li></ul><p>å¯è§<strong>asyncä¼šæ‰“ä¹±jsçš„æ‰§è¡Œé¡ºåºï¼Œæœ‰asyncçš„jsæ–‡ä»¶å“ªä¸ªå…ˆåŠ è½½å®Œå“ªä¸ªå…ˆæ‰§è¡Œï¼ŒDOMContentLoadedçš„è§¦å‘æ—¶é—´ä¸åœ¨å’Œasyncæœ‰å…³ç³»ï¼Œä¸ä¼šå½±å“é¡µé¢çš„æ¸²æŸ“å’Œè§£æ</strong></p><h2 id="å®éªŒå…­ï¼š-script-defer-å±æ€§"><a href="#å®éªŒå…­ï¼š-script-defer-å±æ€§" class="headerlink" title="å®éªŒå…­ï¼š script defer å±æ€§"></a>å®éªŒå…­ï¼š script defer å±æ€§</h2><p>index.html</p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-javascript">    &#125;, <span class="hljs-literal">false</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">const</span> el = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'app'</span>)</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.log(el)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;, 0)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js1.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js2.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js3.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3ä¸ªjsæ–‡ä»¶éƒ½åŠ ä¸Šâ€deferâ€,ä¼šå‘ç°è¾“å‡ºé¡ºåºæ˜¯</p><ul><li>appå…ƒç´ å¯¹è±¡</li><li>js1.js loaded</li><li>js2.js loaded</li><li>js3.js loaded</li><li>testDOMContentLoaded 3ç§’å·¦å³æ—¶é—´</li></ul><p>è¿™å’Œæ²¡æœ‰åŠ deferå’Œasyncæ—¶ä¸€æ ·</p><p>ä¹‹åæˆ‘ä»¬å°†js1.jsä¸Šçš„â€deferâ€ç§»é™¤ï¼Œä¼šå‘ç°è¾“å‡ºé¡ºåºæ˜¯</p><ul><li>el ä¸º null</li><li>js1.js loaded</li><li>js2.js loaded</li><li>js3.js loaded</li><li>testDOMContentLoaded 3ç§’å·¦å³æ—¶é—´</li></ul><p>è¿™å’Œæ²¡æœ‰åŠ deferå’Œasyncæ—¶ä¸€æ ·</p><p>ä¹‹åæˆ‘ä»¬å°†js3.jsä¸Šçš„â€deferâ€ç§»é™¤ï¼Œä¼šå‘ç°è¾“å‡ºé¡ºåºæ˜¯</p><ul><li>js1.js loaded</li><li>js3.js loaded</li><li>js2.js loaded</li><li>testDOMContentLoaded 3ç§’å·¦å³æ—¶é—´</li></ul><p>å¯è§<strong>deferä¼šæ‰“ä¹±jsçš„æ‰§è¡Œé¡ºåºï¼Œæœ‰deferçš„jsæ–‡ä»¶ä¼šæ™šäºæ²¡æœ‰çš„ï¼Œä½†æ˜¯å®ƒä»¬ï¼ˆå«æœ‰deferï¼‰ä¾æ—§ä¿æŒä»ä¸Šè€Œä¸‹ä¾æ¬¡æ‰§è¡Œï¼ŒDOMContentLoadedçš„è§¦å‘æ—¶é—´æ™šäºdeferï¼Œä¸ä¼šå½±å“é¡µé¢çš„æ¸²æŸ“å’Œè§£æ</strong></p><h2 id="å®éªŒä¸ƒï¼š-script-defer-amp-async-éƒ½åŠ ä¸Š-å±æ€§"><a href="#å®éªŒä¸ƒï¼š-script-defer-amp-async-éƒ½åŠ ä¸Š-å±æ€§" class="headerlink" title="å®éªŒä¸ƒï¼š script defer &amp; async éƒ½åŠ ä¸Š å±æ€§"></a>å®éªŒä¸ƒï¼š script defer &amp; async éƒ½åŠ ä¸Š å±æ€§</h2><p>index.html</p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-javascript">    &#125;, <span class="hljs-literal">false</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">async</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js1.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">async</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js2.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">async</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/js3.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3ä¸ªjsæ–‡ä»¶éƒ½åŠ ä¸Šâ€asyncâ€,ä¼šå‘ç°è¾“å‡ºé¡ºåºæ˜¯</p><ul><li>testDOMContentLoaded ä¼šç«‹å³æ‰“å°å‡ºæ¥</li><li>js2.js loaded</li><li>js1.js loaded</li><li>js3.js loaded</li></ul><p>asyncä¼˜å…ˆçº§æ¯”deferé«˜</p><h2 id="å®éªŒå…«ï¼š-åŠ¨æ€åˆ›å»ºscript"><a href="#å®éªŒå…«ï¼š-åŠ¨æ€åˆ›å»ºscript" class="headerlink" title="å®éªŒå…«ï¼š åŠ¨æ€åˆ›å»ºscript"></a>å®éªŒå…«ï¼š åŠ¨æ€åˆ›å»ºscript</h2><p>index.html</p><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-javascript">    &#125;, <span class="hljs-literal">false</span>)</span></span><br><span class="line"><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">       <span class="hljs-keyword">var</span> appEl = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'app'</span>)</span></span><br><span class="line"><span class="hljs-javascript">       <span class="hljs-built_in">console</span>.log(appEl)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;, 0)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">var</span>Â head = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>]</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">var</span>Â script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>)</span></span><br><span class="line"><span class="hljs-javascript">      script.type = <span class="hljs-string">'text/javascript'</span></span></span><br><span class="line"><span class="hljs-javascript">      script.src = <span class="hljs-string">'js'</span> + (i + <span class="hljs-number">1</span>) + <span class="hljs-string">'.js'</span></span></span><br><span class="line"><span class="hljs-undefined">      head.appendChild(script)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>testDOMContentLoaded ä¼šç«‹å³æ‰“å°å‡ºæ¥</li><li>appEl å¯¹è±¡</li><li>js2.js loaded</li><li>js1.js loaded</li><li>js3.js loaded</li></ul><p>å¦‚æœæˆ‘ä»¬åŠ¨æ€åˆ›å»ºjs1.jså’Œjs2.jsï¼Œå°†js3.jsä¾æ—§æŒ‰ç…§å¸¸è§„å†™æ³•å†™åœ¨é¡µé¢ä¸­çš„è¯</p><p>index.html<br><figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'testDOMContentLoaded'</span>)</span></span><br><span class="line"><span class="hljs-javascript">    &#125;, <span class="hljs-literal">false</span>)</span></span><br><span class="line"><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span></span><br><span class="line"><span class="hljs-javascript">       <span class="hljs-keyword">var</span> appEl = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'app'</span>)</span></span><br><span class="line"><span class="hljs-javascript">       <span class="hljs-built_in">console</span>.log(appEl)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;, 0)</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js3.js"</span>&gt;</span><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">var</span>Â head = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>]</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++) &#123;</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">var</span>Â script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>)</span></span><br><span class="line"><span class="hljs-javascript">      script.type = <span class="hljs-string">'text/javascript'</span></span></span><br><span class="line"><span class="hljs-javascript">      script.src = <span class="hljs-string">'js'</span> + (i + <span class="hljs-number">1</span>) + <span class="hljs-string">'.js'</span></span></span><br><span class="line"><span class="hljs-undefined">      head.appendChild(script)</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>hello world<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><ul><li>appEl ä¸º null ç«‹å³æ‰“å°å‡ºæ¥</li><li>js3.js loaded </li><li>testDOMContentLoaded 3ç§’å·¦å³ä¼šç«‹å³æ‰“å°å‡ºæ¥</li><li>js2.js loaded</li><li>js1.js loaded</li></ul><p>å¯è§<strong>åŠ¨æ€åˆ›å»ºscriptåŸºæœ¬æ˜¯åŒæ—¶åŠ è½½ï¼Œå“ªä¸ªå…ˆåŠ è½½å®Œå“ªä¸ªå…ˆæ‰§è¡Œï¼Œä½†æ˜¯ä»–ä»¬éƒ½æ™šäºDOMContentLoadedäº‹ä»¶</strong></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>CSSåŠ è½½ä¼šé˜»å¡DOMæ¸²æŸ“å’ŒJSæ‰§è¡Œï¼Œä½†æ˜¯ä¸å½±å“é¡µDOMè§£æï¼›JSåŠ è½½ä¼šé˜»å¡DOMè§£æå’Œæ¸²æŸ“ï¼Œç»™scriptæ ‡ç­¾åŠ ä¸Šdefer &amp; asyncå±æ€§å°†ä¸å†å½±å“DOMè§£æå’Œæ¸²æŸ“ï¼Œasync æ˜¯å“ªä¸ªå…ˆè¿”å›å…ˆæ‰§è¡ŒæŒ‰ä¸ªï¼Œdeferä¼šæ™šäºå¸¸è§„æ ‡ç­¾åŒæ—¶æŒ‰ç…§å«æœ‰deferå±æ€§çš„scriptåŠ è½½çš„é¡ºåºæ‰§è¡Œ</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ‘ä»¬å¸¸è¯´æµè§ˆå™¨æ˜¯å•çº¿ç¨‹çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨åŠ è½½èµ„æºçš„æ—¶å€™é¡µé¢æ˜¯åœ¨ç­‰å¾…åŠ è½½å®Œæˆå‘¢ï¼Ÿè¿˜æ˜¯ç»§ç»­æ‰§è¡Œåç»­çš„æ“ä½œï¼ŸåŠ è½½ä¸åŒèµ„æºå¯¹æµè§ˆå™¨çš„æ“ä½œä¼šæœ‰ç›¸åŒå“åº”å—ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªä¸€ä¸ªç®€å•çš„å®éªŒæµ‹è¯•æ¥äº†è§£ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="javascript" scheme="https://miser.github.io/categories/javascript/"/>
    
    
  </entry>
  
  <entry>
    <title>å‡ºå·®è²å¾‹å®¾</title>
    <link href="https://miser.github.io/2018/09/24/traveling-to-the-philippines/"/>
    <id>https://miser.github.io/2018/09/24/traveling-to-the-philippines/</id>
    <published>2018-09-24T06:45:00.000Z</published>
    <updated>2018-10-21T05:07:01.239Z</updated>
    
    <content type="html"><![CDATA[<p>å…¥èŒæ²¡å¤šä¹…ï¼Œå› ä¸ºè²å¾‹å®¾é¡¹ç›®çš„ç‰ˆæœ¬æ›´æ–°ï¼Œå’Œä¸€åç«¯ã€ä¸€æµ‹è¯•ï¼Œä¸‰äººç»„é˜Ÿå‰å¾€å½“åœ°æ‰“æ€ªå‡çº§ã€‚</p><p><img src="/images/traveling-to-the-philippines/1.jpg" alt="å‡†å¤‡èµ·é£"></p><a id="more"></a><p>å‰¯æœ¬Loadingä¸‰ä¸ªåŠå°æ—¶ã€‚</p><p><img src="/images/traveling-to-the-philippines/2.jpg" alt="åˆ°è¾¾å‰¯æœ¬"></p><h3 id="ä½å’Œå·¥"><a href="#ä½å’Œå·¥" class="headerlink" title="ä½å’Œå·¥"></a>ä½å’Œå·¥</h3><p>åˆ°è¾¾é©¬å°¼æ‹‰çš„æ—¶å€™å·²ç»å¿«æ™šä¸Š9ç‚¹äº†ï¼Œä¸‹é£æœºå¼„å®Œç”µè¯å¡è¿ä¸Šç½‘ç»œï¼Œæ€¥å¿™æ‰“è½¦å»åè½åœ¨BGCçš„é…’åº—â€”â€”æ­¥è¡Œç¦»å…¬å¸5MINï¼Œä¸€ä¸ªå¤§å¥—æˆ¿3äººä½ï¼Œå¥½å®½æ•ã€‚</p><p>BGCè¿‘å¹´æ¥å‘å±•å¾ˆå¿«ï¼Œç±»ä¼¼ä¸Šæµ·çš„é™†å®¶å˜´ï¼Œè®¸å¤šå¤§å‹è·¨å›½å…¬å¸å˜è¿è‡³æ­¤ï¼ˆå¦‚HSBC,Googleç­‰ï¼‰ã€‚</p><p>ç¬¬äºŒå¤©ï¼Œå‡†æ—¶æ‰“å¼€ä¸Šç­ï¼Œæ–°è£…ä¿®çš„åŠå…¬å®¤è¿˜æ˜¯ç»™äººçœ¼å‰ä¸€äº®ï¼Œå¤§å¤§å°å°çš„ä¼šè®®å®¤ã€å·¥ä½œé—´ã€æ²™å‘ã€æ¸¸æˆå®¤ã€å¥èº«æˆ¿ã€é£Ÿå“å§å°ã€ç”šè‡³è¿˜æœ‰ä¸´æ—¶ä¼‘æ¯çš„æˆ¿é—´ã€‚</p><p><img src="/images/traveling-to-the-philippines/3.jpg" alt="æ¥ä¸‹æ¥å‡ å¤©èº²åœ¨è¿™ä¼šè®®å®¤çŒ¥çå†™ä»£ç åˆ«æµª"></p><p><img src="/images/traveling-to-the-philippines/4.jpg" alt="è›®å–œæ¬¢è¿™ç¯"></p><p><img src="/images/traveling-to-the-philippines/7.jpg" alt="ä¸€è§’A"></p><p><img src="/images/traveling-to-the-philippines/8.jpg" alt="ä¸€è§’B"></p><p><img src="/images/traveling-to-the-philippines/6.jpg" alt="å¥èº«æˆ¿"></p><p><img src="/images/traveling-to-the-philippines/9.jpg" alt="å¯ä»¥ä¸´æ—¶ç¡è§‰çš„åœ°æ–¹"></p><h3 id="åƒ"><a href="#åƒ" class="headerlink" title="åƒ"></a>åƒ</h3><p>è²å¾‹å®¾çš„é¤é¥®æ„Ÿè§‰è¿˜æ˜¯åè¥¿é¤çš„ï¼Œæ²¹ç‚¸ç±»çš„åå¤šï¼Œè¡Œç¨‹ä¸­åƒçš„æ¯”è¾ƒå¤šï¼›ä¸­é¤çš„è¯åŸºæœ¬æ˜¯æ¸¯å¼ã€å°æ¹¾çš„ä¸ºä¸»ï¼Œç¬¬ä¸€å¤©æ™šä¸Šå¤œå®µå°±æ˜¯è‘—åçš„é¼æ³°ä¸°ï¼Œå‘³é“ä¸é”™ã€‚è¿™è¾¹çš„æ°´ï¼Œå¤§å¤šæ˜¯ç”Ÿæ°´ï¼Œå›½äººä¹Ÿè®¸å–ä¸æƒ¯ï¼Œä¸€èˆ¬åœ¨BGCä¸€é¡¿é¥­èŠ±è´¹åœ¨1500Phpå·¦å³ï¼Œå¥½ä¸€ç‚¹çš„æ—¥æ–™ä»€ä¹ˆçš„é‚£å°±æ›´è´µäº†ã€‚</p><p><img src="/images/traveling-to-the-philippines/10.jpg" alt="é¼æ³°ä¸°ï¼Œä¸­å›½é£"></p><p><img src="/images/traveling-to-the-philippines/11.jpg" alt="åšå®çš„æ±‰å ¡A"></p><p><img src="/images/traveling-to-the-philippines/12.jpg" alt="åšå®çš„æ±‰å ¡B"></p><p><img src="/images/traveling-to-the-philippines/27.jpg" alt="åšå®çš„æ±‰å ¡C"></p><p><img src="/images/traveling-to-the-philippines/13.jpg" alt="æ²¹ç‚¸é£Ÿå“"></p><p><img src="/images/traveling-to-the-philippines/14.jpg" alt="ç½‘ç»œå’–å•¡åº— ã€Œ%ã€"></p><p><img src="/images/traveling-to-the-philippines/15.jpg" alt="äº”é¢œå…­è‰²çš„æ°´æœ"></p><p><img src="/images/traveling-to-the-philippines/16.jpg" alt="712Php ä¸€å…¬æ–¤çš„ä¸‰æ–‡é±¼ï¼ˆäººæ°‘å¸100ä¸åˆ°ï¼‰"></p><p><img src="/images/traveling-to-the-philippines/17.jpg" alt="ä¸€å¤§è¢‹æ‰èŠ±äº†300ä¸åˆ°Php"></p><p>å› ä¸ºå›å›½èˆªçº¿æœ‰å²è¯—çº§å°é£ã€Œå±±ç«¹ã€ç»è¿‡ï¼Œæ‰€ä»¥åœ¨è²å¾‹å®¾å¤šå¾…2å¤©ï¼Œæœ‰æœºä¼šå»æµ·è¾¹é€›é€›éšä¾¿å»åƒæµ·é²œï¼Œæˆ‘ä»¬å»çš„å¸‚åœºæ„Ÿè§‰ä¸»è¦åšå›½äººç”Ÿæ„ï¼Œåˆ°å¤„æ˜¯ä¸­å›½äººï¼Œä¸œå—äºšçš„æµ·é²œå“ç§å·®ä¸å¤šï¼Œä¹°çš„æ—¶å€™å¯ä»¥è®¨ä»·è¿˜ä»·ã€‚</p><p><img src="/images/traveling-to-the-philippines/19.jpg" alt="æµ·é²œå¸‚åœº"></p><p><img src="/images/traveling-to-the-philippines/21.jpg" alt="é±¼"></p><p><img src="/images/traveling-to-the-philippines/20.jpg" alt="èŸ¹ï¼Œä¸åŒå¤§å°ä¸åŒçš„ä»·æ ¼"></p><p><img src="/images/traveling-to-the-philippines/22.jpg" alt="ä¸‰ä¸ªç”·çš„å¯¹æµ·é²œæ¬²æœ›ä¸å¤§ï¼Œæœ€åä¹°äº†å®ƒï¼Œ7000+ è¿˜ä»·åˆ°5500 å…¶å®è¿˜æ˜¯è´µäº† T_T"></p><p><img src="/images/traveling-to-the-philippines/23.jpg" alt="æˆå“A ä¸å¥½åƒ"></p><p><img src="/images/traveling-to-the-philippines/24.jpg" alt="æˆå“B ä¸å¥½åƒ"></p><p><img src="/images/traveling-to-the-philippines/25.jpg" alt="æˆå“C ä¸å¥½åƒ"></p><p><img src="/images/traveling-to-the-philippines/26.jpg" alt="æ˜Ÿçˆ¸çˆ¸ æ‘©å¡è¶…å¤§æ¯æŠ˜åˆäººæ°‘å¸æ‰23ä¸åˆ°ï¼Œå¥½ä¾¿å®œ"></p><h3 id="è¡Œ"><a href="#è¡Œ" class="headerlink" title="è¡Œ"></a>è¡Œ</h3><p>å¯¹äºæˆ‘ä»¬è¿™äº›åˆæ¥ä¹åˆ°çš„ï¼Œè¿˜æ˜¯å‡ºç§Ÿè½¦æ¯”è¾ƒé è°±ï¼Œæœºåœºå‡ºæ¥è¿˜æ˜¯é»„è‰²ï¼ˆè²Œä¼¼æœºåœºç‰¹æœ‰ï¼‰çš„å‡ºç§Ÿè½¦æ¯”è¾ƒé è°±ï¼Œè™½ç„¶è´µä½†æ˜¯æ²¡å‘ç”Ÿååœ°èµ·ä»·æˆ–è€…ç»•è·¯ç­‰é—®é¢˜ï¼Œä¹‹å‰åŒäº‹æ¥åç™½è‰²å‡ºç§Ÿè½¦è™½ç„¶èµ·æ­¥ä¾¿å®œä½†æ˜¯æœ€åä»˜é’±çš„æ—¶å€™æ¯”æˆ‘ä»¬è´µå¾ˆå¤šã€‚æˆ–è€…ç”¨Grabæ‰“è½¦ï¼ˆç±»ä¼¼æ»´æ»´æ‰“è½¦ï¼‰ï¼Œä»·æ ¼åˆç†ã€‚</p><p><img src="/images/traveling-to-the-philippines/28.jpg" alt="ä¸çŸ¥é“æ˜¯å·§åˆè¿˜æ˜¯å½“åœ°å‡ºç§Ÿè½¦è¿è¡Œè¦æ±‚ï¼Œç­ç«å™¨æ”¾åœ¨å·¦AæŸ±è¿™"></p><p>è²å¾‹å®¾ç‰¹è‰²<em>â€œå‰æ™®å°¼â€</em>ï¼Œäº”é¢œå…­è‰²è£…é¥°å¤¸å¼ ï¼Œæ˜¯ä¸é»‘è‰²ä¼¦æ•¦å‡ºç§Ÿè½¦å’Œé»„è‰²çº½çº¦å‡ºç§Ÿè½¦é½åçš„äº¤é€šå·¥å…·ï¼Œå¯æƒœæ²¡ä¹˜åã€‚</p><p><img src="/images/traveling-to-the-philippines/29.jpg" alt="å‰æ™®å°¼A"></p><p><img src="/images/traveling-to-the-philippines/30.jpg" alt="å‰æ™®å°¼B"></p><h3 id="å‘¨è¾¹"><a href="#å‘¨è¾¹" class="headerlink" title="å‘¨è¾¹"></a>å‘¨è¾¹</h3><p>åœ¨BGCçš„æ—¶å€™æ„Ÿè§‰é“è·¯å¾ˆå¹²å‡€ï¼Œè·¯ä¸Šæ²¡æœ‰ä»€ä¹ˆåƒåœ¾ï¼Œç”šè‡³æ‰¾ä¸ªåƒåœ¾æ¡¶éƒ½å¾ˆéš¾ï¼Œå¸¸å¸¸é¢†ç€ä¸€è¢‹åƒåœ¾ä»Aå¤„åˆ°Bå¤„ç›®çš„åœ°æ‰æœ‰åƒåœ¾æ¡¶æ‰”ï¼Œè·¯ä¸Šæ²¡çœ‹åˆ°æœ‰äººæŠ½çƒŸç­‰ï¼›å»ä¹‹å‰å¾ˆæ‹…å¿ƒå®‰å…¨é—®é¢˜ï¼Œå›½å†…å¸¸æœ‰æŠ¥é“ï¼Œåˆ°é‚£é‡Œåæ„Ÿè§‰å¾ˆå¤šæ—¶å€™æ²¡å¿…è¦è¿‡äºæ‹…å¿ƒã€‚</p><p>è°ˆä¸ä¸Šå®‰ä¿èƒ½åŠ›å¤šå¼ºï¼Œå¹³æ—¶çš„å®‰æ£€è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œè¿›å¤§æ¥¼ã€é…’åº—ã€å•†åœºéƒ½æœ‰å®‰æ£€ï¼Œç±»ä¼¼ä¸Šæµ·åœ°é“å®‰æ£€å§ï¼Œæœºå™¨æ‰«ææˆ–è€…äººå·¥æ‰“å¼€åŒ…çœ‹ï¼Œäººå·¥çœ‹çš„è¯åŸºæœ¬éƒ½æ˜¯å¸¦æ‰‹å¥—æˆ–è€…ç”¨ä¸€ä¸ªå°æœ¨æ£ï¼Œé¿å…ç›´æ¥ä¸ç‰©å“ç›´æ¥æ¥è§¦ï¼Œé¿å…ä¸å¿…è¦çš„éº»çƒ¦ã€‚å‡ å¤©ä¸‹æ¥æ²¡æœ‰è°ä¸åšæ£€æŸ¥çš„ï¼Œä¸åƒåœ°é“å®‰æ£€ç»å¸¸æœ‰äººä¸æ„¿æ„æˆ–è€…äº‰æ‰§ï¼Œå…¶å®æ— è®ºåœ¨è²å¾‹å®¾è¿˜æ˜¯å›½å†…ï¼Œå®‰æ£€åªæ˜¯é˜²å›å­ä¸é˜²å°äººçš„ï¼ˆå’Œé—¨ä¸€æ ·ï¼‰ï¼Œä½†æ˜¯å®ƒä¹Ÿæ˜¯ä¸€é“ä¿æŠ¤å¤§å®¶çš„å±éšœï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°Šé‡å®ƒï¼Œè€Œä¸æ˜¯æ•Œå¯¹å®ƒã€‚</p><p><img src="/images/traveling-to-the-philippines/31.jpg" alt="å¹²å‡€çš„è¡—é“"></p><p><img src="/images/traveling-to-the-philippines/34.jpg" alt="å®‰æ£€"></p><p><img src="/images/traveling-to-the-philippines/33.jpeg" alt="å¾ˆå¤šå¤§æ¥¼é—¨å£çš„å®‰ä¿éƒ½æœ‰æª"></p><p><img src="/images/traveling-to-the-philippines/32.jpg" alt="ä¸åƒå›½å†…ATMæœºï¼Œè¿™çš„æœºå™¨éƒ½æ˜¯å…¨éœ²å¤©çš„ï¼Œæ²¡æœ‰å°æˆ¿é—´"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åŸæœ¬å‡ºå·®7å¤©ï¼Œåæ‹œå°é£â€œå±±ç«¹â€æ‰€èµï¼Œå¤šå¾…äº†2å¤©ï¼Œå¾—ä»¥æœ‰æœºä¼šå»æµ·è¾¹æˆ–è€…æ›´å¤šåœ°æ–¹é€›é€›ã€‚æ•´ä½“ç»™æˆ‘çš„æ„Ÿè§‰å¾ˆä¸é”™ï¼Œç‰©ä»·å’Œä¸Šæµ·æ€»ä½“å·®ä¸å¤šï¼Œè‹¥ä¸æ˜¯è¯­è¨€çš„ä¸åŒï¼Œå¾ˆå¤šæ—¶å€™æ„Ÿè§‰è‡ªå·±æ˜¯ç”Ÿæ´»åœ¨é­”éƒ½ï¼Œå½“ç„¶å¤©æ°”ä¹Ÿä¼šå¸¸å¸¸æé†’ä½ :)ã€‚æœŸå¾…ä¸‹æ¬¡å†å»ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¥èŒæ²¡å¤šä¹…ï¼Œå› ä¸ºè²å¾‹å®¾é¡¹ç›®çš„ç‰ˆæœ¬æ›´æ–°ï¼Œå’Œä¸€åç«¯ã€ä¸€æµ‹è¯•ï¼Œä¸‰äººç»„é˜Ÿå‰å¾€å½“åœ°æ‰“æ€ªå‡çº§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/traveling-to-the-philippines/1.jpg&quot; alt=&quot;å‡†å¤‡èµ·é£&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="å·¥ä½œ" scheme="https://miser.github.io/categories/%E5%B7%A5%E4%BD%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>ä¸€å®¶å…¬å¸çš„å¥½åï¼Œå…ˆçœ‹HRéƒ¨é—¨</title>
    <link href="https://miser.github.io/2018/07/20/the-quality-of-a-company-first-look-at-HR-department/"/>
    <id>https://miser.github.io/2018/07/20/the-quality-of-a-company-first-look-at-HR-department/</id>
    <published>2018-07-20T09:01:34.000Z</published>
    <updated>2018-10-19T06:24:07.636Z</updated>
    
    <content type="html"><![CDATA[<p><strong>é¢å¯¹èŒ«èŒ«çš„å…¬å¸ï¼Œå¦‚ä½•å»åˆ¤æ–­ä¸€å®¶å…¬å¸æ˜¯å¦é è°±å‘¢ï¼Ÿ</strong></p><p>é™¤éä½ å…³æ³¨ä¸€å®¶å…¬å¸å¾ˆä¹…äº†æˆ–æœ‰å†…çº¿ï¼Œä¸ç„¶å…‰ä»é¢è¯•è¿‡ç¨‹ä¸­ä½ çœŸçš„å¾ˆéš¾è¯´è¿™å®¶å…¬å¸å¥½ä¸åã€‚æˆ‘ä¼šæ¯”è¾ƒçœ‹é‡HRéƒ¨é—¨ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><p>1.æˆ‘è€å©†å°±æ˜¯èµ„æ·±HRï¼Œæ·±çŸ¥è¿™ä¸ªéƒ¨é—¨çš„é‡è¦æ€§ï¼Œå’Œè¢«å¿½è§†æ€§ã€‚</p><p>2.å¦‚æœæ•´ä¸ªé¢è¯•æ²Ÿé€šè¿‡ç¨‹ä¸­ï¼ŒHRéƒ¨é—¨æ˜¾å¾—å¾ˆè–„å¼±ï¼Œè¯´æ˜è¯¥å…¬å¸çš„ç»„ç»‡æ¶æ„ä¸æ¸…æ™°ï¼Œå¤„äºæ··æ²Œé˜¶æ®µï¼Œæœ‰é£é™©ã€‚</p><p>3.å¦‚æœHRéƒ¨é—¨çš„ç´ è´¨ä¸å¤Ÿï¼Œé‚£ä¹ˆå…¥èŒäº†ï¼Œæˆ‘ä¹Ÿè§‰å¾—åç»­ä¼šæœ‰éº»çƒ¦ï¼Œæ¯”å¦‚äº¤é‡‘ã€è¯·å‡ç­‰ç­‰çš„æ²Ÿé€šä¹Ÿæ¯”è¾ƒå¤´ç–¼ã€‚</p><p>HRéœ€è¦æƒ…å•†æ™ºå•†åŒåœ¨çº¿ï¼Œå¦‚æœä¸€å®¶å…¬å¸æ‹¥æœ‰è¿™æ ·çš„HRè¯´æ˜å®ƒé‡è§†è¿™ä¸ªéƒ¨é—¨ï¼Œä¸ºçœ‹ä¼¼ä¸èµšé’±çš„éƒ¨é—¨ä¹°äº†ä¸å°‘å•ï¼Œè¯´æ˜å…¬å¸ç›ˆåˆ©æˆ–è€…ä¸šåŠ¡ç¨³å®šã€‚å°±å¦‚ï¼Œè‚šå­é¥¿äº†ï¼Œåªè¦èƒ½å¡«é¥±è‚šå­åŸºæœ¬ä»€ä¹ˆéƒ½ä¼šåƒï¼ˆç²¾åŠ›åªæœ‰åœ¨ä¸šåŠ¡èµšé’±ä¸Šï¼‰ï¼Œè€ŒçœŸçš„å»åƒå±±çæµ·å‘³è¯´æ˜æœ‰é’±ï¼ˆä¼šæœ‰ç²¾åŠ›æŠŠå…¶å®ƒç›¸å…³éƒ¨é—¨åšå¥½ï¼‰ã€‚å¥½çš„HRæ˜¯å¯¹å…¬å¸å’Œå‘˜å·¥çš„åŒä¿é™©ï¼<br><a id="more"></a><br><strong>ä¸€äº›å°ç»å†</strong></p><ul><li>è®°å¾—å¾ˆå¤šå¹´å‰ï¼Œæ‰‹ä¸ŠåŒæ—¶æ‹¿åˆ°äº†ç››å¤§åˆ›æ–°é™¢å’ŒæŸç¤¾äº¤å¹³å°çš„offerï¼Œè¯¥å¹³å°HRç”µè¯é—®æˆ‘æ„å‘ï¼Œæˆ‘è¯´æˆ‘å»åˆ›æ–°é™¢ï¼Œå¥¹æ¥ç€é—®æˆ‘åœ°å€ï¼Œæˆ‘è¯´åœ¨æµ¦ä¸œè½¯ä»¶å›­ï¼ˆå…¥èŒçš„é¡¹ç›®ç»„æ­£å¥½ä»æ€»éƒ¨æ¬å‡ºæ¥ï¼‰ã€‚è¿™HRå°±å¾ˆå˜²è®½çš„è¯­æ°”è¯´ç››å¤§åœ¨å¼ æ±Ÿæ€ä¹ˆåœ¨ä»€ä¹ˆè½¯ä»¶å›­å‘¢ï¼Œä¸€é¡¿å·´æ‹‰å·´æ‹‰ã€‚ä»æ­¤ä¹‹åè¯¥ç¤¾äº¤å¹³å°æˆ‘å°±å†ä¹Ÿä¸ç”¨äº†ï¼Œç¡®å®è¿™å‡ å¹´è¿™å¹³å°ä¸æ€ä¹ˆæ ·äº†ã€‚</li><li>å‰å‡ å¤©å»æŸä¸­å‹å…¬å¸ï¼ˆä¸¤ã€ä¸‰ç™¾å·äººå·¦å³ï¼‰ï¼ŒæŠ€æœ¯ä¸Šæ–¹å‘ä¸å¤ªç¬¦åˆï¼ŒHRéƒ½æ²¡æŠŠæˆ‘é€å‡ºé—¨ï¼Œæˆ‘ä»å¾ˆå†…éƒ¨çš„ä¼šè®®å®¤è‡ªå·±æ‘¸ç´¢ç€å‡ºé—¨ï¼Œä»ä¸­æ„Ÿå—å‡ºè¯¥å…¬å¸çš„å†·æ¼ ã€‚</li><li>æœ‰æ—¶å€™HRå¤ªé«˜å†·äº†ï¼Œæ¯•ç«Ÿä¸æ˜¯èŠæŠ€æœ¯æœ‰è¯é¢˜ï¼Œåˆæ˜¯ä¼¤æ„Ÿæƒ…çš„è–ªé…¬ç¯èŠ‚ï¼Œä¸çŸ¥é“æ€ä¹ˆèŠäº†ï¼Œä¹‹å‰èŠå¾—å†æ„‰å¿«åˆ°äº†è¿™æˆ›ç„¶è€Œæ­¢ã€‚</li><li>ç”µè¯é€šçŸ¥æˆ‘æ‹¿åˆ°offeräº†ï¼Œä½†æ˜¯ç”µè¯é‚£å¤´å…ˆæŠŠæˆ‘è´¬ä¸‹ï¼Œç„¶åæå‡ºè–ªèµ„ç»“æ„ç­‰ç­‰ã€‚æ—¢ç„¶æˆ‘ä¸å¥½ï¼Œä¸ºä»€ä¹ˆç»™æˆ‘offerå‘¢ï¼Ÿæ­¤åœ°æ— é“¶ä¸‰ç™¾ä¸¤çš„å‘Šè¯‰æˆ‘ä½ è¦æˆ‘å»ï¼Œä½†è¦å‹æˆ‘ä»·å˜›ã€‚å…¶å®å¾ˆå¤šæ—¶å€™æ—¢ç„¶èƒ½è°ˆåˆ°è¿™éƒ¨åŸºæœ¬åŒæ–¹éƒ½æœ‰æ„å‘äº†ï¼Œè–ªèµ„æ˜¯ä¸€æ–¹é¢ï¼Œè¿˜æœ‰å…¶ä»–ï¼Œé¿é‡å°±è½»çš„è¯´ç‚¹å¸å¼•äººçš„ä¸œè¥¿ï¼Œä¸æ˜¯æ›´å¥½ï¼Œå¢åŠ ç ç å—ï¼Ÿä¸€ä¸ªHRåœ¨å¤šæ¬¡å’Œé¢è¯•è€…æ²Ÿé€šåï¼Œè¿˜ä¸çŸ¥é“é¢è¯•è€…é™¤äº†è–ªèµ„è¿˜æƒ³è¦ä»€ä¹ˆï¼Œé‚£ä¹ˆæ˜¯å¤±è´¥çš„ã€‚</li></ul><p><strong>é¢è¯•åˆ«ä¸è€çƒ¦ï¼Œå¤šä¸ä¸åŒäººèŠæ˜¯å¥½äº‹ï¼Œä¹Ÿæ˜¯å­¦ä¹ </strong></p><p>èŠå¾—äººè¶Šå¤šï¼Œä½ è¶Šèƒ½çŸ¥é“å…¬å¸å’Œå›¢é˜Ÿçš„ç´ è´¨ï¼Œæ˜¯å¦å’Œè‡ªå·±åŒ¹é…ã€‚</p><p>æœ‰äº›é¢è¯•å®˜åšæŠ€æœ¯åšäº§å“å¤ªä¹…äº†ï¼Œä¸å¤ªå’Œé™Œç”Ÿäººæ‰“äº¤é“ï¼Œè¯´çš„è¯ã€é—®çš„é—®é¢˜å¸¸å¸¸æƒ…å•†ä¸åœ¨çº¿ï¼Œç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯è¦èŠ±å¾ˆé•¿æ—¶é—´å’Œå›¢é˜Ÿç£¨åˆï¼Œä¸€èˆ¬è‡ªå·±å¿ƒé‡Œä¼šäº®èµ·è­¦æŠ¥ã€‚</p><p><strong>æ€»ç»“</strong></p><p>ä¸€åœºæ„‰å¿«çš„é¢è¯•ï¼Œæ˜¯åŒæ–¹çš„å°Šé‡ã€‚é¢è¯•è€…ç­”åº”äº†å°±è¯¥å‡†æ—¶å‡ºå¸­ï¼ŒæŠŠè‡ªå·±æ‰€çŸ¥æ‰€æƒ³å‘Šè¯‰å¯¹æ–¹ï¼Œè‡ªæˆ‘çš„æ¢³ç†å’Œåæ€ï¼›é¢è¯•å®˜é¢äº†å°±è¯¥å¥½å¥½å¯¹å¾…ï¼Œå¯ä»¥ä»è¢«é¢è¯•è€…èº«ä¸Šå­¦åˆ°æ–°çš„æ€ç»´ç»´åº¦ï¼ŒæŠŠå…¬å¸å›¢é˜Ÿçš„äº§å“ä»‹ç»ä¸‹ï¼Œä¹Ÿç®—æ˜¯ä¸€ç§æ¨å¹¿ã€‚äººä¸äººç›¸å¤„ï¼Œå°¤å…¶æ˜¯é™Œç”Ÿäººç›¸å¤„æ˜¯éœ€è¦æœ‰ç¤¼èŠ‚çš„ï¼Œä½ æ°¸è¿œä¸çŸ¥é“ååœ¨ä½ å¯¹é¢çš„äººï¼Œä»–èƒŒåæœ‰ä»€ä¹ˆæ ·çš„èƒ½é‡ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;é¢å¯¹èŒ«èŒ«çš„å…¬å¸ï¼Œå¦‚ä½•å»åˆ¤æ–­ä¸€å®¶å…¬å¸æ˜¯å¦é è°±å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é™¤éä½ å…³æ³¨ä¸€å®¶å…¬å¸å¾ˆä¹…äº†æˆ–æœ‰å†…çº¿ï¼Œä¸ç„¶å…‰ä»é¢è¯•è¿‡ç¨‹ä¸­ä½ çœŸçš„å¾ˆéš¾è¯´è¿™å®¶å…¬å¸å¥½ä¸åã€‚æˆ‘ä¼šæ¯”è¾ƒçœ‹é‡HRéƒ¨é—¨ï¼Œä¸ºä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;1.æˆ‘è€å©†å°±æ˜¯èµ„æ·±HRï¼Œæ·±çŸ¥è¿™ä¸ªéƒ¨é—¨çš„é‡è¦æ€§ï¼Œå’Œè¢«å¿½è§†æ€§ã€‚&lt;/p&gt;
&lt;p&gt;2.å¦‚æœæ•´ä¸ªé¢è¯•æ²Ÿé€šè¿‡ç¨‹ä¸­ï¼ŒHRéƒ¨é—¨æ˜¾å¾—å¾ˆè–„å¼±ï¼Œè¯´æ˜è¯¥å…¬å¸çš„ç»„ç»‡æ¶æ„ä¸æ¸…æ™°ï¼Œå¤„äºæ··æ²Œé˜¶æ®µï¼Œæœ‰é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;3.å¦‚æœHRéƒ¨é—¨çš„ç´ è´¨ä¸å¤Ÿï¼Œé‚£ä¹ˆå…¥èŒäº†ï¼Œæˆ‘ä¹Ÿè§‰å¾—åç»­ä¼šæœ‰éº»çƒ¦ï¼Œæ¯”å¦‚äº¤é‡‘ã€è¯·å‡ç­‰ç­‰çš„æ²Ÿé€šä¹Ÿæ¯”è¾ƒå¤´ç–¼ã€‚&lt;/p&gt;
&lt;p&gt;HRéœ€è¦æƒ…å•†æ™ºå•†åŒåœ¨çº¿ï¼Œå¦‚æœä¸€å®¶å…¬å¸æ‹¥æœ‰è¿™æ ·çš„HRè¯´æ˜å®ƒé‡è§†è¿™ä¸ªéƒ¨é—¨ï¼Œä¸ºçœ‹ä¼¼ä¸èµšé’±çš„éƒ¨é—¨ä¹°äº†ä¸å°‘å•ï¼Œè¯´æ˜å…¬å¸ç›ˆåˆ©æˆ–è€…ä¸šåŠ¡ç¨³å®šã€‚å°±å¦‚ï¼Œè‚šå­é¥¿äº†ï¼Œåªè¦èƒ½å¡«é¥±è‚šå­åŸºæœ¬ä»€ä¹ˆéƒ½ä¼šåƒï¼ˆç²¾åŠ›åªæœ‰åœ¨ä¸šåŠ¡èµšé’±ä¸Šï¼‰ï¼Œè€ŒçœŸçš„å»åƒå±±çæµ·å‘³è¯´æ˜æœ‰é’±ï¼ˆä¼šæœ‰ç²¾åŠ›æŠŠå…¶å®ƒç›¸å…³éƒ¨é—¨åšå¥½ï¼‰ã€‚å¥½çš„HRæ˜¯å¯¹å…¬å¸å’Œå‘˜å·¥çš„åŒä¿é™©ï¼&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="å·¥ä½œ" scheme="https://miser.github.io/categories/%E5%B7%A5%E4%BD%9C/"/>
    
    
  </entry>
  
</feed>
